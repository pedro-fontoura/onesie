// Build: February 4 2026 15:30

export const BUNDLE_URL = import.meta.url.split( '/' ).pop();

export const BUNDLE_ID = "2026-0204-1530";

function t(t){return document.getElementById(t)}class e{static get M49(){return window.location.href.includes("nighthawk.home")}static get M67(){return screen.orientation&&screen.orientation.type?screen.orientation.type.includes("landscape"):window.innerWidth>window.innerHeight}static get M124(){return navigator.maxTouchPoints>0}static get M92(){return navigator.userAgentData&&"Android"===navigator.userAgentData.platform||/android/i.test(navigator.userAgent)}static get M37(){const t=window.matchMedia("(display-mode: standalone)").matches,e=!0===window.navigator.standalone;return t||e}static get M181(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||/Mac/.test(navigator.userAgent)&&navigator.maxTouchPoints>1}static M5(t,e,i){Object.defineProperty(t,e,{value:i,writable:!1,enumerable:!0,configurable:!1})}static M11(t,e){if(!Array.isArray(t))return;const i=t.indexOf(e);-1!==i&&t.splice(i,1)}static M12(t){if(!Array.isArray(t))return t;for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}static M24(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}static M93(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}static M17(t,e=null,i=!1){let s=new URLSearchParams(window.location.search).get(t);if(null===s)return e;if(i){const t=parseInt(s,10);return isNaN(t)?e:t}return s}static M68(t,e=document.documentElement,i=null){t.startsWith("--")||(t="--"+t);const s=window.getComputedStyle(e).getPropertyValue(t).trim();return""===s?i:s.replace(/^['"]|['"]$/g,"")}static M18(){if(e.M181)return;const t=document.documentElement,i=t.requestFullscreen||t.webkitRequestFullscreen;if(!i)return;const s=e.M92?{navigationUI:"hide"}:{};i.call(t,s).catch(t=>{})}static M19(t){const e=document.querySelector('script[type="importmap"]');if(!e)throw new Error('GetImportMapValue » <script type="importmap"> not found in DOM.');const i=JSON.parse(e.textContent),s=i.imports?.[t];if(void 0===s)throw new Error("GetImportMapValue » Key not found in imports: "+t);return s}static M50(t,e=0){if("string"!=typeof t)return t;let i="";for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);i+=String.fromCharCode(n+e)}return i}static M151(t,e,i){const s=t.style;s.width=e+"px",s.height=i+"px"}static M108(t,e,i,s,n){const r=t.style;r.width=e+"px",r.height=i+"px",r.left=s+"px",r.top=n+"px"}}class i{static get M182(){return(1+Math.sqrt(5))/2}static get M183(){return 2*Math.PI}static get M152(){return Math.PI/2}static get M69(){return Math.PI/180}static get M51(){return 180/Math.PI}static M153(t){return t*i.M69}static M154(t){return t*i.M51}static M109(t,e){return Math.floor(Math.random()*(e-t+1))+t}static M70(t,e){return t+Math.random()*(e-t)}static M52(t=.5){return Math.random()<t}static M25(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}static M214(t,e,i){return t+(e-t)*i}static M204(t,e,i,s,n){return s+(t-e)*(n-s)/(i-e)}static M205(t,e,i){return Math.max(e,Math.min(t,i))}static M125(t,e,i,s){return Math.hypot(i-t,s-e)}static M155(t,e,i=2){if(e<=0)return 0;const s=t/e;return 1-Math.pow(s,i)}}var s="busy",n="success",r="fail",h="mk-room",a="room-decision",o="face-room",l="turn_ended",c="msg#deck:seed",u="user_error",d="ui:update",_="ui_click",M="game_over",p="location:unknown",m="location:draw",f="location:discard",g="location:room",w="location:hand",y=Object.defineProperty,b=class t{static K105=100;static K110=199;static K18=100;#t=0;#e=0;#i=100;#s=-1;#n=0;#r=0;#h=null;#a=null;#o=!1;#l=0;#c=0;#u=0;#d=0;#_=0;#M=0;#p=!1;#m=[];#f=!0;#g=!1;constructor(i,s,n=!1,r=0,h={}){e.M5(this,"IDX",i),e.M5(this,"ID",s);const{parent:a=null,is_box:o=!1}=h;e.M5(this,"IS_BOX",o),this.#l=r||t.K18,!0===n?this.#h=document.createElement("div"):n instanceof Node&&(this.#h=n),this.#h&&(this.#w(),a instanceof Node&&a.appendChild(this.#h))}#w(){e.M5(this,"ELEMENT",this.#h),this.#h.id=this.ID,this.#h.style.position="absolute",this.#h.style.top="0px",this.#h.style.left="0px",this.#h.style.zIndex=this.#i,this.#h.classList.add("FlexBoxEntity"),this.#h.dataset.smooth=this.#o?"yes":"no",this.#h.addEventListener("transitionend",this.#y.bind(this))}M156(){return this.#h&&(this.#h.remove(),this.#h=null,this.#m=null),this}M71(){return this.#h.offsetWidth,this}M94(){return this.#h}M126(){return this.#n}M110(){return this.#r}M184(){return this.#t}M157(){return this.#e}M108(t,e,i,s){this.#n=0|t,this.#r=0|e,s|=0,i|=0;const n=this.#t!==s||this.#e!==i;return n&&(this.#t=s,this.#e=i),this.#b(n),this}#v(){const t=window.getComputedStyle(this.#h).translate;t&&"none"!==t||(this.#u=0,this.#c=0);const e=t.split(" ");this.#u=parseFloat(e[0])||0,this.#c=parseFloat(e[1])||0}M72(t,e){if(t|=0,e|=0,this.#t===e&&this.#e===t)return this;if(this.#o){const i=this.M1(t,e);this.#E(i)}return this.#t=e,this.#e=t,this.#b(!0),this}M1(t,e){this.#v();const i=t-this.#u,s=e-this.#c;return Math.sqrt(i*i+s*s)/this.#l}M151(t,e){return t|=0,e|=0,this.#n===t&&this.#r===e||(this.#n=t,this.#r=e,this.#b(!1)),this}#b(t=!0){this.#x();const e=this.#h.style;e.width=this.#n+"px",e.height=this.#r+"px",t?(e.translate=this.#e+"px "+this.#t+"px 0px",this.#o&&(e.zIndex=199+this.#s)):e.zIndex=this.#i}#y(t){"translate"===t.propertyName&&(this.#v(),Math.abs(this.#u-this.#e)<1&&Math.abs(this.#c-this.#t)<1&&(this.#h.style.zIndex=this.#i,this.#p&&this.#k()))}M38(){return this.#M>0}M127(){return this.#M>0}M128(){return this.#M>0}#k(){const t=this.#m.length;for(let e=0;e<t;e++)this.#m[e](this);this.#m.length=0}M111(t=!0){return this.#o=!!t,this.#h.dataset.smooth=this.#o?"yes":"no",this}M129(){return this.#o}M73(t){return"function"!=typeof t?this:this.#p?(this.#m.push(t),this):void 0}M7(){this.#m.length=0}M13(t=!0){return this.#p=!!t,this}Error(t,e,...i){this.constructor.name,i.length>0&&i.forEach((t,e)=>{})}M112(){return this.#s}M113(t=-1){return this.#s=t,this}M185(t,e=-1){return null!==this.#a?(this.Error("SetBox","Already set",this.#a,t),this):(this.#a=t,e>=0&&(this.#s=e),this)}M130(){return this.#a=null,this.#s=-1,this}M186(){return this.#a}M215(t){return this.#a===t}M187(){return null!==this.#a}#E(t){return!Number.isFinite(t)||t<0?(this.Error("SetTranslationTime","Bad number",t),this):this.#h?(this.#h.style.transitionDuration=t+"ms",this):this}M26(e=0){return this.#l=e||t.K18,this}M216(t){return t|=0,this.#i===t||(this.#i=t,this.#h.style.zIndex=t),this}M131(t){return!Number.isFinite(t)||t<0?(this.Error("SetBaseZ","Bad number",t),this):(t|=0,this.#i<t&&(this.#i=t),this.#h.style.zIndex=t,this)}#x(){this.#d=this.#t+(this.#r>>1),this.#_=this.#e+(this.#n>>1)}M53(){return this.#d}M39(){return this.#_}M4(t,e){const i=t-this.#e,s=e-this.#t;return Math.sqrt(i*i+s*s)/this.#l}M114(){return this.#f}M132(){return!this.#f}M95(t=!0){return t=!!t,this.#f===t||(this.#f=t,this.M15(t)),this}M40(){return this.#f=!this.#f,this.M15(this.#f),this}M96(){return this.#g}M74(t=!0){return t=!!t,this.#g===t||(this.#g=t,this.M20(t)),this}M31(){return this.#g=!this.#g,this.M20(this.#g),this}},v=1/0,E=class extends b{static K117=11;static K106=12;static K107=3;static K111=1;static K118=2;static K108=4;static K101=5;static K109=6;static K112=7;#L=11;#C=!0;#I=[];#N=null;#A=null;#S=null;#T=v;#R=0;#D=0;#K=0;#P=0;#O=!1;#V=0;#B=0;#F=!1;#z=0;#G=0;#H=b.K105;#j=null;#U=null;#q=null;#W=null;#$=!1;#Y=0;#X=!1;constructor(t,e,i,s,n,r=!1,h={}){const{max_count:a=v,sorting:o=null,tuck:l=!1,uniform:c=!1,parent:u=null,velocity_px_ms:d=0,reverse_z:_=!1}=h;super(t,e,r,d,{is_box:!0,parent:u}),this.#T=a,this.M75(_),this.#L=i,11!==i&&12!==i&&this.Error("FlexBox","Bad orientation",i),this.#C=11===this.#L,"function"==typeof o&&(this.#N=o);const M=Number.isFinite(this.#T)?this.#T:64;this.#j=new Int32Array(M),this.#U=new Int32Array(M),s=s||4,this.#S=this.#J(s),3!==(n=n||3)&&1!==n&&2!==n&&this.Error("FlexBox","Bad align",n),this.#A=this.#J(n),this.#F=c,l>0&&this.M158(l),this.ELEMENT&&this.ELEMENT.classList.add("FlexBox")}M156(){super.M156(),this.#I=null,this.#A=null,this.#S=null,this.#N=null}#Q(t,e){if(t.length<e){const i=t.length<<1;t=new Int32Array(i>e?i:e)}return t}M226(t,e=!0){if(!(t instanceof b))return this.Error("Add","Not a FlexBoxEntity",t),this;if(this.#I.includes(t))return this.Error("Add","Already here",t),this;if(this.M191())return this.Error("Add","I am full",t),this;t.M187()&&t.M186().M190(t),e?this.#I.push(t):this.#I.unshift(t);const i=this.#I.length;let s=!e&&i>1;return t.M185(this,e?this.#I.length-1:0),this.#Q(this.#j,i),this.#Q(this.#U,i),null!==this.#N&&(this.#I.sort(this.#N),s=!0),s&&this.#Z(),this.#F?(0!==this.#z&&0!=this.#G||(this.#z=t.M126(),this.#G=t.M110(),this.#$>0&&this.#tt()),this.#V+=this.#z,this.#B+=this.#G):(this.#V+=t.M126(),this.#B+=t.M110()),this.#O=!0,this.M8(),this}M188(t){return this.M226(t,!1)}M189(t){return this.M226(t,!0)}M190(t){return t instanceof b?this.#I.includes(t)?(t.M130(),t.M7(),e.M11(this.#I,t),this.#Z(),this.#F?(this.#V-=this.#z,this.#B-=this.#G):(this.#V-=t.M126(),this.#B-=t.M110()),this.#O=!0,this.M8(),this):(this.Error("Remove","Not here",t.ID),this):(this.Error("Remove","Not a FlexBoxEntity",t),this)}M151(t,e){t|=0,e|=0,super.M151(t,e),this.#R=t,this.#D=e}M108(t,e,i,s,n=!0){return t|=0,e|=0,i|=0,s|=0,super.M108(t,e,i,s),this.#R=t,this.#D=e,this.#P=i,this.#K=s,n&&this.M8(),this}M27(t,e,i=-1){return this.#z=0|t,this.#G=0|e,this.#$>0&&this.#tt(),this.#F=!0,this.#O=!1,i>=0&&(this.#H=i),this.M14(),this}M75(t=!0){this.#X=!!t,this.M8()}M28(t=-1){t>=0&&(this.#H=0|t)}M14(){let t=0,e=0;const i=this.#I.length;if(i>0){if(this.#F){if(0===this.#z||0===this.#G){const t=this.#I[0];this.#z=t.M126(),this.#G=t.M110(),this.#$>0&&this.#tt()}t=i*this.#z,e=i*this.#G}else for(let s,n=0;n<i;n++)s=this.#I[n],t+=s.M126(),e+=s.M110();(isNaN(t)||isNaN(e))&&this.Error("UpdateEntitiesSize","total width/height is NaN"),(t<0||e<0)&&this.Error("UpdateEntitiesSize","total width/height is negative",t,e)}return this.#V=t,this.#B=e,this.#O=!0,this}#et(t=-1){if(-1===t&&(t=this.#I.length),0===t)return this;this.#O||this.M14();const e=this.#C;let i=e?this.#V:this.#B,s=this.#$&&t>1;if(s){const n=e?this.#R:this.#D;s=i>n,s&&(this.#it(t,n,i),i-=(t-1)*this.#Y)}return e?(this.#q=this.#S(!0,!0,i,t),this.#W=this.#A(!1,!1,this.#B,t)):(this.#W=this.#S(!0,!1,i,t),this.#q=this.#A(!1,!0,this.#V,t)),s&&this.#st(e,t),t}#it(t,e,i){this.#C?this.#z:this.#G;const s=(i-e)/(t-1);this.#Y=s}#st(t,e){const i=t?this.#q:this.#W;for(let t=1;t<e;t++)i[t]-=t*this.#Y}M158(t=!0){this.#$=!!t,this.#$&&this.M8()}M133(t){return this.#F||0===t?t<0||t>1?(this.Error("SetTuck","Tuck must be [ 0 .. 1 ]",t),this):(this.#$=t,this.#tt(),void(this.#I.length>1&&this.M8())):(this.Error("SetTuck","Cannot tuck non-uniform entities"),this)}#tt(){if(!this.#F)return void(this.#Y=0);const t=this.#C?this.#z:this.#G;this.#Y=t*this.#$|0}M72(t,e){super.M72(t,e),this.#P=t,this.#K=e}M8(t=!0){const e=this.#I.length;if(0===e)return this;t&&this.#et(e);const i=this.#H;for(let t=0;t<e;t++){const s=this.#I[t];this.#X?s.M216(i+(e-t)):s.M216(i+t),s.M72(this.#q[t],this.#W[t]),s.IS_BOX&&s.M8(!0)}return this}#nt(t,e=-1){if(e<0&&(e=t.M112()),this.#X){const i=this.#I.length;t.M216(this.#H+(i-e))}else t.M216(this.#H+e);return t.M72(this.#q[e],this.#W[e]),this}#J(t){switch(t){case 3:return this.#rt.bind(this);case 1:return this.#ht.bind(this);case 2:return this.#at.bind(this);case 4:return this.#ot.bind(this);case 5:return this.#lt.bind(this);case 6:return this.#ct.bind(this);case 7:return this.#ut.bind(this)}}#dt(t,e,i){const s=(t?this.#j:this.#U).subarray(0,i),n=e?this.#P:this.#K;var r=e?this.#z:this.#G;if(t&&this.#F)for(var h=0;h<i;++h)s[h]=n+h*r;else{var a=n;for(h=0;h<i;++h){if(t&&h>0){if(!this.#F){const t=this.#I[h-1];r=e?t.M126():t.M110()}a+=r}s[h]=a}}return s}#ht(t,e,i,s){return this.#dt(t,e,s)}#rt(t,e,i,s){const n=this.#dt(t,e,s),r=e?this.#R:this.#D,h=r-i>>1;var a=e?this.#z:this.#G;if(!t&&this.#F){const t=r-a>>1;for(var o=0;o<s;++o)n[o]+=t}else for(o=0;o<s;++o)if(t)n[o]+=h;else{if(!this.#F){const t=this.#I[o];a=e?t.M126():t.M110()}n[o]+=r-a>>1}return n}#at(t,e,i,s){const n=this.#dt(t,e,s),r=e?this.#R:this.#D,h=Math.round(r-i);var a=e?this.#z:this.#G;if(!t&&this.#F){const t=r-a;for(var o=0;o<s;++o)n[o]+=t}else for(o=0;o<s;++o)if(t)n[o]+=h;else{if(!this.#F){const t=this.#I[o];a=e?t.M126():t.M110()}n[o]+=r-a}return n}#ut(t,e,i,s){const n=this.#dt(t,e,s),r=(e?this.#R:this.#D)>>1;var h=e?this.#z:this.#G;const a=n[0];for(var o=0;o<s;++o){if(!this.#F){const t=this.#I[o];h=e?t.M126():t.M110()}n[o]=a+r-(h>>1)}return n}#lt(t,e,i,s){if(s<2)return this.#ht(t,e,i,s);const n=this.#dt(t,e,s),r=e?this.#R:this.#D,h=Math.round((r-i)/(s-1));for(var a=1;a<s;++a)n[a]+=a*h;return n}#ot(t,e,i,s){const n=this.#dt(t,e,s),r=e?this.#R:this.#D,h=Math.round((r-i)/(s+1));for(let t=0;t<s;++t)n[t]+=(t+1)*h;return n}#ct(t,e,i,s){if(s<2)return this.#rt(t,e,i,s);const n=this.#dt(t,e,s),r=((e?this.#R:this.#D)-i)/s,h=r>>1;for(let t=0;t<s;++t)n[t]+=h+t*r|0;return n}M76(t){return!Number.isFinite(t)||t<=0?(this.Error("SetMaxCount","Bad number",t),this):(this.#T=0|t,this)}M77(){return this.#T}M191(){return this.#I.length>=this.#T}M97(t){return"function"!=typeof t||(this.#N=t),this}M98(t){return this.#S=this.#J(t||4),this}M217(t){return"function"!=typeof t&&(t=this.#N),"function"!=typeof t||(this.#I.sort(t),this.#Z(),this.M8()),this}#Z(t=-1){if(t<0&&(t=this.#I.length),!(t<0))for(let e=0;e<t;++e)this.#I[e].M113(e)}M159(){const t=this.#I.length;return t<=1||(M12(this.#I),this.#Z(t),this.M8()),this}M160(){return 0===this.#I.length}M134(t){return this.#I.includes(t)}M135(){return this.#I.length}M161(t){if("function"!=typeof t)return this;const e=this.#I.length;for(let i,s=0;s<e;s++)i=this.#I[s],t(i);return this}M162(){return this.#I.length>0?this.#I[0]:null}M99(){if(this.#I.length<=0)return null;const t=this.#I[0];return this.M190(t),t}M163(){const t=this.#I.length;return t>0?this.#I[t-1]:null}M100(){const t=this.#I.length;if(t<=0)return null;const e=this.#I[t-1];return this.M190(e),e}M78(t){return t<0||t>=this.#I.length?(this.Error("GetEntityAt","Bad idx",t),null):this.#I[t]}M192(){return[...this.#I]}M79(t){return"function"!=typeof t?null:this.#I.filter(t)}M206(){const t=this.#I.length;if(0===t)return this;for(let e=0;e<t;e++){const t=this.#I[e];t.M130(),t.M7()}return this.#I.length=0,this.#V=0,this.#B=0,this.#O=!0,this}#_t(t=0){const e=this.#I.length+t;return e>this.#T?(this.Error("#PrepareBatchAdd","Total exceeds max_count",e),this):(e>0&&(this.#j=this.#Q(this.#j,e),this.#U=this.#Q(this.#U,e)),this)}M136(t,e=!0,i=0){const s=t.length;if(0===s)return this;if(this.M191())return this.Error("BatchAdd","I am full"),this;const n=this.M135()+s;if(n>this.M77())return this.Error("BatchAdd","Not enough space"),this;for(let e=0;e<s;e++){const i=t[e];if(!(i instanceof b))return this.Error("BatchAdd","Not a FlexBoxEntity",i),this;if(this.#I.includes(i))return this.Error("BatchAdd","Already here",i),this}const r=[...this.#I],h=r.length;this.#_t(s);for(let i=0;i<s;i++){const s=t[i];s.M187()&&s.M186().M190(s),s.M185(this),e?this.#I.push(s):this.#I.unshift(s);const n=this.#F?this.#z:s.M126(),r=this.#F?this.#G:s.M110();this.#V+=n,this.#B+=r}this.#O=!0,null!==this.#N&&this.#I.sort(this.#N),this.#Z(n),this.#et(n);for(let t=0;t<h;t++){const e=r[t];this.#nt(e)}if(0===i)for(let e=0;e<s;e++){const i=t[e];this.#nt(i)}else{let e=i;i<=1&&(e=this.M2(t[0])*i);let n=0;for(let i=0;i<s;i++){const s=t[i];setTimeout(()=>{this.#nt(s)},n),n+=e}}return this}M80(t=null,i=0){const s=null===t?[...this.#I]:t,n=s.length;if(0===n)return this;for(let t=0;t<n;t++){const e=s[t];if(!(e instanceof b))return this.Error("BatchRemove","Not a FlexBoxEntity",e),this;if(!this.#I.includes(e))return this.Error("BatchRemove","Not here",e),this}for(let t=n-1;t>=0;t--){const i=s[t];e.M11(this.#I,i),i.M130(),i.M7();const n=this.#F?this.#z:i.M126(),r=this.#F?this.#G:i.M110();this.#V-=n,this.#B-=r}this.#O=!0;const r=this.#I,h=r.length;if(this.#Z(h),this.#et(h),0===i)this.M8(!1);else{let t=i;i<=1&&(t=this.M2(r[0])*i);let e=t;for(let i=0;i<h;i++){const s=r[i];setTimeout(()=>this.#nt(s),e),e+=t}}return this}M2(t){if(!t.M215(this))return this.Error("GetEntityTranslationTime","Not here",t),0;const e=t.M112();return e<0||e>=this.#I.length?(this.Error("GetEntityTranslationTime","Bad index",t),0):t.M1(this.#q[e],this.#W[e])}M3(t){return t.EstimateTravelTime(this.M39(),this.M53())}M164(t=""){for(let t=0;t<this.#I.length;++t)this.#I[t];return!0}},x={smooth:!0,touch_down_events:!1,visible:!1,selected:!1,velocity_px_ms:1,flip_time:500,face_up:!0,flip_axis:"y"},k=class t extends b{static K105=110;#Mt=null;#pt=null;#mt=null;#ft=x.face_up;constructor(t){super(t,"Card_"+t,!0),this.#gt(t),e.M5(this,"BODY",this.#Mt),e.M5(this,"FACE",this.#pt),e.M5(this,"BACK",this.#mt),this.M207()}M156(){super.M156()}M207(e={}){for(const t in x){const i=e[t]??x[t];e[t]=i}this.M187()&&this.M186().M190(this),this.M7(),this.M111(e.smooth),this.M13(e.touch_down_events),this.M26(e.velocity_px_ms),this.M95(e.visible),this.M74(e.selected),this.M216(t.K105),this.M81(e.flip_time),this.M115(e.face_up),this.M82(e.flip_axis)}#gt(e){this.ELEMENT.classList.add("Card"),this.#Mt=document.createElement("div"),this.#Mt.classList.add("CardBody"),this.#Mt.classList.add("Clickable"),this.#Mt.dataset.idx=e,this.#Mt.card=this,this.#Mt.dataset.face=this.#ft?"up":"no",this.#Mt.dataset.visible=this.M114()?"yes":"no",this.#pt=document.createElement("div"),this.#pt.classList.add("CardFace"),this.#mt=document.createElement("div"),this.#mt.classList.add("CardBack"),this.#Mt.appendChild(this.#pt),this.#Mt.appendChild(this.#mt),this.ELEMENT.appendChild(this.#Mt),this.M131(t.K105)}M9(){return this.#Mt}M115(t=!0){return this.#ft=!!t,this.#Mt.dataset.face=this.#ft?"up":"down",this.OnFlip&&this.OnFlip(t),this}M137(){return this.#ft}M101(){return!this.#ft}M15(t){return this.#Mt.dataset.visible=t?"yes":"no",this}M20(t){return this.#Mt.dataset.selected=t?"yes":"no",this}M81(t){return!Number.isFinite(t)||t<0?(this.Error("SetFlipTime","Bad number",t),this):(this.#Mt.style.transitionDuration=t+"ms",this)}M82(t="x"){if("string"!=typeof t||1!==t.length)return this.Error("SetFlipAxis","Bad axis",t),this;if("x"!==(t=t.toLowerCase())&&"y"!==t)return this.Error("SetFlipAxis","Bad axis",t),this;const e="x"===t?"1":"0",i="y"===t?"1":"0";return this.#Mt.style.setProperty("--ROT_X",e),this.#Mt.style.setProperty("--ROT_Y",i),this}M218(){return this.#ft=!this.#ft,this.#Mt.dataset.face=this.#ft?"up":"down",this.OnFlip&&this.OnFlip(this),this}},L={};((t,e)=>{for(var i in e)y(t,i,{get:e[i],enumerable:!0})})(L,{K50:()=>K,K51:()=>O,K86:()=>P,K68:()=>j,K69:()=>tt,K70:()=>D,K87:()=>T,K88:()=>R,K19:()=>J,K20:()=>X,K97:()=>q,K89:()=>W,K71:()=>U,K90:()=>Y,K72:()=>Q,K73:()=>$,K42:()=>Z,K52:()=>N,K53:()=>A,K74:()=>C,K21:()=>S,K75:()=>I,K113:()=>G,K76:()=>V,K25:()=>B,K54:()=>z,K77:()=>H,K55:()=>F});var C=0,I=6,N=10,A=14,S=15,T=63,R=15,D=15,K=1<<N,P=2<<N,O={[K]:"Black",[P]:"Red"},V=1<<I,B=2<<I,F=3<<I,z=4<<I,G=[V,B,F,z].sort(),H={[V]:"Clubs",[B]:"Diamonds",[z]:"Hearts",[F]:"Spades"},j=1<<A,U=0,q=1,W=11,$=12,Y=13,X=Math.min(W,$,Y),J=Math.max(W,$,Y),Q={[q]:"Ace",[W]:"Jack",[$]:"Queen",[Y]:"King"},Z={[q]:"A",[W]:"J",[$]:"Q",[Y]:"K"},tt={name:"Joker",suit:"joker",symbol:"JKR",rank:U,flag:j},et=class extends k{#wt=!1;#yt=!1;#bt=null;constructor(t,i){super(t),e.M5(this,"DNA",i);const s=i&T,n=i&R<<I,r=i&D<<N;e.M5(this,"RANK",s),e.M5(this,"SUIT",n),e.M5(this,"COLOR",r),this.#wt=0!==(i&j),this.#yt=!this.#wt&&this.RANK>=X&&this.RANK<=J,this.#vt(),this.#Et()}M138(){return"("+this.IDX+") "+this.M83()+" of "+this.M84()}#vt(){const t=this.M83().toLowerCase(),e=this.M84().toLowerCase(),i=this.M208()?"red":"black",s=this.BODY;s.dataset.rank=t,s.dataset.suit=e,s.dataset.color=i,this.#wt?s.dataset.joker="yes":this.#yt&&(s.dataset.royal="yes")}#Et(){const t=this.M42().toUpperCase(),e=this.M84();this.FACE.innerHTML="";const i=document.createElement("p");i.innerText=t,this.#bt=i,this.#yt&&this.M41(this.RANK),this.FACE.appendChild(this.#bt);{const t=this.#xt(e.toLowerCase());this.FACE.appendChild(t)}}M41(t){const e=document.createElement("span");e.innerText=t,this.#bt.appendChild(e)}#xt(t){this.M208();const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("class","SuitIcon"),e.innerHTML=`<use href="#suit-${t}"/>`,e}M151(t,e){super.M151(t,e),this.FACE.style.fontSize=Math.round(.4*t)+"px"}static async M116(t){try{const e=M19("flex-box/"),i=await fetch(e+t),s=await i.text(),n=document.getElementById("card-sprite-sheet");n&&n.remove();const r=document.createElement("div");r.id="card-sprite-sheet",r.style.display="none",r.innerHTML=s,document.body.appendChild(r)}catch(t){}}M208(){return this.COLOR===P}M165(){return this.COLOR===K}M166(){return this.#wt}M167(){return this.#yt}M139(){return!this.#wt&&!this.#yt}M209(){return this.RANK===q}M193(){return this.RANK===W}M168(){return this.RANK===$}M194(){return this.RANK===Y}M195(){return this.RANK%2==0}M210(){return this.RANK%2!=0}M196(t){return this.SUIT===t}M83(){return this.#wt?tt.name:Q[this.RANK]||this.RANK.toString()}M84(){return this.#wt?tt.suit:H[this.SUIT]||"Unknown"}M42(){return this.#wt?tt.symbol:Z[this.RANK]||this.M83()}M54(){return O[this.COLOR]||"Unknown"}},it=1/0,st=!0,nt=!0,rt=class extends E{#ft=nt;#kt=st;constructor(t,e,i,s,n,r,h={}){const{max_cards:a=it,flip_after:o=st,face_up:l=nt,sorting:c=null,tuck:u=!1,uniform:d=!0,parent:_=null,reverse_z:M=!1}=h;super(t,e,i,s,n,r,{max_count:a,sorting:c,tuck:u,uniform:d,parent:_,reverse_z:M}),this.M28(et.K105),this.ELEMENT&&this.ELEMENT.classList.add("BoxOfCards"),this.M115(l),this.M55(o)}#Lt(t,e){t.M115(e)}M226(t,e=!0){return t instanceof et?(super.M226(t,e),this.#kt?t.M73(this.#Lt.bind(this,t,this.#ft)):t.M115(this.#ft),this):(this.Error("Add","Not a Card instance",t),this)}M188(t){return this.M226(t,!1)}M189(t){return this.M226(t,!0)}M134(t){return t instanceof et?super.M134(t):(this.Error("Includes","Not a Card instance",t),this)}M136(t,e=!0,i=0){const s=t.length;if(0===s)return this;for(let e=0;e<s;e++){const i=t[e];if(!(i instanceof et))return this.Error("BatchAdd","Not a Card instance",i),this}if(this.M135()+s>this.M77())return this.Error("BatchAdd","I am full"),this;super.M136(t,e,i);for(let e=0;e<s;e++){const i=t[e];this.#kt?i.M73(this.#Lt.bind(this,i,this.#ft)):i.M115(this.#ft)}return this}M190(t){return t instanceof et?(super.M190(t),this):(this.Error("Remove","Not a Card instance",t),this)}M80(t=null,e=0){const i=null===t?[...this.GetEntities()]:t,s=i.length;if(0===s)return this;for(let t=0;t<s;t++){const e=i[t];if(!(e instanceof et))return this.Error("Remove","Not a Card instance",e),this}return super.M80(t,e),this}M117(t){return super.M78(t)}M115(t=!0){return this.#ft=!!t,this}M55(t=!0){return this.#kt=!!t,this}},ht=class{#Ct=[];#It=[];#Nt=[];#At=null;#St=0;#Tt=[];constructor(t={},e={}){const{jokers:i=0,exclude_ranks:s=[],exclude_cards:n=[],suits:r=G,seed:h=0}=t;this.#St=h,this.#Rt(r,s,n,i),this.#At={smooth:e.smooth??!0,touch_down_events:e.touch_down_events??!0,velocity_px_ms:e.velocity_px_ms??100,flip_time:e.flip_time??500,face_up:e.face_up??!0,visible:e.visible??!0,flip_axis:e.flip_axis??"y"},this.M207()}#Dt(t,e,i){return(t&T)===e&&(t&R<<I)===i}#Rt(t,e,i,s){for(const s of t){const t=s===B||s===z?P:K;for(let n=1;n<=13;n++){if(e.includes(n))continue;if(i.some(t=>this.#Dt(n|s,t.rank,t.suit)))continue;const r=n|s|t,h=new et(this.#Ct.length,r);this.#Ct.push(h)}}for(let t=0;t<s;t++){const e=j|(t%2==0?K:P),i=new et(this.#Ct.length,e);this.#Ct.push(i)}}M85(t){let e=0;for(const i of t)for(let t=0;t<this.#Ct.length;++t){const s=this.#Ct[t];if(this.#Dt(s.DNA,i.rank,i.suit)){e+=1,this.#Ct.splice(t,1),this.#Tt.push(s);break}}this.#Kt()}M56(t){}#Kt(){this.#Nt=[],this.#It=this.#Ct.map((t,e)=>e)}M207(t={}){this.#Kt();const e=new Set;this.#Ct.forEach(t=>{const i=t.M186();i&&e.add(i)}),e.forEach(t=>t.M206());const i=this.#At;for(const e in t)i.hasOwnProperty(e)&&(i[e]=t[e]);for(const t of this.#Ct)t.M207(i);return this}M219(t=null,e=0){if(null===t)return this;const i=this.M170(),s=e>0;return this.M161(t=>{t.M95(s),t.M111(s),t.M81(0),t.M115(!1)}),t.M136(i,!0,e>0?e:0),this.M161(t=>{t.M81(this.#At.flip_time),t.M111(this.#At.smooth)}),this}M159(t=0){let i=Math.random;0!==(t=t||this.#St)&&(t="string"==typeof t?M93(t):t,i=e.M24(t));const s=this.#It;for(let t=s.length-1;t>0;t--){const e=Math.floor(i()*(t+1));[s[t],s[e]]=[s[e],s[t]]}return this}M169(t=0){return this.#St="string"==typeof t?M93(t):0|t,this.#St}M220(){if(0===this.#It.length)return null;const t=this.#It.pop();return this.#Nt.push(t),this.#Ct[t]}M170(){const t=[];return this.#It.forEach(e=>{t.push(this.#Ct[e])}),this.#Nt=this.#It,this.#It=[],t}M140(){const t=this.#It[this.#It.length-1];return this.M171(t)}M171(t){return this.#Ct[t]}M43(t){if("function"!=typeof t)return[];const e=[];for(let i=this.#It.length-1;i>=0;i--){const s=this.#It[i],n=this.#Ct[s];t(n)&&(this.#It.splice(i,1),this.#Nt.push(s),e.push(n))}return e}M57(t,e){t|=0,e|=0,this.#Ct.forEach(i=>i.M151(t,e))}M172(){return this.#Ct.length}M21(){return this.#It.length}M161(t){return"function"!=typeof t||this.#Ct.forEach((e,i)=>t(e,i)),this}M22(t,e){const i=t.SUIT,s=e.SUIT;return i<s?-1:i>s?1:Math.sign(t.RANK-e.RANK)}},at="off",ot=class extends rt{static K56=at;static K57="top";static K26="right";static K22="bottom";static K43="left";#Pt=null;#Ot=!1;#Vt=0;#Bt=null;constructor(t,i,s={}){const{max_cards:n=1/0,counter_position:r=at,pop_effect:h=!1,face_up:a=!0,parent:o=null}=s;super(t,i,E.K117,E.K112,E.K107,!0,{max_cards:n,parent:o}),this.#Ft(),this.#zt(),this.M16(r),this.M58(h),this.M115(a),e.M5(this,"COUNTER",this.#Pt)}#Ft(){const t=this.ELEMENT;t.classList.add("PileOfCards");const e=document.createElement("span");e.classList.add("PileCounter"),e.innerText="0",t.appendChild(e),this.#Pt=e}M226(t,e=!0){return super.M226(t,e),this.#Gt(t,e),this}#Gt(t,e=!0){t.M129()?(this.#Vt++,t.M73(()=>{this.#Vt--,this.#zt(),this.#Ht(e?t:null),e||this.#Bt===t||t.M95(!1)})):(this.#Ht(e?t:null),e||this.#Bt===t||t.M95(!1),this.#zt())}#Ht(t=null){const e=this.M135();if(0===e)return;const i=this.#Bt;if(null===t)for(let i=e-1-this.#Vt;i>=0;--i){const e=this.M78(i);if(!e.M127()){t=e;break}}i!==t&&(i&&i.M95(!1),this.#Bt=t,t.M95(!0))}M136(t,e=!0){super.M136(t,e);const i=t.length;let s;for(let e=0;e<i;e++)s=t[e],s.M95(!1);return this.#zt(),this.#Ht(e?s:null),this}M190(t){return super.M190(t),this.#jt(t),this}#jt(t,e=!0){t.M95(!0),t.M127()&&this.#Vt--,e&&(this.#Bt===t&&(this.#Bt=null,this.#Ht(null)),this.#zt())}M80(t=null,e=0){const i=this.#Bt,s=null===t?[...this.GetEntities()]:t,n=s.length;if(0===n)return this;super.M80(t,e);for(let t=0;t<n;t++){const e=s[t];this.#jt(e,!1)}return s.includes(i)&&this.#Ht(),this.#zt(),this}M206(){return super.M206(),this.#Bt=null,this.#Vt=0,this.#zt(),this}M141(t){return this.M226(t,!0)}M86(t){return this.M226(t,!1)}M87(){const t=this.M163();return t&&this.M190(t),t}M32(){const t=this.M162();return t&&this.M190(t),t}M184(){return this.M163()}M118(){return this.M162()}M159(){const t=this.M135();if(t>0&&this.#Ut(),t<=1)return;const e=this.#Bt;super.M159();const i=this.M78(t-1);return e!==i&&(e.M95(!1),i.M95(!0),this.#Bt=i),this}M16(t){return this.ELEMENT.dataset.counter=t,this}M58(t){return this.#Ot=!!t,this}#zt(){const t=this.M135()-this.#Vt;this.#Pt.innerText=t,this.#Ot&&this.#Ut()}#Ut(){const t=this.#Pt;t.classList.remove("PopEffect"),this.M71(),t.classList.add("PopEffect")}debug(){const t=this.M135();for(let e=0;e<t;++e)this.M78(e)}M173(){const t=this.M135();return 0===t?null:this.M78(t-1)}M102(){return 0===this.M135()?null:this.M78(0)}},lt=class{#qt;#Wt=[];#$t;#Yt={};#Xt=null;#Jt="";constructor(t,e,i){this.#qt=t+"_",this.#$t=e,this.#Jt=i??""}M119(t,e){this.#Wt.push({id:t,schema:e}),e.forEach(t=>{const e=localStorage.getItem(this.#qt+t.id);null!==e?this.#Yt[t.id]=this.#Qt(e):(this.#Yt[t.id]=t.default,this.M221(t.id,t.default))})}#Qt(t){return"true"===t||"false"!==t&&(isNaN(t)||""===t?t:Number(t))}M197(){for(const{id:e,schema:i}of this.#Wt)this.#Zt(t(e),i)}#Zt(t,e){if(!t)throw new Error("SettingsManager::RenderTo » No parent");this.#Xt=t;const i=e.map(t=>this.#te(t));this.#Xt.innerHTML=i.join(""),this.#Xt.querySelectorAll("INPUT").forEach(t=>{this.#ee(t).classList.contains("AppSettingNotImplemented")||t.classList.add("Clickable")}),this.#Xt.querySelectorAll("LABEL").forEach(t=>{this.#ee(t).classList.contains("AppSettingNotImplemented")||t.classList.add("Clickable")}),this.#ie()}#ee(t){let e=t.parentElement;do{if("DIV"===e.tagName&&e.classList.contains("AppSettingsRow"))return e;e=e.parentElement}while(null!==e);return e}#te(t){const e=this.#Yt[t.id];let i="";"radio"===t.type?i=t.options.map((i,s)=>`\n                <label>\n                    <input type='radio' name='${t.id}' value='${s}' ${e===s?"checked":""}>\n                    ${i}\n                </label>\n            `).join(""):"range"===t.type?i=`\n                <input type='range' id='${t.id}' \n                    min='${t.min}' max='${t.max}' step='${t.step}' \n                    value='${e}'>\n            `:"checkbox"===t.type?i=`\n                <input type='checkbox' id='${t.id}' ${e?"checked":""}>\n            `:"text"===t.type&&(i=`\n                <input type='text' id='${t.id}' \n                    value='${e}'>\n            `);let s="AppSettingsRow";return t.not_implemented&&(s+=" AppSettingNotImplemented"),`\n            <div class='${s}' data-setting-id='${t.id}'>\n                <p class='AppSettingsMainLabel'>${t.label}</p>\n                <div class='AppSettingsInputWrapper'>${i}</div>\n            </div>\n        `}#ie(){this.#Xt.addEventListener("input",t=>{t.stopPropagation(),t.preventDefault();const e=t.target,i=e.name||e.id;let s="checkbox"===e.type?e.checked:e.value;isNaN(s)||"range"!==e.type||(s=Number(s)),this.M44(i,s)}),this.#Xt.addEventListener(this.#Jt,t=>{"INPUT"===t.target.tagName&&(t.is_onesie_ui=!0),"LABEL"===t.target.tagName&&(t.is_onesie_ui=!0)})}M44(t,e){this.#Yt[t]=e,this.M221(t,e),this.#$t&&this.#$t(t,e)}M221(t,e){localStorage.setItem(this.#qt+t,e)}M227(t){return this.#Yt[t]}},ct="https://",ut="rqhvlh0vwdwv",dt=window.visualViewport,_t="AppRotate",Mt="AppError",pt="AppErrorInfo",mt="AppViewport",ft="PageHidden",gt="Hidden",wt=_t.toLowerCase(),yt=Mt.toLowerCase(),bt="Home".toLowerCase(),vt="Play".toLowerCase(),Et=class s{static K91=1;static K98=2;static K115=3;#se=null;#ne=null;#re=new Map;#he=s.K91;#ae=null;#oe=null;#le=null;#ce=null;#ue=null;#de=null;#_e=null;#Me=null;#pe=null;#me=null;#fe=null;#Jt="";#ge=!0;#we=null;#ye=null;constructor(t={}){this.#Jt=e.M124?"touchstart":"click",this.#be(t);const i=t.start_page||bt;requestAnimationFrame(()=>this.M143(i))}#be(t){if(this.#se=document.getElementById(mt),null===this.#se)throw new Error("App » Element not found: #"+mt);this.#ve();const e=this.#re.get(wt);if(!e)throw new Error("App » Element not found: #"+_t);e.classList.add(_t);const i=this.#re.get(yt);if(!i)throw new Error("App » Element not found: #"+Mt);if(i.classList.add(Mt),this.#oe=document.getElementById(pt),!this.#oe)throw new Error("App » Element not found: #"+pt);this.#Ee(t),this.#xe(),this.#ke(),this.#Le(),this.#Ce(t),this.#Ie(t),this.#he=t.page_mode??1,this.#Ne(),this.#Me=t.on_resize||this.#Me||null,this.#pe=t.on_click||this.#pe||null,this.#me=t.on_page||this.#me||null}#Ee(t){const e=new k("Onesie");e.M95(!0),e.M115(!1),e.M111(!1),this.#de=e;const i=this.#re.get(bt);if(i.appendChild(e.ELEMENT),i.classList.add("Clickable"),t.blank_card)return;const s=t.game_name||"Some Card Game",n=t.game_designer||"Some Great Designer",r=t.game_build||("undefined"!=typeof BUNDLE_ID?BUNDLE_ID:"0000-0000-0000"),h="p";if(!t.blank_back){const t=document.createElement(h);t.classList.add("h1"),t.innerHTML="ONESIE",e.BACK.appendChild(t);const i=document.createElement(h);i.classList.add("h2"),i.innerHTML="1p card games",e.BACK.appendChild(i);const s=document.createElement(h);s.classList.add("h3"),s.innerHTML="build:<br><span>"+r+"</span>",e.BACK.appendChild(s)}if(!t.blank_face){const t=document.createElement(h);t.classList.add("h1"),t.innerHTML=s;const i=document.createElement(h);i.classList.add("h2"),i.innerHTML="<small>designed by:</small><br>"+n;const a=document.createElement(h);a.classList.add("h2"),a.innerHTML="<small>coded by:</small><br>Pedro Fontoura";const o=document.createElement(h);o.classList.add("h3"),o.innerHTML="build:<br><span>"+r+"</span>";const l=document.createElement(h);l.classList.add("h3"),l.innerHTML="♦ a solitaire card game ♦";for(const s of[t,l,i,a])e.FACE.appendChild(s)}}#ve(){document.querySelectorAll("#"+mt+" > section").forEach(t=>{this.#re.set(t.id.toLowerCase(),t),t.classList.add(ft)})}#Le(){window.addEventListener("resize",()=>this.#Ne()),window.addEventListener("contextmenu",t=>{if(t.preventDefault(),t.stopPropagation(),"touchstart"===this.#Jt)return;const e=new MouseEvent(this.#Jt,{view:window,bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});t.target.dispatchEvent(e)},{passive:!1}),window.addEventListener("unhandledrejection",t=>{if(t.preventDefault(),t.stopPropagation(),t.reason.stack){const e=[this.#Ae(t.reason.stack)].join("<br>");this.#Se("Rejected",e)}else this.#Se("Rejected",t.reason.message)}),window.addEventListener("error",t=>{t.preventDefault(),t.stopPropagation();const e=[t.error.message,t.error.fileName,t.error.lineNumber,this.#Ae(t.error.stack)].join("<br>");this.#Se("Error",e)}),this.#ce.addEventListener(this.#Jt,t=>{this.#Te(),t.stopPropagation(),this.#ue.classList.toggle(gt)}),Array.from(this.#ue.children).forEach(t=>{const e=this.#Re(t);this.#re.get(e)?t.addEventListener(this.#Jt,t=>{this.#Te(),t.stopPropagation(),this.#De(t)}):t.remove()}),this.#de.M9().addEventListener(this.#Jt,t=>{this.#Te(),t.stopPropagation(),this.#de.M137()?this.M143(vt):this.#de.M218()}),this.M174(bt).addEventListener(this.#Jt,t=>{this.#Te(),t.stopPropagation(),this.#de.M218()}),window.addEventListener(this.#Jt,t=>{t.stopPropagation(),this.#Ke(t)})}#Te(){e.M49||e.M124&&e.M18()}#De(t){const e=this.#Re(t.target);this.#re.get(e)&&this.M143(e)}#Ke(t){if(t.is_onesie_ui)return;let e=0,i=0;if("touchstart"===this.#Jt){const s=t.touches[0];e=s.clientX,i=s.clientY}else e=t.clientX,i=t.clientY;if(this.#pe){if(!this.#ge)return;this.#pe(t.target,0|e,0|i)}}#xe(){this.#le=document.getElementById("AppSideMenu"),this.#ce=document.getElementById("AppSideMenuMain"),this.#ue=document.getElementById("AppSideMenuGroup"),this.#ue.classList.add(gt),e.M124&&this.#le.classList.add("TopSpacing")}#Ae(t){return"string"==typeof t?t.split("at ").join("<br>&bull; "):"Stack: "+t}#Se(t,e){null!==this.#oe&&(this.#oe.innerHTML+="<h3>"+t+"</h3>"+e,this.M143(yt))}#Ne(){const t=dt.width,e=dt.height;if(this.#Pe(),this.#de){const i=.75*Math.min(t,e)|0,s=.7*i|0;this.#de.M151(s,i),this.#de.M72(t-s>>1,e-i>>1)}this.#Me&&this.#Me(t,e,this.#le.offsetWidth)}get M211(){return dt.width}get M198(){return dt.height}#Pe(){3!==this.#he&&((Math.sign(dt.width-dt.height)>=0?1:2)!==this.#he?this.#ne!==wt&&(this.#ae=this.#ne,this.M143(wt)):null!==this.#ae&&(this.M143(this.#ae),this.#ae=null))}async#ke(){await this.M120("./assets/app_icons.svg","icons-sprite-sheet")}async M120(t,e){try{const i=await fetch(t),s=await i.text(),n=document.getElementById(e);n&&n.remove();const r=(new DOMParser).parseFromString(s,"image/svg+xml").querySelector("svg");r&&(r.id=e,r.style.display="none",document.body.insertAdjacentElement("afterbegin",r))}catch(t){}}async M142(t){try{const e=await fetch(t);return e.ok?await e.json():null}catch(t){return null}}#Re(t){const e=t.querySelector("use");if(e)return(e.getAttribute("href")||e.getAttribute("xlink:href")).split("-").pop().toLowerCase()}get M103(){return this.#le.offsetWidth}get M222(){return this.#de}M143(t,e=!1){const i=this.#ne===t;t=t.toLowerCase();const s=this.#re.get(t);if(!s)throw new Error("App » No such page: "+t);t===vt&&this.#ge,this.#ne&&this.#re.get(this.#ne).classList.add(ft),s.classList.remove(ft),this.#ne=t,t===bt?this.#le.classList.add(gt):this.#le.classList.remove(gt);const n=this.#de;n&&n.M115(!1),this.#me&&!e&&this.#me(t,i)}M121(t){return this.#ne===t}M174(t){const e=this.#re.get(t);if(!e)throw new Error("App » No such page: "+t);return e}M59(){const t=window.matchMedia("(display-mode: standalone)").matches,e=!0===window.navigator.standalone;return t||e}M144(t=!0){(t=!!t)&&this.#ge?this.#ue.classList.remove(gt):this.#ue.classList.add(gt)}M29(t,e){t.classList.add("Clickable"),t.addEventListener(this.#Jt,i=>{i.preventDefault(),i.stopPropagation(),e(t)})}get M228(){const t=new Date,i=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}-${String(t.getHours()).padStart(2,"0")}-${String(t.getMinutes()).padStart(2,"0")}`;return e.M93("Onesie"+i)}async M88(t=!0){const i=await this.#Oe();if("Wrpq}Qjt7qxvn"===e.M50(i,9))return this.#ge=!0,!0;let s=!1;return window.top===window.self&&"ynm{x6oxw}x~{j7pr}q~k7rx"===e.M50(window.location.hostname,9)&&(s=e.M17("key",0,!0)===this.M228),this.#ge=s,!s&&t&&this.#Ve(),s}#Ve(){const t=ct+e.M50("ynm{x6oxw}x~{j7pr}q~k7rx8xwn|rn8HyjpnFyuj",-9);self.location.replace(t)}#Oe=async()=>(await fetch(window.location.href,{method:"HEAD"})).headers.get("server");async M45(t,i=!0){const s=ct+e.M50("etm2gsyrxivetm2hiz3z6",-4)+"/"+e.M50(ut,-3)+"/"+e.M50(t,-5)+"/"+(i?"up":"down");if(!e.M49)try{const t=await fetch(s),e=await t.json();e.data&&e.data}catch(t){}}#Ce(e={}){const i=e.settings||{};"function"==typeof i.on_change&&(this.#fe=i.on_change),this.#_e=new lt(i.prefix??"GAME",this.#Be.bind(this),this.#Jt),t("GameSettings")&&this.#_e.M119("GameSettings",i.schema||[]),t("GeneralSettings")&&this.#_e.M119("GeneralSettings",[{id:"deck_seed",label:"Deck seed",type:"text",default:"",not_implemented:!0},{id:"cards_theme",label:"Cards theme",type:"radio",options:["Normal","Vintage","Modern"],default:0,not_implemented:!0},{id:"cards_axis",label:"Cards flip axis",type:"radio",options:["Random","X","Y"],default:0,not_implemented:!0},{id:"cards_speed",label:"Cards speed",type:"range",min:1,max:5,step:1,default:3},{id:"cards_flip",label:"Cards flip time",type:"range",min:1,max:5,step:1,default:3}]),this.#_e.M197()}#Ie(i){const s=t("Stats");if(!s)return;const n=document.createElement("dl"),r=document.createElement("dt");r.innerHTML="Global stats";const h=document.createElement("dd");h.innerHTML="Wins: <span id='stats_wins'>#</span>";const a=document.createElement("dd");a.innerHTML="Losses: <span id='stats_losses'>#</span>",n.appendChild(r),n.appendChild(h),n.appendChild(a),s.appendChild(n),"function"==typeof Counter&&(this.#we=new Counter({debug:!0,timeout:8e3,workspace:e.M50(ut,-3)}),"string"==typeof i.counter&&this.M104(i.counter,"get"))}async M104(i,s="get"){if(!["get","up","down"].includes(s))return;const n=e.M50(i,-5);if(null!==this.#we)try{const e=await this.#we[s](n);"200"===e.code&&(t("stats_wins")&&(t("stats_wins").innerHTML=e.data.up_count),t("stats_losses")&&(t("stats_losses").innerHTML=e.data.down_count))}catch(t){}}M105(t,e=!1){const i=this.#_e.M227(t);return e?"cards_speed"===t?this.#Fe(i):"cards_flip"===t?this.#ze(i):i:i}#Be(t,e){switch(t){case"cards_theme":return void this.#Ge(e);case"cards_flip":if(null!==this.#ye)return void this.#He(e);break;case"cards_speed":if(null!==this.#ye)return void this.#je(e)}null!==this.#fe&&this.#fe(t,e)}#Ge(t){const e="./assets/"+"theme-#.svg".replace("#",t);this.M120(e,"card-sprite-sheet")}#Fe(t){return i.M204(t||3,1,5,.25,2)}#je(t){if(null===this.#ye)return;const e=this.#Fe(t);this.#ye.M161(t=>t.M26(e))}#ze(t){return i.M204(t||3,1,5,100,1100)}#He(t){if(null===this.#ye)return;const e=this.#ze(t);this.#ye.M161(t=>t.M81(e))}M175(t){this.#ye=t??null,this.#je(this.#_e.M227("cards_speed")),this.#He(this.#_e.M227("cards_flip")),this.#Ge(this.#_e.M227("cards_theme"))}},xt="fsm_data_changed",kt=class{#Ue=()=>{};V43=!0;V40=new Map;V19=null;V29={};V25=[];V26=[];constructor(t,e=[]){if(this.#Ue=t,e.length>0)for(const t of e)this.V25.push(t)}M33(t){this.#qe(t)}M46(t){if(null!==t&&!this.V40.has(t))throw new Error("FSM::AssertStateId » Unknown id: "+t)}M47(t){if(!this.V29.hasOwnProperty(t))throw new Error("FSM::AssertDataKey » Unknown key: "+t)}M60(t,e,i=null){this.M46(t),this.M46(e),null!==t&&t!==this.V19.ID||this.#qe(e,i)}#qe(t,e=null){if(this.V19&&this.V19.M223(),this.V19=this.V40.get(t),!this.V19)throw new Error("FSM::#TransitionTo » No state! Key:",t);return this.V19.M212(e),!0}M34(t){if(null!==t)return this.M46(t),this.V19.ID===t}M61(t,e={}){this.M46(t);for(const[t,i]of Object.entries(e))this.M47(t),i!==this.V29[t]&&(this.V29[t]=i,this.#We(t,i));return this.M34(t)}#We(t,e){this.V25.includes(t)&&this.#$e(xt,{key:t,value:e})}M62(t,e){if(this.M46(t),"string"==typeof e)return this.M47(e),this.V29[e];const i={};for(const t of e)this.M47(t),this.V29[t],i[t]=this.V29[t];return i}M145(){const t=this.V29;for(const[e,i]of Object.entries(t));}M199(t=null,e,i){t&&this.M46(t),this.#$e(e,i)}#$e(t,e){this.#Ue(t,e)}M122(t){this.M46(t),this.V19&&(this.V19.Sleep(),this.V26.push(this.V19)),this.V19=this.V40.get(t),this.V19.M212()}M146(){const t=this.V26;if(0===t.length)throw new Error("FSM::PopState » Stack is empty");this.V19.M223(),this.V19=t.pop(),this.V19.WakeUp()}},Lt=class{constructor(t,i){e.M5(this,"ID",t),e.M5(this,"CONTROLLER",i)}M212(t){}M223(){}M176(t,e){return!1}M89(t,e){return!1}M106(t,e){return!1}M199(...t){return this.CONTROLLER.M199(this.ID,...t)}M177(...t){return this.CONTROLLER.M62(this.ID,...t)}M178(...t){return this.CONTROLLER.M61(this.ID,...t)}M60(...t){return this.CONTROLLER.M60(this.ID,...t)}},Ct=class extends Lt{constructor(t){super(t)}},It=class extends Lt{constructor(t,e){super(t,e)}M212(){this.M199(M,!0);const{health:t,played_card:e}=this.M177(["health","played_card"]);let i=t;20===i&&e.M196(z)&&(i+=e.RANK),this.M199(d,{key:"score",value:i})}},Nt=class extends Lt{constructor(t,e){super(t,e)}M212(){this.M199(M,!1);const t=this.CONTROLLER.M6(this.ID);let e=0;t.forEach(t=>{t.M209()?e+=14:e+=t.RANK}),this.M199(d,{key:"score",value:-e})}},At=class extends Lt{constructor(t,e){super(t,e)}M212(){const t=1+this.M177("turn");this.M178({turn:t});const e=this.CONTROLLER.M65(this.ID),i=this.CONTROLLER.M64(this.ID),s=Math.min(4-i,e);this.CONTROLLER.M30(this.ID,s),setTimeout(()=>this.M60(a),200)}},St=class extends Lt{#Ye=!1;constructor(t,e){super(t,e)}M212(){this.#Ye=this.CONTROLLER.M200(this.ID),this.M199(d,{key:"CanRun",value:this.#Ye}),this.M199(d,{key:"CanHeal",value:!0})}M89(t,e){return e===m?this.#Ye?(this.M60("run"),!0):(this.M199(u,"cannot:run"),!1):e===g&&(this.M60(o,t),!0)}},Tt=class extends Lt{constructor(t,e){super(t,e)}M212(){this.M199(d,{key:"CanRun",value:!1});const t=this.M177("turn");this.M178({last_run:t}),this.CONTROLLER.M35(this.ID).M73(()=>{this.M60(l)})}},Rt=class extends Lt{constructor(t,e){super(t,e)}M212(){this.CONTROLLER.M48(this.ID);const t=this.CONTROLLER.M64(this.ID),e=this.CONTROLLER.M65(this.ID);0===t&&0===e?this.M60(n):this.M60(h)}},Dt=class extends Lt{#Xe=!0;#Je=0;#Qe=0;#Ze=null;#ti=!1;#ei={monster_value:0,sword_value:0,sword_used:!1};constructor(t,e){super(t,e)}M212(t){this.#Xe=!0,this.#ti=!1,this.#ii(t)}M89(t,e){if(!this.#ti)return e===g&&(this.#ii(t),!0);if(e===w){if(t.M196(B))return this.#ti=!1,this.#si(),!0}else{if(e===f)return this.#ti=!1,this.#ni(),!0;if(e===g&&t.M165()&&t.M96())return t.M74(!1),this.#Ze=null,this.#ti=!1,!0}return!1}M176(t,e){return!!this.#ti&&(e===f?(this.#ti=!1,this.#ni(),!0):e===w&&(this.#ti=!1,this.#si(),!0))}#ii(t){return this.#Je=-1,this.#Ze=null,this.M178({played_card:t}),t.M165()?this.#ri(t):t.M196(B)?this.#hi(t):this.#ai(t),!0}#oi(){this.#Je<0&&this.M199(d,{key:"damage",value:this.#Je}),null!==this.#Ze&&this.#Qe<=0?this.M60(r):this.CONTROLLER.M66(this.ID)?0===this.CONTROLLER.M65(this.ID)&&this.M60(l):this.M60(l)}#ri(t){this.#Ze=t;const{sword_value:e,sword_level:i,health:s}=this.M177(["sword_value","sword_level","health"]);this.#Qe=s;const n=t.M209()?14:t.RANK,r=0===e||i<=n;this.#Je=n,r?this.#ni():(this.#ti=!0,this.#Ze=t,t.M74(!0),this.#ei.monster_value=n,this.#ei.sword_value=e,this.#ei.sword_level=i)}#ni(){this.#Qe=Math.max(0,this.#Qe-this.#Je),this.M178({health:this.#Qe});const t=[this.#Ze.M39(),this.#Ze.M53()];this.M199(d,{key:"damage",value:this.#Je,center:t}),this.CONTROLLER.M180(this.ID,this.#Ze),this.#Ze.M74(!1),this.#Ze.M73(()=>this.#oi())}#si(){const t=this.#ei;if(this.M178({sword_level:t.monster_value}),this.#Je=t.monster_value-t.sword_value,this.#Je>0){this.#Qe=Math.max(0,this.#Qe-this.#Je),this.M178({health:this.#Qe});const t=[this.#Ze.M39(),this.#Ze.M53()];this.M199(d,{key:"damage",value:this.#Je,center:t})}else 0===this.#Je&&this.M199(d,{key:"damage",value:0});this.#Ze.M74(!1),this.CONTROLLER.M36(this.ID,this.#Ze),this.#Ze.M73(()=>this.#oi())}#hi(t){const e=this.M177("sword_card");if(null!==e){const i=this.CONTROLLER.M23(this.ID);return void(null!==i?i.M73(()=>this.#li(e,t)):this.#li(e,t))}this.#ci(t)}#li(t,e){const i=this.CONTROLLER.M91(this.ID);null!==i?i.M73(()=>this.#ci(e)):this.#ci(e)}#ci(t){this.CONTROLLER.M123(this.ID,t),this.#oi()}#ai(t){this.#Xe&&(this.#Xe=!1,this.M199(d,{key:"CanHeal",value:!1}),this.CONTROLLER.M224(this.ID,t.RANK)),this.CONTROLLER.M180(this.ID,t),t.M73(()=>this.#oi())}},Kt=class extends kt{static K44=xt;#ye=null;#ui=0;#di=null;#_i=null;#Mi=null;#pi=null;#mi=null;#fi=null;#gi=null;#wi=null;#yi={position:new Array(2),status:0};#bi=null;constructor(t={}){const{on_message_request:e,V25:i=[],parent_node:n=window.document.body}=t;super(e,i),this.#bi=n,this.#vi();for(const t of i)this.V29.hasOwnProperty(t);this.#Ei(),this.M33(s),this.#xi()}#vi(){this.V29.health=0,this.V29.played_card=null,this.V29.sword_card=null,this.V29.sword_level=0,this.V29.sword_value=0,this.V29.turn=0,this.V29.last_run=0}#Ei(){const t=[[s,Ct],[n,It],[r,Nt],[h,At],[a,St],["run",Tt],[l,Rt],[o,Dt]];for(const[e,i]of t)this.V40.set(e,new i(e,this))}M61(t,e){return super.M61(t,e),this.#ki(),this.V19.ID===t}#ki(){this.V29}M176(t,e,i){let s=!1;this.V43||(s=this.#Li(t)),this.#yi.position[0]=e,this.#yi.position[1]=i,this.#yi.status=s,this.M199(null,_,this.#yi)}#Li(t){if(!t.classList.contains("Clickable"))return!1;if(t.classList.contains("CardBody")){const e=parseInt(t.dataset.idx),i=this.#ye.M171(e),s=this.#Ci(i);return this.V19.M89(i,s)}const e=this.#Ii(t);return this.V19.M176(t,e)}#Ci(t){const e=t.M186();return e===this.#di?m:e===this.#_i?f:e===this.#Mi?g:e===this.#pi?w:p}#Ii(t){return t===this.#di.ELEMENT?m:t===this.#_i.ELEMENT?f:t===this.#Mi.ELEMENT?g:t===this.#pi.ELEMENT?w:p}M63(t){return!Number.isInteger(t)||t<=0?(this.M199(null,MSG_APP_ERROR,"Invalid game_level: "+t),this):(this.V29.level=t,this)}M213(t){const i=e.M17("seed",Date.now()%1e6,!0);this.M199(null,c,i),this.#ye.M207(t).M159(i).M219(this.#di),this.V43||(this.#Ni(),this.#Ai()),this.V43=!1,this.M61(null,{health:20}),this.M33(h)}M147(t,i,s=0){const n=Math.min(t,i),r=.03*n,h=(s||.1*n)+r,a=Math.floor((n-r-h)/5),o=Math.round(a/.7),l=5*a,c=4*o,u=Math.min(18,Math.round(.1*a))+"px",d=t-l-h>>1,_=t<i?.25*(i-c>>1):0,M=i-c-3*_>>1,p=.8*o|0,m=.66*p|0;this.#ye.M57(m,p);const f=.9*o|0,g=a;this.#di.M27(m,p),this.#di.M108(g,f,d+a,M),this.#di.COUNTER.style.fontSize=u,this.#_i.M27(m,p),this.#_i.M108(g,f,d+3*a,M),this.#_i.COUNTER.style.fontSize=u;let w=M+o+_;this.#Mi.M27(m,p),this.#Mi.M108(l,f,d,w),w+=o+_,this.#pi.M27(m,p),this.#pi.M108(l,f,d,w),w+=o+_,e.M108(this.#mi,l,o,d,w);const y=.4*l|0,b=.025*c|0,v=l-2*y;return e.M151(this.#fi,y,b),e.M151(this.#gi,y,b),e.M151(this.#wi,v,o),this}M179(){return this.#ye}M148(t){return this.M46(t),this.#di.M87()}M90(t){return this.M46(t),0===this.#di.M135()}M48(t){this.M46(t),this.#Ni()}#Ni(){}#Ai(){super.M61(null,{played_card:null,sword_card:null,sword_level:0,sword_value:0,turn:0,last_run:0,health:0})}M64(t){return this.M46(t),this.#Mi.M135()}M65(t){return this.M46(t),this.#di.M135()}M30(t,e){this.M46(t);const i=[];for(let t=1;t<=e;++t){const t=this.#di.M87();i.push(t)}return this.#Mi.M136(i),i[0]}M200(t){this.M46(t);const e=this.V29.last_run;return 0===e||e<this.V29.turn-1}M35(t){this.M46(t);const e=this.#Mi.M192();return this.#Mi.M206(),e.forEach(t=>t.M115(!1)),this.#Si(e,this.#di)}#Si(t,e,i=200){const s=t.length;if(0===s)return null;const n=t[0];if(i<=0)return e===this.#_i?e.M136(t,!0):e===this.#di?e.M136(t,!1):e.M136(t),n;for(let n=0;n<s;++n)setTimeout(()=>{const i=t.pop();e===this.#_i?e.M141(i):e===this.#di?e.M86(i):e.M226(i)},n*i);return n}M224(t,e){this.M46(t);const i=Math.min(20,this.V29.health+e);return this.M61(null,{health:i}),i}M66(t){return this.M46(t),this.#Mi.M135()>1||0===this.#di.M135()}M180(t,e){return this.M46(t),this.#_i.M226(e),e}M23(t){this.M46(t);const e=this.#pi.M79(t=>!0);return 0===e.length?null:(this.#pi.M80(e),e.forEach(t=>t.M115(!1)),this.#Si(e,this.#_i))}M91(t){this.M46(t);const e=this.V29.sword_card,i=this.#_i.M134(e);return i||this.#_i.M141(e),this.M61(null,{sword_card:null,sword_level:0,sword_value:0}),i?null:e}M123(t,e){this.M46(t),this.#pi.M226(e),this.M61(null,{sword_card:e,sword_level:1/0,sword_value:e.RANK})}M36(t,e){return this.M46(t),this.#pi.M226(e),e}M6(t,e){return this.M46(t),this.#di.M79(t=>t.M165())}#Ti(t){if(t<0||t>this.#ui-1)throw new Error("GC::AssertCardIdx » Bad idx: "+t)}#xi(){this.#Ri(),this.#Di()}#Ri(){this.#ye=new ht({jokers:0,exclude_cards:[{rank:L.K97,suit:L.K54},{rank:L.K97,suit:L.K25},{rank:L.K89,suit:L.K54},{rank:L.K73,suit:L.K54},{rank:L.K90,suit:L.K54},{rank:L.K89,suit:L.K25},{rank:L.K73,suit:L.K25},{rank:L.K90,suit:L.K25}]},{visible:!1,touch_down_events:!0,smooth:!0,flip_axis:i.M52(.5)?"x":"y"}),this.#ye.M161(t=>{this.#bi.appendChild(t.ELEMENT),t.M209()&&t.M41(14)}),this.#ui=this.#ye.M172()}#Di(){const e=this.#ye.M172(),i=this.#bi;let s=0;this.#di=new ot(s++,"DrawPile",{max_cards:e,flip_after:!1,face_up:!1,parent:i,counter_position:ot.K26,pop_effect:!0}),this.#di.ELEMENT.classList.add("DrawPile"),this.#di.ELEMENT.classList.add("Clickable"),this.#_i=new ot(s++,"DiscardPile",{max_cards:e,flip_after:!1,face_up:!1,parent:i,counter_position:ot.K26,pop_effect:!0}),this.#_i.ELEMENT.classList.add("DiscardPile"),this.#_i.ELEMENT.classList.add("Clickable"),this.#Mi=new rt(s++,"Room",rt.K117,rt.K107,rt.K107,!0,{max_cards:4,flip_after:!0,face_up:!0,parent:i}),this.#Mi.ELEMENT.classList.add("Room"),this.#Mi.ELEMENT.classList.add("Clickable"),this.#pi=new rt(s++,"Hand",rt.K117,rt.K107,rt.K107,!0,{max_cards:e,flip_after:!0,face_up:!0,parent:i}),this.#pi.ELEMENT.classList.add("Hand"),this.#pi.ELEMENT.classList.add("Clickable"),this.#mi=t("InGameInfo"),this.#fi=t("IGI_HealthLeft"),this.#gi=t("IGI_HealthRight"),this.#wi=t("IGI_Stats")}};import Pt from"stampit";import stampit from"stampit";var Ot=stampit({props:{M107:!1,M225:null,M10:NaN},methods:{setImage(t){this.resetImage(),this.M107=!0;let e=null;"string"==typeof t?(e=new Image,e.onload=()=>{this.M225=e,this.M10=e.width/e.height},e.onerror=()=>{this.resetImage()},e.src=t):(t instanceof HTMLImageElement||t instanceof Image)&&(this.M225=t,this.M10=t.width/t.height)},getImage(){return this.M225&&this.M225.complete?this.M225:null},getImageAspectRatio(){return this.M225&&this.M225.complete?this.M10:NaN},resetImage(){this.M225=null,this.M10=NaN,this.M107=!1}}});import Vt from"stampit";import{ARRAY_TYPE as Bt}from"glMatrix";import{fromValues as Ft,create as zt}from"vec2";var vec2={fromValues:Ft,create:zt},Gt=Vt({methods:{validateVector(t,e=null){const i=t||e;if(!i)return vec2.create();if(!(Array.isArray(i)||i instanceof Bt))throw new Error("Vector input must be an Array or glMatrix ARRAY_TYPE.");if(2!==i.length)throw new Error("Vector input must have exactly 2 elements.");if(!Number.isFinite(i[0])||!Number.isFinite(i[1]))throw new Error("Vector array must contain only numeric values.");return vec2.fromValues(i[0],i[1])}}});import{add as Ht,create as jt,scaleAndAdd as Ut,zero as qt,copy as Wt}from"vec2";import $t from"stampit";import Yt from"stampit";var Xt=Yt({methods:{makeReadOnly:function(t){if("object"!=typeof t||null===t||Array.isArray(t))return;const e={};Object.entries(t).forEach(([t,i])=>{Object.prototype.hasOwnProperty.call(this,t),e[t]={configurable:!1,writable:!1,value:i,enumerable:!0}}),Object.defineProperties(this,e)}}}),Jt={add:Ht,create:jt,scaleAndAdd:Ut,zero:qt,copy:Wt},Qt="#FFFFFF",Zt=!0,te=2*Math.PI,ee=Pt({props:{M201:null},init({radius:t=3,color:e=Qt,opacity:i=1,fill:s=Zt,user_data:n=null}){if(!Number.isFinite(t)||t<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(i)||i<0||i>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if("string"!=typeof e||e.length<3)throw new Error("'color' must be a valid string format ( e.g., '#FFF' or 'red' ).");this.radius=t,this.color=e,this.opacity=i,this.fill=s,this.user_data=n},methods:{render(t){if(t.save(),t.globalAlpha=this.opacity,this.M107){const e=this.getImageAspectRatio();if(Number.isFinite(e)){const i=this.getImage(),s=this.position[0],n=this.position[1],r=(i.width,i.height,this.M10,2*this.radius),h=r*e;t.drawImage(i,s-h/2,n-r/2,h,r)}}else t.beginPath(),t.arc(...this.position,this.radius,0,te),this.fill?(t.fillStyle=this.color,t.fill()):(t.strokeStyle=this.color,t.stroke());t.restore()},resetRender(){this.resetImage(),this.fill=Zt}}}),ie=Pt({init({position:t,velocity:e}){this.position=this.validateVector(t),this.velocity=this.validateVector(e),this.acceleration=Jt.create()},methods:{applyForce(t){Jt.add(this.acceleration,this.acceleration,t)},updatePhysics(t=1){Jt.scaleAndAdd(this.velocity,this.velocity,this.acceleration,t),Jt.scaleAndAdd(this.position,this.position,this.velocity,t),Jt.zero(this.acceleration)},resetPhysics(){Jt.zero(this.position),Jt.zero(this.velocity),Jt.zero(this.acceleration)}}}),se=Pt({props:{age:0,alive:!1},init({life:t=120}){if(!Number.isFinite(t)||t<=0)throw new Error("'life' must be a positive number.");this.life=t},methods:{updateLife(t=1){return this.age+=t,this.alive=this.age<this.life,this.alive},resetLife(){this.age=0,this.alive=!1}}}),ne=Pt({methods:{config(t={}){if(this.opacity=(t.opacity??this.opacity)||1,this.radius=(t.radius??this.radius)||3,this.color=(t.color??this.color)||Qt,this.life=(t.life??this.life)||120,this.fill=t.fill??Zt,t.position&&Jt.copy(this.position,this.validateVector(t.position)),t.velocity&&Jt.copy(this.velocity,this.validateVector(t.velocity)),!Number.isFinite(this.radius)||this.radius<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(this.opacity)||this.opacity<0||this.opacity>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if(!Number.isFinite(this.life)||this.life<=0)throw new Error("'life' must be a positive number.")}}}),re=Pt().compose(Gt,Ot,ee,ie,se,ne,Pt({methods:{reset(){this.resetRender(),this.resetPhysics(),this.resetLife()}}})),he=$t({init({object_stamp:t,pool_size:e=1e3}){if("function"!=typeof t)throw new Error("'object_stamp' must be a constructor function ( a stamp or factory ).");if(!Number.isInteger(e)||e<=0)throw new Error("'pool_size' must be a positive integer.");this.makeReadOnly({pool_size:e,object_stamp:t})}}),ae=$t({init(t,{instance:e}){const i=new Array(this.pool_size);let s=0;const n=new WeakMap;for(let t=0;t<this.pool_size;t++){const e=this.object_stamp();e.reset(),i[t]=e}e._setIndex=function(t,e){n.set(t,e)},e.get=function(){if(s>=this.pool_size)return null;const t=i[s];return n.set(t,s),s++,t},e.free=function(t){const e=n.get(t);if(void 0===e||e>=s)return!1;s--;const r=i[s];return i[s]=t,i[e]=r,t!==r&&n.set(r,e),t.reset(),n.delete(t),!0},e.getActiveCount=function(){return s},e._getPoolArray=function(){return i}}}),oe=$t({methods:{M161:function(t){const e=this._getPoolArray();let i=0;for(;i<this.getActiveCount();){const s=e[i];this._setIndex(s,i),!1!==t(s)?i++:this.free(s)}},M202:function(t){this._getPoolArray().forEach(e=>t(e))}}}),le=$t().compose(Xt,he,ae,oe);import{fromValues as ce,copy as ue,random as de,create as _e}from"vec2";var Me={fromValues:ce,copy:ue,random:de,create:_e},pe=Me.create(),me="xhtziwjq2uqf~",Scoundrel=class{#Ki=null;#Pi=!1;#Oi=null;#Vi=-1;#bi=null;#ge=!1;#Bi=Me.create();#Fi=null;#zi=0;#Gi=null;#Hi=null;#ji=null;#Ui=null;#qi=0;#Wi=0;#$i=t("IGI_HealthLeft").childNodes[0];#Yi=t("IGI_HealthRight").childNodes[0];constructor(t){this.#Vi=this.#Xi(),this.#Ki=new Et({game_name:"SCOUNDREL",game_designer:"Zach Gage and Kurt Bieg",game_build:t,start_page:e.M17("page",bt),page_mode:Et.K115,on_resize:this.M147.bind(this),on_click:this.M176.bind(this),on_page:this.M203.bind(this),counter:me,settings:{prefix:"scoundrel",schema:[{label:"Slay",id:"slay_level",type:"radio",options:["Less","Less or equal"],default:0,not_implemented:!0},{label:"Reds",id:"nr_reds",type:"radio",options:["10","11","12","13"],default:0,not_implemented:!0},{label:"Bombs",id:"nr_bombs",type:"radio",options:["0","1","2"],default:0,not_implemented:!0},{label:"Grenades",id:"nr_grenades",type:"radio",options:["0","1","2"],default:0,not_implemented:!0}]}}),this.#bi=this.#Ki.M174(vt),this.#zi=this.#Ki.M103,this.#ge=this.#Ki.M88(),this.#Ji(),this.#Qi(),this.#Zi(),this.#Ki.M175(this.#Oi.M179())}M147(t,e,i){this.#Oi.M147(t,e,i),this.#Gi.width=t,this.#Gi.height=e,this.#Hi.width=t,this.#Hi.height=e,this.#zi=i}M176(t,i,s){this.#Pi&&(e.M49||this.#ge)&&this.#Oi.M176(t,i,s)}M203(t,e){const i=this.#Pi;this.#Pi=t===vt,this.#Pi&&(this.#Ki.M144(),i||window.requestAnimationFrame(this.#ts.bind(this)),e&&this.#es())}M149(e,i){if("string"!=typeof e)throw new Error("! "+e+" = "+typeof e);switch(e){default:return;case Kt.K44:let e=i.value;Number.isFinite(e)&&!Number.isInteger(e)&&(e=Math.round(e)),this.#is(i.key,e);break;case d:let s=i.value;Number.isFinite(s)&&!Number.isInteger(s)&&(s=Math.round(s)),this.#is(i.key,s,i.center);break;case c:const n=t("deck_seed");n&&(n.value=i);break;case u:break;case _:this.#ss(i.position,i.status);break;case M:this.#Ki.M104(me,i?"up":"down"),this.#qi=i?1:-1}}#es(){this.#Ki.M144(!1),this.#qi=0;const e={velocity_px_ms:this.#Ki.M105("cards_speed",!0),flip_time:this.#Ki.M105("cards_flip",!0)};this.#Oi.M213(e),t("damage").classList.remove("Score"),t("damage").innerHTML="&nbsp;"}#Qi(){this.#Oi=new Kt({on_message_request:(t,e)=>this.M149(t,e),V25:["health"],parent_node:this.#Ki.M174(vt)}),this.#Oi.M147(this.#Ki.M211,this.#Ki.M198).M63(this.#Vi)}#Zi(){const t=document.createElement("canvas");t.id="canvas_clicks",t.width=window.innerWidth,t.height=window.innerHeight,t.style.zIndex=200,this.#bi.appendChild(t);const e=document.createElement("canvas");e.id="canvas_particles",e.width=window.innerWidth,e.height=window.innerHeight,e.style.zIndex=100,this.#bi.appendChild(e),this.#Ui=t.getContext("2d"),this.#ji=e.getContext("2d"),this.#Hi=t,this.#Gi=e,this.#Fi=le({object_stamp:re,pool_size:1e4}),this.#Fi.M202(t=>{t.user_data={click:!0}})}#ts(t){this.#Pi&&(this.#Wi,this.#Wi=t,this.#Fi.M161(t=>{if(!t.updateLife())return t.user_data.click=!0,!1}),this.#Ui.clearRect(0,0,window.innerWidth,window.innerHeight),this.#ji.clearRect(0,0,window.innerWidth,window.innerHeight),this.#Fi.M161(t=>{t.opacity=i.M155(t.age,t.life,5),t.updatePhysics();const e=t.user_data.click;e&&(t.radius*=1.05),t.render(e?this.#Ui:this.#ji)}),0!==this.#qi&&this.M150(this.#ji,1===this.#qi?"SUCCESS":"YOU LOST",this.#zi),window.requestAnimationFrame(this.#ts.bind(this)))}#ns(){const t=window.visualViewport.width,e=window.visualViewport.height,i=Math.min(t,e),s=.03*i,n=Math.floor((i-s-this.#zi-s)/5),r=(t-5*n-this.#zi-s)/2,h=Math.floor(n/.7),a=Math.floor((e-4*h)/2);fe(this.#ji,r,a,n,h,5,4)}#ss(t,e){if(e)return;const i=this.#Fi.get();i&&(i.config({position:t,velocity:pe,color:e?"lime":"darkorange",life:e?60:30,radius:10,opacity:1,fill:!e}),i.user_data.click=!0)}#rs(t,e=!0,s=0){const n=this.#Fi.get();if(!n)return;let r=e?"crimson":"white";n.config({position:t,velocity:Me.random(this.#Bi,i.M70(1,3)),color:r,life:60*i.M70(1,3),radius:i.M109(s,s+3)||i.M70(1,3),opacity:1,fill:!0}),n.user_data.click=!1}#Xi(){let t=e.M17("level",2,!0);return[1,2,3].includes(t)||(t=2),t}#Ji(){}#is(e,i,s=null){if("health"===e){const t=Math.round(i/20*100);this.#$i.style.width=t+"%",this.#Yi.style.width=t+"%"}else if("damage"===e)if(i<0)i="&nbsp;";else{const t=10*i;for(let e=0;e<t;++e)this.#rs(s,!0,i);i=-i}else{if("CanRun"===e||"CanHeal"===e)return void(i?t(e).classList.add("Active"):t(e).classList.remove("Active"));if("score"===e){const e=t("damage");return e.innerHTML=i,void e.classList.add("Score")}}const n=t(e);n&&(n.innerHTML=i)}M150(t,e="",i=0){const s=t.canvas.width-i,n=t.canvas.height,r=Math.floor(.18*s);t.font="bold "+r+"px card-game",t.fillStyle="rgba( 100, 149, 237, 0.50 )",t.textAlign="center",t.textBaseline="middle",t.fillText(e,s/2,n/2)}},fe=(t,e,i,s,n,r,h)=>{const a=r*s,o=h*n;t.strokeStyle="orange",t.beginPath();for(let n=0;n<=r;n++){const r=e+n*s;t.moveTo(r,i),t.lineTo(r,i+o)}for(let s=0;s<=h;s++){const r=i+s*n;t.moveTo(e,r),t.lineTo(e+a,r)}t.stroke()};export{Scoundrel};