// Build: February 13 2026 00:56

export const BUNDLE_URL = import.meta.url.split( '/' ).pop();

export const BUNDLE_ID = "2026-0213-0056";

function t(t){return document.getElementById(t)}class e{static get M49(){return window.location.href.includes("nighthawk.home")}static get M67(){return screen.orientation&&screen.orientation.type?screen.orientation.type.includes("landscape"):window.innerWidth>window.innerHeight}static get M125(){return navigator.maxTouchPoints>0}static get M92(){return navigator.userAgentData&&"Android"===navigator.userAgentData.platform||/android/i.test(navigator.userAgent)}static get M37(){const t=window.matchMedia("(display-mode: standalone)").matches,e=!0===window.navigator.standalone;return t||e}static get M182(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||/Mac/.test(navigator.userAgent)&&navigator.maxTouchPoints>1}static M5(t,e,i){Object.defineProperty(t,e,{value:i,writable:!1,enumerable:!0,configurable:!1})}static M11(t,e){if(!Array.isArray(t))return;const i=t.indexOf(e);-1!==i&&t.splice(i,1)}static M12(t){if(!Array.isArray(t))return t;for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}static M24(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}static M93(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}static M17(t,e=null,i=!1){let s=new URLSearchParams(window.location.search).get(t);if(null===s)return e;if(i){const t=parseInt(s,10);return isNaN(t)?e:t}return s}static M68(t,e=document.documentElement,i=null){t.startsWith("--")||(t="--"+t);const s=window.getComputedStyle(e).getPropertyValue(t).trim();return""===s?i:s.replace(/^['"]|['"]$/g,"")}static M18(){if(e.M182)return;const t=document.documentElement,i=t.requestFullscreen||t.webkitRequestFullscreen;if(!i)return;const s=e.M92?{navigationUI:"hide"}:{};i.call(t,s).catch(t=>{})}static M19(t){const e=document.querySelector('script[type="importmap"]');if(!e)throw new Error('GetImportMapValue » <script type="importmap"> not found in DOM.');const i=JSON.parse(e.textContent),s=i.imports?.[t];if(void 0===s)throw new Error("GetImportMapValue » Key not found in imports: "+t);return s}static M50(t,e=0){if("string"!=typeof t)return t;let i="";for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);i+=String.fromCharCode(n+e)}return i}static M152(t,e,i){const s=t.style;s.width=e+"px",s.height=i+"px"}static M108(t,e,i,s,n){const r=t.style;r.width=e+"px",r.height=i+"px",r.left=s+"px",r.top=n+"px"}static M205(t){return new Promise(e=>{setTimeout(()=>e(!0),t)})}}class i{static get M183(){return(1+Math.sqrt(5))/2}static get M184(){return 2*Math.PI}static get M153(){return Math.PI/2}static get M69(){return Math.PI/180}static get M51(){return 180/Math.PI}static M154(t){return t*i.M69}static M155(t){return t*i.M51}static M109(t,e){return Math.floor(Math.random()*(e-t+1))+t}static M70(t,e){return t+Math.random()*(e-t)}static M52(t=.5){return Math.random()<t}static M25(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}static M217(t,e,i){return t+(e-t)*i}static M206(t,e,i,s,n){return s+(t-e)*(n-s)/(i-e)}static M207(t,e,i){return Math.max(e,Math.min(t,i))}static M126(t,e,i,s){return Math.hypot(i-t,s-e)}static M156(t,e,i=2){if(e<=0)return 0;const s=t/e;return 1-Math.pow(s,i)}}var s="busy",n="success",r="fail",h="mk-room",a="room-decision",o="run",l="face-room",c="turn_ended",u="msg#deck:seed",d="user_error",_="ui:update",M="ui_click",p="game_over",m="location:unknown",f="location:draw",g="location:discard",w="location:room",y="location:hand",b=Object.defineProperty,v=class t{static K107=100;static K112=199;static K20=100;static K27=!0;#t=0;#e=0;#i=100;#s=-1;#n=0;#r=0;#h=null;#a=null;#o=!1;#l=0;#c=0;#u=0;#d=0;#_=0;#M=0;#p=!1;#m=[];#f=!0;#g=!1;constructor(i,s,n=!1,r=0,h={}){e.M5(this,"IDX",i),e.M5(this,"ID",s);const{parent:a=null,is_box:o=!1}=h;e.M5(this,"IS_BOX",o),this.#l=r||t.K20,!0===n?this.#h=document.createElement("div"):n instanceof Node&&(this.#h=n),this.#h&&(this.#w(),a instanceof Node&&a.appendChild(this.#h))}#w(){e.M5(this,"ELEMENT",this.#h),this.#h.id=this.ID,this.#h.style.position="absolute",this.#h.style.top="0px",this.#h.style.left="0px",this.#h.style.zIndex=this.#i,this.#h.classList.add("FlexBoxEntity"),this.#h.dataset.smooth=this.#o?"yes":"no",this.#h.addEventListener("transitionend",this.#y.bind(this))}M157(){return this.#h&&(this.#h.remove(),this.#h=null,this.#m=null),this}M71(){return this.#h.offsetWidth,this}M94(){return this.#h}M127(){return this.#n}M110(){return this.#r}M185(){return this.#t}M158(){return this.#e}M108(t,e,i,s){this.#n=0|t,this.#r=0|e,s|=0,i|=0;const n=this.#t!==s||this.#e!==i;return n&&(this.#t=s,this.#e=i),this.#b(n),this}#v(){const t=window.getComputedStyle(this.#h).translate;t&&"none"!==t||(this.#u=0,this.#c=0);const e=t.split(" ");this.#u=parseFloat(e[0])||0,this.#c=parseFloat(e[1])||0}M72(t,e){if(t|=0,e|=0,this.#t===e&&this.#e===t)return this;if(this.#o){const i=this.M1(t,e);this.#E(i)}return this.#t=e,this.#e=t,this.#b(!0),this}M1(t,e){this.#v();const i=t-this.#u,s=e-this.#c;return Math.sqrt(i*i+s*s)/this.#l}M152(t,e){return t|=0,e|=0,this.#n===t&&this.#r===e||(this.#n=t,this.#r=e,this.#b(!1)),this}#b(t=!0){this.#x();const e=this.#h.style;e.width=this.#n+"px",e.height=this.#r+"px",t?(e.translate=this.#e+"px "+this.#t+"px 0px",this.#o&&(e.zIndex=199+this.#s)):e.zIndex=this.#i}#y(t){"translate"===t.propertyName&&(this.#v(),Math.abs(this.#u-this.#e)<1&&Math.abs(this.#c-this.#t)<1&&(this.#h.style.zIndex=this.#i,this.#p&&this.#k()))}M38(){return this.#M>0}M128(){return this.#M>0}M129(){return this.#M>0}#k(){t.K27;const e=this.#m.length;for(let t=0;t<e;t++)"function"!=typeof this.#m[t]||this.#m[t](this);this.#m.length=0}M111(t=!0){return this.#o=!!t,this.#h.dataset.smooth=this.#o?"yes":"no",this}M130(){return this.#o}M112(){return new Promise(t=>this.M73(()=>t(this)))}M73(t){return"function"!=typeof t?this:this.#p?(this.#m.push(t),this):void 0}M7(){this.#m.length=0}M13(t=!0){return this.#p=!!t,this}Error(t,e,...i){this.constructor.name,i.length>0&&i.forEach((t,e)=>{})}M113(){return this.#s}M114(t=-1){return this.#s=t,this}M186(t,e=-1){return null!==this.#a?(this.Error("SetBox","Already set",this.#a,t),this):(this.#a=t,e>=0&&(this.#s=e),this)}M131(){return this.#a=null,this.#s=-1,this}M187(){return this.#a}M218(t){return this.#a===t}M188(){return null!==this.#a}#E(t){return!Number.isFinite(t)||t<0?(this.Error("SetTranslationTime","Bad number",t),this):this.#h?(this.#h.style.transitionDuration=t+"ms",this):this}M26(e=0){return this.#l=e||t.K20,this}M219(t){return t|=0,this.#i===t||(this.#i=t,this.#h.style.zIndex=t),this}M132(t){return!Number.isFinite(t)||t<0?(this.Error("SetBaseZ","Bad number",t),this):(t|=0,this.#i<t&&(this.#i=t),this.#h.style.zIndex=t,this)}#x(){this.#d=this.#t+(this.#r>>1),this.#_=this.#e+(this.#n>>1)}M53(){return this.#d}M39(){return this.#_}M4(t,e){const i=t-this.#e,s=e-this.#t;return Math.sqrt(i*i+s*s)/this.#l}M115(){return this.#f}M133(){return!this.#f}M95(t=!0){return t=!!t,this.#f===t||(this.#f=t,this.M15(t)),this}M40(){return this.#f=!this.#f,this.M15(this.#f),this}M96(){return this.#g}M74(t=!0){return t=!!t,this.#g===t||(this.#g=t,this.M20(t)),this}M31(){return this.#g=!this.#g,this.M20(this.#g),this}},E=1/0,x=class extends v{static K119=11;static K108=12;static K109=3;static K113=1;static K120=2;static K110=4;static K103=5;static K111=6;static K114=7;#L=11;#C=!0;#I=[];#N=null;#A=null;#S=null;#T=E;#R=0;#D=0;#K=0;#P=0;#O=!1;#V=0;#B=0;#F=!1;#z=0;#G=0;#H=v.K107;#j=null;#U=null;#q=null;#W=null;#$=!1;#Y=0;#X=!1;constructor(t,e,i,s,n,r=!1,h={}){const{max_count:a=E,sorting:o=null,tuck:l=!1,uniform:c=!1,parent:u=null,velocity_px_ms:d=0,reverse_z:_=!1}=h;super(t,e,r,d,{is_box:!0,parent:u}),this.#T=a,this.M75(_),this.#L=i,11!==i&&12!==i&&this.Error("FlexBox","Bad orientation",i),this.#C=11===this.#L,"function"==typeof o&&(this.#N=o);const M=Number.isFinite(this.#T)?this.#T:64;this.#j=new Int32Array(M),this.#U=new Int32Array(M),s=s||4,this.#S=this.#J(s),3!==(n=n||3)&&1!==n&&2!==n&&this.Error("FlexBox","Bad align",n),this.#A=this.#J(n),this.#F=c,l>0&&this.M159(l),this.ELEMENT&&this.ELEMENT.classList.add("FlexBox")}M157(){super.M157(),this.#I=null,this.#A=null,this.#S=null,this.#N=null}#Q(t,e){if(t.length<e){const i=t.length<<1;t=new Int32Array(i>e?i:e)}return t}M230(t,e=!0){if(!(t instanceof v))return this.Error("Add","Not a FlexBoxEntity",t),this;if(this.#I.includes(t))return this.Error("Add","Already here",t),this;if(this.M192())return this.Error("Add","I am full",t),this;t.M188()&&t.M187().M191(t),e?this.#I.push(t):this.#I.unshift(t);const i=this.#I.length;let s=!e&&i>1;return t.M186(this,e?this.#I.length-1:0),this.#Q(this.#j,i),this.#Q(this.#U,i),null!==this.#N&&(this.#I.sort(this.#N),s=!0),s&&this.#Z(),this.#F?(0!==this.#z&&0!=this.#G||(this.#z=t.M127(),this.#G=t.M110(),this.#$>0&&this.#tt()),this.#V+=this.#z,this.#B+=this.#G):(this.#V+=t.M127(),this.#B+=t.M110()),this.#O=!0,this.M8(),this}M189(t){return this.M230(t,!1)}M190(t){return this.M230(t,!0)}M191(t){return t instanceof v?this.#I.includes(t)?(t.M131(),t.M7(),e.M11(this.#I,t),this.#Z(),this.#F?(this.#V-=this.#z,this.#B-=this.#G):(this.#V-=t.M127(),this.#B-=t.M110()),this.#O=!0,this.M8(),this):(this.Error("Remove","Not here",t.ID),this):(this.Error("Remove","Not a FlexBoxEntity",t),this)}M152(t,e){t|=0,e|=0,super.M152(t,e),this.#R=t,this.#D=e}M108(t,e,i,s,n=!0){return t|=0,e|=0,i|=0,s|=0,super.M108(t,e,i,s),this.#R=t,this.#D=e,this.#P=i,this.#K=s,n&&this.M8(),this}M27(t,e,i=-1){return this.#z=0|t,this.#G=0|e,this.#$>0&&this.#tt(),this.#F=!0,this.#O=!1,i>=0&&(this.#H=i),this.M14(),this}M75(t=!0){this.#X=!!t,this.M8()}M28(t=-1){t>=0&&(this.#H=0|t)}M14(){let t=0,e=0;const i=this.#I.length;if(i>0){if(this.#F){if(0===this.#z||0===this.#G){const t=this.#I[0];this.#z=t.M127(),this.#G=t.M110(),this.#$>0&&this.#tt()}t=i*this.#z,e=i*this.#G}else for(let s,n=0;n<i;n++)s=this.#I[n],t+=s.M127(),e+=s.M110();(isNaN(t)||isNaN(e))&&this.Error("UpdateEntitiesSize","total width/height is NaN"),(t<0||e<0)&&this.Error("UpdateEntitiesSize","total width/height is negative",t,e)}return this.#V=t,this.#B=e,this.#O=!0,this}#et(t=-1){if(-1===t&&(t=this.#I.length),0===t)return this;this.#O||this.M14();const e=this.#C;let i=e?this.#V:this.#B,s=this.#$&&t>1;if(s){const n=e?this.#R:this.#D;s=i>n,s&&(this.#it(t,n,i),i-=(t-1)*this.#Y)}return e?(this.#q=this.#S(!0,!0,i,t),this.#W=this.#A(!1,!1,this.#B,t)):(this.#W=this.#S(!0,!1,i,t),this.#q=this.#A(!1,!0,this.#V,t)),s&&this.#st(e,t),t}#it(t,e,i){this.#C?this.#z:this.#G;const s=(i-e)/(t-1);this.#Y=s}#st(t,e){const i=t?this.#q:this.#W;for(let t=1;t<e;t++)i[t]-=t*this.#Y}M159(t=!0){this.#$=!!t,this.#$&&this.M8()}M134(t){return this.#F||0===t?t<0||t>1?(this.Error("SetTuck","Tuck must be [ 0 .. 1 ]",t),this):(this.#$=t,this.#tt(),void(this.#I.length>1&&this.M8())):(this.Error("SetTuck","Cannot tuck non-uniform entities"),this)}#tt(){if(!this.#F)return void(this.#Y=0);const t=this.#C?this.#z:this.#G;this.#Y=t*this.#$|0}M72(t,e){super.M72(t,e),this.#P=t,this.#K=e}M8(t=!0){const e=this.#I.length;if(0===e)return this;t&&this.#et(e);const i=this.#H;for(let t=0;t<e;t++){const s=this.#I[t];this.#X?s.M219(i+(e-t)):s.M219(i+t),s.M72(this.#q[t],this.#W[t]),s.IS_BOX&&s.M8(!0)}return this}#nt(t,e=-1){if(e<0&&(e=t.M113()),this.#X){const i=this.#I.length;t.M219(this.#H+(i-e))}else t.M219(this.#H+e);return t.M72(this.#q[e],this.#W[e]),this}#J(t){switch(t){case 3:return this.#rt.bind(this);case 1:return this.#ht.bind(this);case 2:return this.#at.bind(this);case 4:return this.#ot.bind(this);case 5:return this.#lt.bind(this);case 6:return this.#ct.bind(this);case 7:return this.#ut.bind(this)}}#dt(t,e,i){const s=(t?this.#j:this.#U).subarray(0,i),n=e?this.#P:this.#K;var r=e?this.#z:this.#G;if(t&&this.#F)for(var h=0;h<i;++h)s[h]=n+h*r;else{var a=n;for(h=0;h<i;++h){if(t&&h>0){if(!this.#F){const t=this.#I[h-1];r=e?t.M127():t.M110()}a+=r}s[h]=a}}return s}#ht(t,e,i,s){return this.#dt(t,e,s)}#rt(t,e,i,s){const n=this.#dt(t,e,s),r=e?this.#R:this.#D,h=r-i>>1;var a=e?this.#z:this.#G;if(!t&&this.#F){const t=r-a>>1;for(var o=0;o<s;++o)n[o]+=t}else for(o=0;o<s;++o)if(t)n[o]+=h;else{if(!this.#F){const t=this.#I[o];a=e?t.M127():t.M110()}n[o]+=r-a>>1}return n}#at(t,e,i,s){const n=this.#dt(t,e,s),r=e?this.#R:this.#D,h=Math.round(r-i);var a=e?this.#z:this.#G;if(!t&&this.#F){const t=r-a;for(var o=0;o<s;++o)n[o]+=t}else for(o=0;o<s;++o)if(t)n[o]+=h;else{if(!this.#F){const t=this.#I[o];a=e?t.M127():t.M110()}n[o]+=r-a}return n}#ut(t,e,i,s){const n=this.#dt(t,e,s),r=(e?this.#R:this.#D)>>1;var h=e?this.#z:this.#G;const a=n[0];for(var o=0;o<s;++o){if(!this.#F){const t=this.#I[o];h=e?t.M127():t.M110()}n[o]=a+r-(h>>1)}return n}#lt(t,e,i,s){if(s<2)return this.#ht(t,e,i,s);const n=this.#dt(t,e,s),r=e?this.#R:this.#D,h=Math.round((r-i)/(s-1));for(var a=1;a<s;++a)n[a]+=a*h;return n}#ot(t,e,i,s){const n=this.#dt(t,e,s),r=e?this.#R:this.#D,h=Math.round((r-i)/(s+1));for(let t=0;t<s;++t)n[t]+=(t+1)*h;return n}#ct(t,e,i,s){if(s<2)return this.#rt(t,e,i,s);const n=this.#dt(t,e,s),r=((e?this.#R:this.#D)-i)/s,h=r>>1;for(let t=0;t<s;++t)n[t]+=h+t*r|0;return n}M76(t){return!Number.isFinite(t)||t<=0?(this.Error("SetMaxCount","Bad number",t),this):(this.#T=0|t,this)}M77(){return this.#T}M192(){return this.#I.length>=this.#T}M97(t){return"function"!=typeof t||(this.#N=t),this}M98(t){return this.#S=this.#J(t||4),this}M220(t){return"function"!=typeof t&&(t=this.#N),"function"!=typeof t||(this.#I.sort(t),this.#Z(),this.M8()),this}#Z(t=-1){if(t<0&&(t=this.#I.length),!(t<0))for(let e=0;e<t;++e)this.#I[e].M114(e)}M160(){const t=this.#I.length;return t<=1||(M12(this.#I),this.#Z(t),this.M8()),this}M161(){return 0===this.#I.length}M135(t){return this.#I.includes(t)}M136(){return this.#I.length}M162(t){if("function"!=typeof t)return this;const e=this.#I.length;for(let i,s=0;s<e;s++)i=this.#I[s],t(i);return this}M163(){return this.#I.length>0?this.#I[0]:null}M99(){if(this.#I.length<=0)return null;const t=this.#I[0];return this.M191(t),t}M164(){const t=this.#I.length;return t>0?this.#I[t-1]:null}M100(){const t=this.#I.length;if(t<=0)return null;const e=this.#I[t-1];return this.M191(e),e}M78(t){return t<0||t>=this.#I.length?(this.Error("GetEntityAt","Bad idx",t),null):this.#I[t]}M193(){return[...this.#I]}M79(t){return"function"!=typeof t?null:this.#I.filter(t)}M208(){const t=this.#I.length;if(0===t)return this;for(let e=0;e<t;e++){const t=this.#I[e];t.M131(),t.M7()}return this.#I.length=0,this.#V=0,this.#B=0,this.#O=!0,this}#_t(t=0){const e=this.#I.length+t;return e>this.#T?(this.Error("#PrepareBatchAdd","Total exceeds max_count",e),this):(e>0&&(this.#j=this.#Q(this.#j,e),this.#U=this.#Q(this.#U,e)),this)}M137(t,e=!0,i=0){const s=t.length;if(0===s)return this;if(this.M192())return this.Error("BatchAdd","I am full"),this;const n=this.M136()+s;if(n>this.M77())return this.Error("BatchAdd","Not enough space"),this;for(let e=0;e<s;e++){const i=t[e];if(!(i instanceof v))return this.Error("BatchAdd","Not a FlexBoxEntity",i),this;if(this.#I.includes(i))return this.Error("BatchAdd","Already here",i),this}const r=[...this.#I],h=r.length;this.#_t(s);for(let i=0;i<s;i++){const s=t[i];s.M188()&&s.M187().M191(s),s.M186(this),e?this.#I.push(s):this.#I.unshift(s);const n=this.#F?this.#z:s.M127(),r=this.#F?this.#G:s.M110();this.#V+=n,this.#B+=r}this.#O=!0,null!==this.#N&&this.#I.sort(this.#N),this.#Z(n),this.#et(n);for(let t=0;t<h;t++){const e=r[t];this.#nt(e)}if(0===i)for(let e=0;e<s;e++){const i=t[e];this.#nt(i)}else{let e=i;i<=1&&(e=this.M2(t[0])*i);let n=0;for(let i=0;i<s;i++){const s=t[i];setTimeout(()=>{this.#nt(s)},n),n+=e}}return this}M80(t=null,i=0){const s=null===t?[...this.#I]:t,n=s.length;if(0===n)return this;for(let t=0;t<n;t++){const e=s[t];if(!(e instanceof v))return this.Error("BatchRemove","Not a FlexBoxEntity",e),this;if(!this.#I.includes(e))return this.Error("BatchRemove","Not here",e),this}for(let t=n-1;t>=0;t--){const i=s[t];e.M11(this.#I,i),i.M131(),i.M7();const n=this.#F?this.#z:i.M127(),r=this.#F?this.#G:i.M110();this.#V-=n,this.#B-=r}this.#O=!0;const r=this.#I,h=r.length;if(this.#Z(h),this.#et(h),0===i)this.M8(!1);else{let t=i;i<=1&&(t=this.M2(r[0])*i);let e=t;for(let i=0;i<h;i++){const s=r[i];setTimeout(()=>this.#nt(s),e),e+=t}}return this}M2(t){if(!t.M218(this))return this.Error("GetEntityTranslationTime","Not here",t),0;const e=t.M113();return e<0||e>=this.#I.length?(this.Error("GetEntityTranslationTime","Bad index",t),0):t.M1(this.#q[e],this.#W[e])}M3(t){return t.EstimateTravelTime(this.M39(),this.M53())}M165(t=""){for(let t=0;t<this.#I.length;++t)this.#I[t];return!0}},k={smooth:!0,touch_down_events:!1,visible:!1,selected:!1,velocity_px_ms:1,flip_time:500,face_up:!0,flip_axis:"y"},L=class t extends v{static K107=110;#Mt=null;#pt=null;#mt=null;#ft=k.face_up;constructor(t){super(t,"Card_"+t,!0),this.#gt(t),e.M5(this,"BODY",this.#Mt),e.M5(this,"FACE",this.#pt),e.M5(this,"BACK",this.#mt),this.M209()}M157(){super.M157()}M209(e={}){for(const t in k){const i=e[t]??k[t];e[t]=i}this.M188()&&this.M187().M191(this),this.M7(),this.M111(e.smooth),this.M13(e.touch_down_events),this.M26(e.velocity_px_ms),this.M95(e.visible),this.M74(e.selected),this.M219(t.K107),this.M81(e.flip_time),this.M116(e.face_up),this.M82(e.flip_axis)}#gt(e){this.ELEMENT.classList.add("Card"),this.#Mt=document.createElement("div"),this.#Mt.classList.add("CardBody"),this.#Mt.classList.add("Clickable"),this.#Mt.dataset.idx=e,this.#Mt.card=this,this.#Mt.dataset.face=this.#ft?"up":"no",this.#Mt.dataset.visible=this.M115()?"yes":"no",this.#pt=document.createElement("div"),this.#pt.classList.add("CardFace"),this.#mt=document.createElement("div"),this.#mt.classList.add("CardBack"),this.#Mt.appendChild(this.#pt),this.#Mt.appendChild(this.#mt),this.ELEMENT.appendChild(this.#Mt),this.M132(t.K107)}M9(){return this.#Mt}M116(t=!0){return this.#ft=!!t,this.#Mt.dataset.face=this.#ft?"up":"down",this.OnFlip&&this.OnFlip(t),this}M138(){return this.#ft}M101(){return!this.#ft}M15(t){return this.#Mt.dataset.visible=t?"yes":"no",this}M20(t){return this.#Mt.dataset.selected=t?"yes":"no",this}M81(t){return!Number.isFinite(t)||t<0?(this.Error("SetFlipTime","Bad number",t),this):(this.#Mt.style.transitionDuration=t+"ms",this)}M82(t="x"){if("string"!=typeof t||1!==t.length)return this.Error("SetFlipAxis","Bad axis",t),this;if("x"!==(t=t.toLowerCase())&&"y"!==t)return this.Error("SetFlipAxis","Bad axis",t),this;const e="x"===t?"1":"0",i="y"===t?"1":"0";return this.#Mt.style.setProperty("--ROT_X",e),this.#Mt.style.setProperty("--ROT_Y",i),this}M221(){return this.#ft=!this.#ft,this.#Mt.dataset.face=this.#ft?"up":"down",this.OnFlip&&this.OnFlip(this),this}},C={};((t,e)=>{for(var i in e)b(t,i,{get:e[i],enumerable:!0})})(C,{K53:()=>P,K54:()=>V,K88:()=>O,K71:()=>U,K72:()=>et,K73:()=>K,K89:()=>R,K90:()=>D,K21:()=>Q,K22:()=>J,K99:()=>W,K91:()=>$,K74:()=>q,K92:()=>X,K75:()=>Z,K76:()=>Y,K45:()=>tt,K55:()=>A,K56:()=>S,K77:()=>I,K23:()=>T,K78:()=>N,K115:()=>H,K79:()=>B,K28:()=>F,K57:()=>G,K80:()=>j,K58:()=>z});var I=0,N=6,A=10,S=14,T=15,R=63,D=15,K=15,P=1<<A,O=2<<A,V={[P]:"Black",[O]:"Red"},B=1<<N,F=2<<N,z=3<<N,G=4<<N,H=[B,F,z,G].sort(),j={[B]:"Clubs",[F]:"Diamonds",[G]:"Hearts",[z]:"Spades"},U=1<<S,q=0,W=1,$=11,Y=12,X=13,J=Math.min($,Y,X),Q=Math.max($,Y,X),Z={[W]:"Ace",[$]:"Jack",[Y]:"Queen",[X]:"King"},tt={[W]:"A",[$]:"J",[Y]:"Q",[X]:"K"},et={name:"Joker",suit:"joker",symbol:"JKR",rank:q,flag:U},it=class t extends L{static K99=1;#wt=!1;#yt=!1;#bt=!1;#vt=null;constructor(i,s){super(i),e.M5(this,"DNA",s);const n=s&R,r=s&D<<N,h=s&K<<A;this.#bt=n===W,e.M5(this,"RANK",this.#bt?t.K99:n),e.M5(this,"SUIT",r),e.M5(this,"COLOR",h),this.#wt=0!==(s&U),this.#yt=!this.#wt&&this.RANK>=J&&this.RANK<=Q,this.#Et(),this.#xt()}M139(){return"("+this.IDX+") "+this.M83()+" of "+this.M84()}#Et(){const t=this.M83().toLowerCase(),e=this.M84().toLowerCase(),i=this.M211()?"red":"black",s=this.BODY;s.dataset.rank=t,s.dataset.suit=e,s.dataset.color=i,this.#wt?s.dataset.joker="yes":this.#yt&&(s.dataset.royal="yes")}#xt(){const t=this.M42().toUpperCase(),e=this.M84();this.FACE.innerHTML="";const i=document.createElement("p");i.innerText=t,this.#vt=i,this.#yt&&this.M41(this.RANK),this.FACE.appendChild(this.#vt);{const t=this.#kt(e.toLowerCase());this.FACE.appendChild(t)}}M41(t){const e=document.createElement("span");e.innerText=t,this.#vt.appendChild(e)}#kt(t){this.M211();const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("class","SuitIcon"),e.innerHTML=`<use href="#suit-${t}"/>`,e}M152(t,e){super.M152(t,e),this.FACE.style.fontSize=Math.round(.4*t)+"px"}static async M117(t){try{const e=M19("flex-box/"),i=await fetch(e+t),s=await i.text(),n=document.getElementById("card-sprite-sheet");n&&n.remove();const r=document.createElement("div");r.id="card-sprite-sheet",r.style.display="none",r.innerHTML=s,document.body.appendChild(r)}catch(t){}}M166(){return this.#wt}M167(){return this.#yt}M210(){return this.#bt}M140(){return!this.#wt&&!this.#yt}M211(){return this.COLOR===O}M168(){return this.COLOR===P}M194(){return this.RANK===$}M169(){return this.RANK===Y}M195(){return this.RANK===X}M196(){return this.RANK%2==0}M212(){return this.RANK%2!=0}M197(t){return this.SUIT===t}M83(){return this.#wt?et.name:this.#bt?Z[W]:Z[this.RANK]||this.RANK.toString()}M84(){return this.#wt?et.suit:j[this.SUIT]||"Unknown"}M42(){return this.#wt?et.symbol:this.#bt?tt[W]:tt[this.RANK]||this.M83()}M54(){return V[this.COLOR]||"Unknown"}},st=1/0,nt=!0,rt=!0,ht=class extends x{#ft=rt;#Lt=nt;constructor(t,e,i,s,n,r,h={}){const{max_cards:a=st,flip_after:o=nt,face_up:l=rt,sorting:c=null,tuck:u=!1,uniform:d=!0,parent:_=null,reverse_z:M=!1}=h;super(t,e,i,s,n,r,{max_count:a,sorting:c,tuck:u,uniform:d,parent:_,reverse_z:M}),this.M28(it.K107),this.ELEMENT&&this.ELEMENT.classList.add("BoxOfCards"),this.M116(l),this.M55(o)}#Ct(t,e){t.M116(e)}M230(t,e=!0){return t instanceof it?(super.M230(t,e),this.#Lt?t.M73(this.#Ct.bind(this,t,this.#ft)):t.M116(this.#ft),this):(this.Error("Add","Not a Card instance",t),this)}M189(t){return this.M230(t,!1)}M190(t){return this.M230(t,!0)}M135(t){return t instanceof it?super.M135(t):(this.Error("Includes","Not a Card instance",t),this)}M137(t,e=!0,i=0){const s=t.length;if(0===s)return this;for(let e=0;e<s;e++){const i=t[e];if(!(i instanceof it))return this.Error("BatchAdd","Not a Card instance",i),this}if(this.M136()+s>this.M77())return this.Error("BatchAdd","I am full"),this;super.M137(t,e,i);for(let e=0;e<s;e++){const i=t[e];this.#Lt?i.M73(this.#Ct.bind(this,i,this.#ft)):i.M116(this.#ft)}return this}M191(t){return t instanceof it?(super.M191(t),this):(this.Error("Remove","Not a Card instance",t),this)}M80(t=null,e=0){const i=null===t?[...this.GetEntities()]:t,s=i.length;if(0===s)return this;for(let t=0;t<s;t++){const e=i[t];if(!(e instanceof it))return this.Error("Remove","Not a Card instance",e),this}return super.M80(t,e),this}M118(t){return super.M78(t)}M116(t=!0){return this.#ft=!!t,this}M55(t=!0){return this.#Lt=!!t,this}},at=class{#It=[];#Nt=[];#At=[];#St=null;#Tt=0;#Rt=[];constructor(t={},e={}){const{jokers:i=0,exclude_ranks:s=[],exclude_cards:n=[],suits:r=H,seed:h=0}=t;this.#Tt=h,this.#Dt(r,s,n,i),this.#St={smooth:e.smooth??!0,touch_down_events:e.touch_down_events??!0,velocity_px_ms:e.velocity_px_ms??100,flip_time:e.flip_time??500,face_up:e.face_up??!0,visible:e.visible??!0,flip_axis:e.flip_axis??"y"},this.M209()}#Kt(t,e,i){return(t&R)===e&&(t&D<<N)===i}#Dt(t,e,i,s){for(const s of t){const t=s===F||s===G?O:P;for(let n=1;n<=13;n++){if(e.includes(n))continue;if(i.some(t=>this.#Kt(n|s,t.rank,t.suit)))continue;const r=n|s|t,h=new it(this.#It.length,r);this.#It.push(h)}}for(let t=0;t<s;t++){const e=U|(t%2==0?P:O),i=new it(this.#It.length,e);this.#It.push(i)}}M85(t){let e=0;for(const i of t)for(let t=0;t<this.#It.length;++t){const s=this.#It[t];if(this.#Kt(s.DNA,i.rank,i.suit)){e+=1,this.#It.splice(t,1),this.#Rt.push(s);break}}this.#Pt()}M56(t){}#Pt(){this.#At=[],this.#Nt=this.#It.map((t,e)=>e)}M209(t={}){this.#Pt();const e=new Set;this.#It.forEach(t=>{const i=t.M187();i&&e.add(i)}),e.forEach(t=>t.M208());const i=this.#St;for(const e in t)i.hasOwnProperty(e)&&(i[e]=t[e]);for(const t of this.#It)t.M209(i);return this}M222(t=null,e=0){if(null===t)return this;const i=this.M171(),s=e>0;return this.M162(t=>{t.M95(s),t.M111(s),t.M81(0),t.M116(!1)}),t.M137(i,!0,e>0?e:0),this.M162(t=>{t.M81(this.#St.flip_time),t.M111(this.#St.smooth)}),this}M160(t=0){let i=Math.random;0!==(t=t||this.#Tt)&&(t="string"==typeof t?M93(t):t,i=e.M24(t));const s=this.#Nt;for(let t=s.length-1;t>0;t--){const e=Math.floor(i()*(t+1));[s[t],s[e]]=[s[e],s[t]]}return this}M170(t=0){return this.#Tt="string"==typeof t?M93(t):0|t,this.#Tt}M223(){if(0===this.#Nt.length)return null;const t=this.#Nt.pop();return this.#At.push(t),this.#It[t]}M171(){const t=[];return this.#Nt.forEach(e=>{t.push(this.#It[e])}),this.#At=this.#Nt,this.#Nt=[],t}M141(){const t=this.#Nt[this.#Nt.length-1];return this.M172(t)}M172(t){return this.#It[t]}M43(t){if("function"!=typeof t)return[];const e=[];for(let i=this.#Nt.length-1;i>=0;i--){const s=this.#Nt[i],n=this.#It[s];t(n)&&(this.#Nt.splice(i,1),this.#At.push(s),e.push(n))}return e}M57(t,e){t|=0,e|=0,this.#It.forEach(i=>i.M152(t,e))}M173(){return this.#It.length}M21(){return this.#Nt.length}M162(t){return"function"!=typeof t||this.#It.forEach((e,i)=>t(e,i)),this}M22(t,e){const i=t.SUIT,s=e.SUIT;return i<s?-1:i>s?1:Math.sign(t.RANK-e.RANK)}},ot="off",lt=class extends ht{static K59=ot;static K60="top";static K29="right";static K24="bottom";static K46="left";#Ot=null;#Vt=!1;#Bt=0;#Ft=null;constructor(t,i,s={}){const{max_cards:n=1/0,counter_position:r=ot,pop_effect:h=!1,face_up:a=!0,parent:o=null}=s;super(t,i,x.K119,x.K114,x.K109,!0,{max_cards:n,parent:o}),this.#zt(),this.#Gt(),this.M16(r),this.M58(h),this.M116(a),e.M5(this,"COUNTER",this.#Ot)}#zt(){const t=this.ELEMENT;t.classList.add("PileOfCards");const e=document.createElement("span");e.classList.add("PileCounter"),e.innerText="0",t.appendChild(e),this.#Ot=e}M230(t,e=!0){return super.M230(t,e),this.#Ht(t,e),this}#Ht(t,e=!0){t.M130()?(this.#Bt++,t.M73(()=>{this.#Bt--,this.#Gt(),this.#jt(e?t:null),e||this.#Ft===t||t.M95(!1)})):(this.#jt(e?t:null),e||this.#Ft===t||t.M95(!1),this.#Gt())}#jt(t=null){const e=this.M136();if(0===e)return void(this.#Ft=null);const i=this.#Ft;if(null===t)for(let i=e-1-this.#Bt;i>=0;--i){const e=this.M78(i);if(!e.M128()){t=e;break}}i!==t&&(i&&i.M95(!1),this.#Ft=t,t.M95(!0))}M137(t,e=!0){super.M137(t,e);const i=t.length;let s;for(let e=0;e<i;e++)s=t[e],s.M95(!1);return this.#Gt(),this.#jt(e?s:null),this}M191(t){return super.M191(t),this.#Ut(t),this}#Ut(t,e=!0){t.M95(!0),t.M128()&&this.#Bt--,e&&(this.#Ft===t&&(this.#Ft=null,this.#jt(null)),this.#Gt())}M80(t=null,e=0){const i=this.#Ft,s=null===t?[...this.GetEntities()]:t,n=s.length;if(0===n)return this;super.M80(t,e);for(let t=0;t<n;t++){const e=s[t];this.#Ut(e,!1)}return s.includes(i)&&this.#jt(),this.#Gt(),this}M208(){return super.M208(),this.#Ft=null,this.#Bt=0,this.#Gt(),this}M142(t){return this.M230(t,!0)}M86(t){return this.M230(t,!1)}M87(){const t=this.M164();return t&&this.M191(t),t}M32(){const t=this.M163();return t&&this.M191(t),t}M185(){return this.M164()}M119(){return this.M163()}M160(){const t=this.M136();if(t>0&&this.#qt(),t<=1)return;const e=this.#Ft;super.M160();const i=this.M78(t-1);return e!==i&&(e.M95(!1),i.M95(!0),this.#Ft=i),this}M16(t){return this.ELEMENT.dataset.counter=t,this}M58(t){return this.#Vt=!!t,this}#Gt(){const t=this.M136()-this.#Bt;this.#Ot.innerText=t,this.#Vt&&this.#qt()}#qt(){const t=this.#Ot;t.classList.remove("PopEffect"),this.M71(),t.classList.add("PopEffect")}debug(){const t=this.M136();for(let e=0;e<t;++e)this.M78(e)}M174(){const t=this.M136();return 0===t?null:this.M78(t-1)}M102(){return 0===this.M136()?null:this.M78(0)}},ct=class{#Wt;#$t=[];#Yt;#Xt={};#Jt=null;#Qt="";constructor(t,e,i){this.#Wt=t+"_",this.#Yt=e,this.#Qt=i??""}M120(t,e){this.#$t.push({id:t,schema:e}),e.forEach(t=>{const e=localStorage.getItem(this.#Wt+t.id);null!==e?this.#Xt[t.id]=this.#Zt(e):(this.#Xt[t.id]=t.default,this.M224(t.id,t.default))})}#Zt(t){return"true"===t||"false"!==t&&(isNaN(t)||""===t?t:Number(t))}M198(){for(const{id:e,schema:i}of this.#$t)this.#te(t(e),i)}#te(t,e){if(!t)throw new Error("SettingsManager::RenderTo » No parent");this.#Jt=t;const i=e.map(t=>this.#ee(t));this.#Jt.innerHTML=i.join(""),this.#Jt.querySelectorAll("INPUT").forEach(t=>{this.#ie(t).classList.contains("AppSettingNotImplemented")||t.classList.add("Clickable")}),this.#Jt.querySelectorAll("LABEL").forEach(t=>{this.#ie(t).classList.contains("AppSettingNotImplemented")||t.classList.add("Clickable")}),this.#se()}#ie(t){let e=t.parentElement;do{if("DIV"===e.tagName&&e.classList.contains("AppSettingsRow"))return e;e=e.parentElement}while(null!==e);return e}#ee(t){const e=this.#Xt[t.id];let i="";"radio"===t.type?i=t.options.map((i,s)=>`\n                <label>\n                    <input type='radio' name='${t.id}' value='${s}' ${e===s?"checked":""}>\n                    ${i}\n                </label>\n            `).join(""):"range"===t.type?i=`\n                <input type='range' id='${t.id}' \n                    min='${t.min}' max='${t.max}' step='${t.step}' \n                    value='${e}'>\n            `:"checkbox"===t.type?i=`\n                <input type='checkbox' id='${t.id}' ${e?"checked":""}>\n            `:"text"===t.type&&(i=`\n                <input type='text' id='${t.id}' \n                    value='${e}'>\n            `);let s="AppSettingsRow";return t.not_implemented&&(s+=" AppSettingNotImplemented"),`\n            <div class='${s}' data-setting-id='${t.id}'>\n                <p class='AppSettingsMainLabel'>${t.label}</p>\n                <div class='AppSettingsInputWrapper'>${i}</div>\n            </div>\n        `}#se(){this.#Jt.addEventListener("input",t=>{t.stopPropagation(),t.preventDefault();const e=t.target,i=e.name||e.id;let s="checkbox"===e.type?e.checked:e.value;isNaN(s)||"range"!==e.type||(s=Number(s)),this.M44(i,s)}),this.#Jt.addEventListener(this.#Qt,t=>{"INPUT"===t.target.tagName&&(t.is_onesie_ui=!0),"LABEL"===t.target.tagName&&(t.is_onesie_ui=!0)})}M44(t,e){this.#Xt[t]=e,this.M224(t,e),this.#Yt&&this.#Yt(t,e)}M224(t,e){localStorage.setItem(this.#Wt+t,e)}M231(t){return this.#Xt[t]}},ut="https://",dt="rqhvlh0vwdwv",_t=window.visualViewport,Mt="AppRotate",pt="AppError",mt="AppErrorInfo",ft="AppViewport",gt="PageHidden",wt="Hidden",yt=Mt.toLowerCase(),bt=pt.toLowerCase(),vt="Home".toLowerCase(),Et="Play".toLowerCase(),xt=class s{static K93=1;static K100=2;static K117=3;#ne=null;#re=null;#he=new Map;#ae=s.K93;#oe=null;#le=null;#ce=null;#ue=null;#de=null;#_e=null;#Me=null;#pe=null;#me=null;#fe=null;#ge=null;#Qt="";#we=!0;#ye=null;#be=null;constructor(t={}){this.#Qt=e.M125?"touchstart":"click",this.#ve(t);const i=t.start_page||vt;requestAnimationFrame(()=>this.M144(i))}#ve(t){if(this.#ne=document.getElementById(ft),null===this.#ne)throw new Error("App » Element not found: #"+ft);this.#Ee();const e=this.#he.get(yt);if(!e)throw new Error("App » Element not found: #"+Mt);e.classList.add(Mt);const i=this.#he.get(bt);if(!i)throw new Error("App » Element not found: #"+pt);if(i.classList.add(pt),this.#le=document.getElementById(mt),!this.#le)throw new Error("App » Element not found: #"+mt);this.#xe(t),this.#ke(),this.#Le(),this.#Ce(),this.#Ie(t),this.#Ne(t),this.#ae=t.page_mode??1,this.#Ae(),this.#pe=t.on_resize||this.#pe||null,this.#me=t.on_click||this.#me||null,this.#fe=t.on_page||this.#fe||null}#xe(t){const e=new L("Onesie");e.M95(!0),e.M116(!1),e.M111(!1),this.#_e=e;const i=this.#he.get(vt);if(i.appendChild(e.ELEMENT),i.classList.add("Clickable"),t.blank_card)return;const s=t.game_name||"Some Card Game",n=t.game_designer||"Some Great Designer",r=t.game_build||("undefined"!=typeof BUNDLE_ID?BUNDLE_ID:"0000-0000-0000"),h="p";if(!t.blank_back){const t=document.createElement(h);t.classList.add("h1"),t.innerHTML="ONESIE",e.BACK.appendChild(t);const i=document.createElement(h);i.classList.add("h2"),i.innerHTML="1p card games",e.BACK.appendChild(i);const s=document.createElement(h);s.classList.add("h3"),s.innerHTML="build:<br><span>"+r+"</span>",e.BACK.appendChild(s)}if(!t.blank_face){const t=document.createElement(h);t.classList.add("h1"),t.innerHTML=s;const i=document.createElement(h);i.classList.add("h2"),i.innerHTML="<small>designed by:</small><br>"+n;const a=document.createElement(h);a.classList.add("h2"),a.innerHTML="<small>coded by:</small><br>Pedro Fontoura";const o=document.createElement(h);o.classList.add("h3"),o.innerHTML="build:<br><span>"+r+"</span>";const l=document.createElement(h);l.classList.add("h3"),l.innerHTML="♦ a solitaire card game ♦";for(const s of[t,l,i,a])e.FACE.appendChild(s)}}#Ee(){document.querySelectorAll("#"+ft+" > section").forEach(t=>{this.#he.set(t.id.toLowerCase(),t),t.classList.add(gt)})}#Ce(){window.addEventListener("resize",()=>this.#Ae()),window.addEventListener("contextmenu",t=>{if(t.preventDefault(),t.stopPropagation(),"touchstart"===this.#Qt)return;const e=new MouseEvent(this.#Qt,{view:window,bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});t.target.dispatchEvent(e)},{passive:!1}),window.addEventListener("unhandledrejection",t=>{if(t.preventDefault(),t.stopPropagation(),t.reason.stack){const e=[this.#Se(t.reason.stack)].join("<br>");this.#Te("Rejected",e)}else this.#Te("Rejected",t.reason.message)}),window.addEventListener("error",t=>{t.preventDefault(),t.stopPropagation();const e=[t.error.message,t.error.fileName,t.error.lineNumber,this.#Se(t.error.stack)].join("<br>");this.#Te("Error",e)}),this.#ue.addEventListener(this.#Qt,t=>{this.#Re(),t.stopPropagation(),this.#de.classList.toggle(wt)}),Array.from(this.#de.children).forEach(t=>{const e=this.#De(t);this.#he.get(e)?t.addEventListener(this.#Qt,t=>{this.#Re(),t.stopPropagation(),this.#Ke(t)}):t.remove()}),this.#_e.M9().addEventListener(this.#Qt,t=>{this.#Re(),t.stopPropagation(),this.#_e.M138()?this.M144(Et):this.#_e.M221()}),this.M175(vt).addEventListener(this.#Qt,t=>{this.#Re(),t.stopPropagation(),this.#_e.M221()}),window.addEventListener(this.#Qt,t=>{t.stopPropagation(),this.#Pe(t)})}#Re(){e.M49||e.M125&&e.M18()}#Ke(t){const e=this.#De(t.target);this.#he.get(e)&&this.M144(e)}#Pe(t){if(t.is_onesie_ui)return;let e=0,i=0;if("touchstart"===this.#Qt){const s=t.touches[0];e=s.clientX,i=s.clientY}else e=t.clientX,i=t.clientY;if(this.#me){if(!this.#we)return;this.#me(t.target,0|e,0|i)}}#ke(){this.#ce=document.getElementById("AppSideMenu"),this.#ue=document.getElementById("AppSideMenuMain"),this.#de=document.getElementById("AppSideMenuGroup"),this.#de.classList.add(wt),e.M125&&this.#ce.classList.add("TopSpacing")}#Se(t){return"string"==typeof t?t.split("at ").join("<br>&bull; "):"Stack: "+t}#Te(t,e){null!==this.#le&&(this.#le.innerHTML+="<h3>"+t+"</h3>"+e,this.M144(bt))}#Ae(){const t=_t.width,e=_t.height;if(this.#Oe(),this.#_e){const i=.75*Math.min(t,e)|0,s=.7*i|0;this.#_e.M152(s,i),this.#_e.M72(t-s>>1,e-i>>1)}this.#pe&&this.#pe(t,e,this.#ce.offsetWidth)}get M213(){return _t.width}get M199(){return _t.height}#Oe(){3!==this.#ae&&((Math.sign(_t.width-_t.height)>=0?1:2)!==this.#ae?this.#re!==yt&&(this.#oe=this.#re,this.M144(yt)):null!==this.#oe&&(this.M144(this.#oe),this.#oe=null))}async#Le(){await this.M121("./assets/app_icons.svg","icons-sprite-sheet")}async M121(t,e){try{const i=await fetch(t),s=await i.text(),n=document.getElementById(e);n&&n.remove();const r=(new DOMParser).parseFromString(s,"image/svg+xml").querySelector("svg");r&&(r.id=e,r.style.display="none",document.body.insertAdjacentElement("afterbegin",r))}catch(t){}}async M143(t){try{const e=await fetch(t);return e.ok?await e.json():null}catch(t){return null}}#De(t){const e=t.querySelector("use");if(e)return(e.getAttribute("href")||e.getAttribute("xlink:href")).split("-").pop().toLowerCase()}get M103(){return this.#ce.offsetWidth}get M225(){return this.#_e}M144(t,e=!1){const i=this.#re===t;t=t.toLowerCase();const s=this.#he.get(t);if(!s)throw new Error("App » No such page: "+t);t===Et&&this.#we,this.#re&&this.#he.get(this.#re).classList.add(gt),s.classList.remove(gt),this.#re=t,t===vt?this.#ce.classList.add(wt):this.#ce.classList.remove(wt);const n=this.#_e;n&&n.M116(!1),this.#fe&&!e&&this.#fe(t,i)}M122(t){return this.#re===t}M175(t){const e=this.#he.get(t);if(!e)throw new Error("App » No such page: "+t);return e}M59(){const t=window.matchMedia("(display-mode: standalone)").matches,e=!0===window.navigator.standalone;return t||e}M145(t=!0){(t=!!t)&&this.#we?this.#de.classList.remove(wt):this.#de.classList.add(wt)}M29(t,e){t.classList.add("Clickable"),t.addEventListener(this.#Qt,i=>{i.preventDefault(),i.stopPropagation(),e(t)})}get M232(){const t=new Date,i=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}-${String(t.getHours()).padStart(2,"0")}-${String(t.getMinutes()).padStart(2,"0")}`;return e.M93("Onesie"+i)}async M88(t=!0){const i=await this.#Ve();if("Wrpq}Qjt7qxvn"===e.M50(i,9))return this.#we=!0,!0;let s=!1;return window.top===window.self&&"ynm{x6oxw}x~{j7pr}q~k7rx"===e.M50(window.location.hostname,9)&&(s=e.M17("key",0,!0)===this.M232),this.#we=s,!s&&t&&this.#Be(),s}#Be(){const t=ut+e.M50("ynm{x6oxw}x~{j7pr}q~k7rx8xwn|rn8HyjpnFyuj",-9);self.location.replace(t)}#Ve=async()=>(await fetch(window.location.href,{method:"HEAD"})).headers.get("server");async M45(t,i=!0){const s=ut+e.M50("etm2gsyrxivetm2hiz3z6",-4)+"/"+e.M50(dt,-3)+"/"+e.M50(t,-5)+"/"+(i?"up":"down");if(!e.M49)try{const t=await fetch(s),e=await t.json();e.data&&e.data}catch(t){}}#Ie(e={}){const i=e.settings||{};"function"==typeof i.on_change&&(this.#ge=i.on_change),this.#Me=new ct(i.prefix??"GAME",this.#Fe.bind(this),this.#Qt),t("GameSettings")&&this.#Me.M120("GameSettings",i.schema||[]),t("GeneralSettings")&&this.#Me.M120("GeneralSettings",[{id:"deck_seed",label:"Deck seed",type:"text",default:"",not_implemented:!0},{id:"cards_theme",label:"Cards theme",type:"radio",options:["Normal","Vintage","Modern"],default:0,not_implemented:!0},{id:"cards_axis",label:"Cards flip axis",type:"radio",options:["Random","X","Y"],default:0,not_implemented:!0},{id:"cards_speed",label:"Cards speed",type:"range",min:1,max:5,step:1,default:3},{id:"cards_flip",label:"Cards flip time",type:"range",min:1,max:5,step:1,default:3}]),this.#Me.M198()}#Ne(i){const s=t("Stats");if(!s)return;const n=document.createElement("dl"),r=document.createElement("dt");r.innerHTML="Global stats";const h=document.createElement("dd");h.innerHTML="Wins: <span id='stats_wins'>#</span>";const a=document.createElement("dd");a.innerHTML="Losses: <span id='stats_losses'>#</span>",n.appendChild(r),n.appendChild(h),n.appendChild(a),s.appendChild(n),"function"==typeof Counter&&(this.#ye=new Counter({debug:!0,timeout:8e3,workspace:e.M50(dt,-3)}),"string"==typeof i.counter&&this.M104(i.counter,"get"))}async M104(t,i="get"){if(!["get","up","down"].includes(i))return;const s=e.M50(t,-5);if(!e.M49&&null!==this.#ye)try{const t=await this.#ye[i](s);"200"===t.code&&s.endsWith("-play")&&this.#ze(t)}catch(t){}}#ze(e){t("stats_wins")&&(t("stats_wins").innerHTML=e.data.up_count),t("stats_losses")&&(t("stats_losses").innerHTML=e.data.down_count)}M105(t,e=!1){const i=this.#Me.M231(t);return e?"cards_speed"===t?this.#Ge(i):"cards_flip"===t?this.#He(i):i:i}#Fe(t,e){switch(t){case"cards_theme":return void this.#je(e);case"cards_flip":if(null!==this.#be)return void this.#Ue(e);break;case"cards_speed":if(null!==this.#be)return void this.#qe(e)}null!==this.#ge&&this.#ge(t,e)}#je(t){const e="./assets/"+"theme-#.svg".replace("#",t);this.M121(e,"card-sprite-sheet")}#Ge(t){return i.M206(t||3,1,5,.25,2)}#qe(t){if(null===this.#be)return;const e=this.#Ge(t);this.#be.M162(t=>t.M26(e))}#He(t){return i.M206(t||3,1,5,100,1100)}#Ue(t){if(null===this.#be)return;const e=this.#He(t);this.#be.M162(t=>t.M81(e))}M176(t){this.#be=t??null,this.#qe(this.#Me.M231("cards_speed")),this.#Ue(this.#Me.M231("cards_flip")),this.#je(this.#Me.M231("cards_theme"))}},kt="fsm_data_changed",Lt=class{#We=()=>{};V43=!0;V40=new Map;V19=null;V29={};V25=[];V26=[];constructor(t,e=[]){if(this.#We=t,e.length>0)for(const t of e)this.V25.push(t)}M33(t){this.#$e(t)}M46(t){if(null!==t&&!this.V40.has(t))throw new Error("FSM::AssertStateId » Unknown id: "+t)}M47(t){if(!this.V29.hasOwnProperty(t))throw new Error("FSM::AssertDataKey » Unknown key: "+t)}M60(t,e,i=null){this.M46(t),this.M46(e),null!==t&&t!==this.V19.ID||this.#$e(e,i)}#$e(t,e=null){if(this.V19&&this.V19.M226(),this.V19=this.V40.get(t),!this.V19)throw new Error("FSM::#TransitionTo » No state! Key:",t);return this.V19.M214(e),!0}M34(t){if(null!==t)return this.M46(t),this.V19.ID===t}M61(t,e={}){this.M46(t);for(const[t,i]of Object.entries(e))this.M47(t),i!==this.V29[t]&&(this.V29[t]=i,this.#Ye(t,i));return this.M34(t)}#Ye(t,e){this.V25.includes(t)&&this.#Xe(kt,{key:t,value:e})}M62(t,e){if(this.M46(t),"string"==typeof e)return this.M47(e),this.V29[e];const i={};for(const t of e)this.M47(t),this.V29[t],i[t]=this.V29[t];return i}M146(){const t=this.V29;for(const[e,i]of Object.entries(t));}M200(t=null,e,i){t&&this.M46(t),this.#Xe(e,i)}#Xe(t,e){this.#We(t,e)}M123(t){this.M46(t),this.V19&&(this.V19.Sleep(),this.V26.push(this.V19)),this.V19=this.V40.get(t),this.V19.M214()}M147(){const t=this.V26;if(0===t.length)throw new Error("FSM::PopState » Stack is empty");this.V19.M226(),this.V19=t.pop(),this.V19.WakeUp()}},Ct=class{constructor(t,i){e.M5(this,"ID",t),e.M5(this,"CONTROLLER",i)}M214(t){}M226(){}M177(t,e){return!1}M89(t,e){return!1}M106(t,e){return!1}M200(...t){return this.CONTROLLER.M200(this.ID,...t)}M178(...t){return this.CONTROLLER.M62(this.ID,...t)}M179(...t){return this.CONTROLLER.M61(this.ID,...t)}M60(...t){return this.CONTROLLER.M60(this.ID,...t)}},It=class extends Ct{constructor(t){super(t)}},Nt=class extends Ct{constructor(t,e){super(t,e)}M214(){this.M200(p,!0);const{health:t,played_card:e}=this.M178(["health","played_card"]);let i=t;20===i&&e.M197(G)&&(i+=e.RANK),this.M200(_,{key:"score",value:i})}},At=class extends Ct{constructor(t,e){super(t,e)}M214(){this.M200(p,!1);const t=this.CONTROLLER.M6(this.ID);let e=0;t.forEach(t=>{t.M210()?e+=14:e+=t.RANK}),this.M200(_,{key:"score",value:-e})}},St=class extends Ct{constructor(t,e){super(t,e)}M214(){const t=1+this.M178("turn");this.M179({turn:t});const e=this.CONTROLLER.M65(this.ID),i=this.CONTROLLER.M64(this.ID),s=Math.min(4-i,e);this.CONTROLLER.M30(this.ID,s),setTimeout(()=>this.M60(a),200)}},Tt=class extends Ct{#Je=!1;constructor(t,e){super(t,e)}M214(){this.#Je=this.CONTROLLER.M201(this.ID),this.M200(_,{key:"CanRun",value:this.#Je}),this.M200(_,{key:"CanHeal",value:!0})}M89(t,e){return e===f?this.#Je?(this.M60(o),!0):(this.M200(d,"cannot:run"),!1):e===w&&(this.M60(l,t),!0)}},Rt=class extends Ct{constructor(t,e){super(t,e)}M214(){this.M200(_,{key:"CanRun",value:!1});const t=this.M178("turn");this.M179({last_run:t}),this.CONTROLLER.M35(this.ID).M73(()=>{this.M60(c)})}},Dt=class extends Ct{constructor(t,e){super(t,e)}M214(){this.CONTROLLER.M48(this.ID);const t=this.CONTROLLER.M64(this.ID),e=this.CONTROLLER.M65(this.ID);0===t&&0===e?this.M60(n):this.M60(h)}},Kt=class extends Ct{#Qe=!0;#Je=!0;#Ze=0;#ti=0;#ei=null;#ii=!1;#si={monster_value:0,sword_value:0,sword_used:!1};constructor(t,e){super(t,e)}M214(t){this.#Qe=!0,this.#Je=this.CONTROLLER.M201(this.ID),this.#ii=!1,this.#ni(t)}M89(t,e){if(!this.#ii)return e===w?(this.#ni(t),!0):!(e!==f||!this.#Je||(this.M60(o),0));if(e===y){if(t.M197(F))return this.#ii=!1,this.#ri(),!0}else{if(e===g)return this.#ii=!1,this.#hi(),!0;if(e===w&&t.M168()&&t.M96())return t.M74(!1),this.#ei=null,this.#ii=!1,!0}return!1}M177(t,e){return!!this.#ii&&(e===g?(this.#ii=!1,this.#hi(),!0):e===y&&(this.#ii=!1,this.#ri(),!0))}#ni(t){return this.#Ze=-1,this.#ei=null,this.M179({played_card:t}),t.M168()?this.#ai(t):t.M197(F)?this.#oi(t):this.#li(t),!0}#ci(){this.#Ze<0&&this.M200(_,{key:"damage",value:this.#Ze}),null!==this.#ei&&this.#ti<=0?this.M60(r):this.CONTROLLER.M66(this.ID)?0===this.CONTROLLER.M65(this.ID)&&this.M60(c):this.M60(c)}#ai(t){this.#ei=t;const{sword_value:e,sword_level:i,health:s}=this.M178(["sword_value","sword_level","health"]);this.#ti=s;const n=t.M210()?14:t.RANK,r=0===e||i<=n;this.#Ze=n,r?this.#hi():(this.#ii=!0,this.#ei=t,t.M74(!0),this.#si.monster_value=n,this.#si.sword_value=e,this.#si.sword_level=i)}#hi(){this.#ti=Math.max(0,this.#ti-this.#Ze),this.M179({health:this.#ti});const t=[this.#ei.M39(),this.#ei.M53()];this.M200(_,{key:"damage",value:this.#Ze,center:t}),this.CONTROLLER.M181(this.ID,this.#ei),this.#ei.M74(!1),this.#ei.M73(()=>this.#ci())}#ri(){const t=this.#si;if(this.M179({sword_level:t.monster_value}),this.#Ze=t.monster_value-t.sword_value,this.#Ze>0){this.#ti=Math.max(0,this.#ti-this.#Ze),this.M179({health:this.#ti});const t=[this.#ei.M39(),this.#ei.M53()];this.M200(_,{key:"damage",value:this.#Ze,center:t})}else 0===this.#Ze&&this.M200(_,{key:"damage",value:0});this.#ei.M74(!1),this.CONTROLLER.M36(this.ID,this.#ei),this.#ei.M73(()=>this.#ci())}#oi(t){const e=this.M178("sword_card");if(null!==e){const i=this.CONTROLLER.M23(this.ID);return void(null!==i?i.M73(()=>this.#ui(e,t)):this.#ui(e,t))}this.#di(t)}#ui(t,e){const i=this.CONTROLLER.M91(this.ID);null!==i?i.M73(()=>this.#di(e)):this.#di(e)}#di(t){this.CONTROLLER.M124(this.ID,t),this.#ci()}#li(t){this.#Qe&&(this.#Qe=!1,this.M200(_,{key:"CanHeal",value:!1}),this.CONTROLLER.M227(this.ID,t.RANK)),this.CONTROLLER.M181(this.ID,t),t.M73(()=>this.#ci())}},Pt=class extends Lt{static K47=kt;#be=null;#_i=0;#Mi=null;#pi=null;#mi=null;#fi=null;#gi=null;#wi=null;#yi=null;#bi=null;#vi={position:new Array(2),status:0};#Ei=null;constructor(t={}){const{on_message_request:e,V25:i=[],parent_node:n=window.document.body}=t;super(e,i),this.#Ei=n,this.#xi();for(const t of i)this.V29.hasOwnProperty(t);this.#ki(),this.M33(s),this.#Li()}#xi(){this.V29.health=0,this.V29.played_card=null,this.V29.sword_card=null,this.V29.sword_level=0,this.V29.sword_value=0,this.V29.turn=0,this.V29.last_run=0}#ki(){const t=[[s,It],[n,Nt],[r,At],[h,St],[a,Tt],[o,Rt],[c,Dt],[l,Kt]];for(const[e,i]of t)this.V40.set(e,new i(e,this))}M61(t,e){return super.M61(t,e),this.#Ci(),this.V19.ID===t}#Ci(){this.V29}M177(t,e,i){let s=!1;this.V43||(s=this.#Ii(t)),this.#vi.position[0]=e,this.#vi.position[1]=i,this.#vi.status=s,this.M200(null,M,this.#vi)}#Ii(t){if(!t.classList.contains("Clickable"))return!1;if(t.classList.contains("CardBody")){const e=parseInt(t.dataset.idx),i=this.#be.M172(e),s=this.#Ni(i);return this.V19.M89(i,s)}const e=this.#Ai(t);return this.V19.M177(t,e)}#Ni(t){const e=t.M187();return e===this.#Mi?f:e===this.#pi?g:e===this.#mi?w:e===this.#fi?y:m}#Ai(t){return t===this.#Mi.ELEMENT?f:t===this.#pi.ELEMENT?g:t===this.#mi.ELEMENT?w:t===this.#fi.ELEMENT?y:m}M63(t){return!Number.isInteger(t)||t<=0?(this.M200(null,MSG_APP_ERROR,"Invalid game_level: "+t),this):(this.V29.level=t,this)}M215(t){const s=e.M17("seed",Date.now()%1e6,!0);this.M200(null,u,s),this.#be.M209(t).M160(s).M222(this.#Mi),this.V43||(this.#Si(),this.#Ti());const n=i.M52()?"x":"y";this.#be.M162(t=>{const e=t.BODY.style;e.transition="none",t.M82(n),t.M71(),e.transition=""}),this.M61(null,{health:20}),this.V43=!1,this.M33(h)}M148(t,i,s=0){const n=Math.min(t,i),r=.03*n,h=(s||.1*n)+r,a=Math.floor((n-r-h)/5),o=Math.round(a/.7),l=5*a,c=4*o,u=Math.min(18,Math.round(.1*a))+"px",d=t-l-h>>1,_=t<i?.25*(i-c>>1):0,M=i-c-3*_>>1,p=.8*o|0,m=.66*p|0;this.#be.M57(m,p);const f=.9*o|0,g=a;this.#Mi.M27(m,p),this.#Mi.M108(g,f,d+a,M),this.#Mi.COUNTER.style.fontSize=u,this.#pi.M27(m,p),this.#pi.M108(g,f,d+3*a,M),this.#pi.COUNTER.style.fontSize=u;let w=M+o+_;this.#mi.M27(m,p),this.#mi.M108(l,f,d,w),w+=o+_,this.#fi.M27(m,p),this.#fi.M108(l,f,d,w),w+=o+_,e.M108(this.#gi,l,o,d,w);const y=.4*l|0,b=.025*c|0,v=l-2*y;return e.M152(this.#wi,y,b),e.M152(this.#yi,y,b),e.M152(this.#bi,v,o),this}M180(){return this.#be}M149(t){return this.M46(t),this.#Mi.M87()}M90(t){return this.M46(t),0===this.#Mi.M136()}M48(t){this.M46(t),this.#Si()}#Si(){}#Ti(){super.M61(null,{played_card:null,sword_card:null,sword_level:0,sword_value:0,turn:0,last_run:0,health:0})}M64(t){return this.M46(t),this.#mi.M136()}M65(t){return this.M46(t),this.#Mi.M136()}M30(t,e){this.M46(t);const i=[];for(let t=1;t<=e;++t){const t=this.#Mi.M87();i.push(t)}return this.#mi.M137(i),i[0]}M201(t){this.M46(t);const e=this.V29.last_run;return 0===e||e<this.V29.turn-1}M35(t){this.M46(t);const e=this.#mi.M193();return this.#mi.M208(),e.forEach(t=>t.M116(!1)),this.#Ri(e,this.#Mi)}#Ri(t,e,i=200){const s=t.length;if(0===s)return null;const n=t[0];if(i<=0)return e===this.#pi?e.M137(t,!0):e===this.#Mi?e.M137(t,!1):e.M137(t),n;for(let n=0;n<s;++n)setTimeout(()=>{const i=t.pop();e===this.#pi?e.M142(i):e===this.#Mi?e.M86(i):e.M230(i)},n*i);return n}M227(t,e){this.M46(t);const i=Math.min(20,this.V29.health+e);return this.M61(null,{health:i}),i}M66(t){return this.M46(t),this.#mi.M136()>1||0===this.#Mi.M136()}M181(t,e){return this.M46(t),this.#pi.M230(e),e}M23(t){this.M46(t);const e=this.#fi.M79(t=>!0);return 0===e.length?null:(this.#fi.M80(e),e.forEach(t=>t.M116(!1)),this.#Ri(e,this.#pi))}M91(t){this.M46(t);const e=this.V29.sword_card,i=this.#pi.M135(e);return i||this.#pi.M142(e),this.M61(null,{sword_card:null,sword_level:0,sword_value:0}),i?null:e}M124(t,e){this.M46(t),this.#fi.M230(e),this.M61(null,{sword_card:e,sword_level:1/0,sword_value:e.RANK})}M36(t,e){return this.M46(t),this.#fi.M230(e),e}M6(t,e){return this.M46(t),this.#Mi.M79(t=>t.M168())}#Di(t){if(t<0||t>this.#_i-1)throw new Error("GC::AssertCardIdx » Bad idx: "+t)}#Li(){this.#Ki(),this.#Pi()}#Ki(){this.#be=new at({jokers:0,exclude_cards:[{rank:C.K99,suit:C.K57},{rank:C.K99,suit:C.K28},{rank:C.K91,suit:C.K57},{rank:C.K76,suit:C.K57},{rank:C.K92,suit:C.K57},{rank:C.K91,suit:C.K28},{rank:C.K76,suit:C.K28},{rank:C.K92,suit:C.K28}]},{visible:!1,touch_down_events:!0,smooth:!0,flip_axis:i.M52(.5)?"x":"y"}),this.#be.M162(t=>{this.#Ei.appendChild(t.ELEMENT),t.M210()&&t.M41(14)}),this.#_i=this.#be.M173()}#Pi(){const e=this.#be.M173(),i=this.#Ei;let s=0;this.#Mi=new lt(s++,"DrawPile",{max_cards:e,flip_after:!1,face_up:!1,parent:i,counter_position:lt.K29,pop_effect:!0}),this.#Mi.ELEMENT.classList.add("DrawPile"),this.#Mi.ELEMENT.classList.add("Clickable"),this.#pi=new lt(s++,"DiscardPile",{max_cards:e,flip_after:!1,face_up:!1,parent:i,counter_position:lt.K29,pop_effect:!0}),this.#pi.ELEMENT.classList.add("DiscardPile"),this.#pi.ELEMENT.classList.add("Clickable"),this.#mi=new ht(s++,"Room",ht.K119,ht.K109,ht.K109,!0,{max_cards:4,flip_after:!0,face_up:!0,parent:i}),this.#mi.ELEMENT.classList.add("Room"),this.#mi.ELEMENT.classList.add("Clickable"),this.#fi=new ht(s++,"Hand",ht.K119,ht.K109,ht.K109,!0,{max_cards:e,flip_after:!0,face_up:!0,parent:i}),this.#fi.ELEMENT.classList.add("Hand"),this.#fi.ELEMENT.classList.add("Clickable"),this.#gi=t("InGameInfo"),this.#wi=t("IGI_HealthLeft"),this.#yi=t("IGI_HealthRight"),this.#bi=t("IGI_Stats")}};import Ot from"stampit";import stampit from"stampit";var Vt=stampit({props:{M107:!1,M228:null,M10:NaN},methods:{setImage(t){this.resetImage(),this.M107=!0;let e=null;"string"==typeof t?(e=new Image,e.onload=()=>{this.M228=e,this.M10=e.width/e.height},e.onerror=()=>{this.resetImage()},e.src=t):(t instanceof HTMLImageElement||t instanceof Image)&&(this.M228=t,this.M10=t.width/t.height)},getImage(){return this.M228&&this.M228.complete?this.M228:null},getImageAspectRatio(){return this.M228&&this.M228.complete?this.M10:NaN},resetImage(){this.M228=null,this.M10=NaN,this.M107=!1}}});import Bt from"stampit";import{ARRAY_TYPE as Ft}from"glMatrix";import{fromValues as zt,create as Gt}from"vec2";var vec2={fromValues:zt,create:Gt},Ht=Bt({methods:{validateVector(t,e=null){const i=t||e;if(!i)return vec2.create();if(!(Array.isArray(i)||i instanceof Ft))throw new Error("Vector input must be an Array or glMatrix ARRAY_TYPE.");if(2!==i.length)throw new Error("Vector input must have exactly 2 elements.");if(!Number.isFinite(i[0])||!Number.isFinite(i[1]))throw new Error("Vector array must contain only numeric values.");return vec2.fromValues(i[0],i[1])}}});import{add as jt,create as Ut,scaleAndAdd as qt,zero as Wt,copy as $t}from"vec2";import Yt from"stampit";import Xt from"stampit";var Jt=Xt({methods:{makeReadOnly:function(t){if("object"!=typeof t||null===t||Array.isArray(t))return;const e={};Object.entries(t).forEach(([t,i])=>{Object.prototype.hasOwnProperty.call(this,t),e[t]={configurable:!1,writable:!1,value:i,enumerable:!0}}),Object.defineProperties(this,e)}}}),Qt={add:jt,create:Ut,scaleAndAdd:qt,zero:Wt,copy:$t},Zt="#FFFFFF",te=!0,ee=2*Math.PI,ie=Ot({props:{M202:null},init({radius:t=3,color:e=Zt,opacity:i=1,fill:s=te,user_data:n=null}){if(!Number.isFinite(t)||t<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(i)||i<0||i>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if("string"!=typeof e||e.length<3)throw new Error("'color' must be a valid string format ( e.g., '#FFF' or 'red' ).");this.radius=t,this.color=e,this.opacity=i,this.fill=s,this.user_data=n},methods:{render(t){if(t.save(),t.globalAlpha=this.opacity,this.M107){const e=this.getImageAspectRatio();if(Number.isFinite(e)){const i=this.getImage(),s=this.position[0],n=this.position[1],r=(i.width,i.height,this.M10,2*this.radius),h=r*e;t.drawImage(i,s-h/2,n-r/2,h,r)}}else t.beginPath(),t.arc(...this.position,this.radius,0,ee),this.fill?(t.fillStyle=this.color,t.fill()):(t.strokeStyle=this.color,t.stroke());t.restore()},resetRender(){this.resetImage(),this.fill=te}}}),se=Ot({init({position:t,velocity:e}){this.position=this.validateVector(t),this.velocity=this.validateVector(e),this.acceleration=Qt.create()},methods:{applyForce(t){Qt.add(this.acceleration,this.acceleration,t)},updatePhysics(t=1){Qt.scaleAndAdd(this.velocity,this.velocity,this.acceleration,t),Qt.scaleAndAdd(this.position,this.position,this.velocity,t),Qt.zero(this.acceleration)},resetPhysics(){Qt.zero(this.position),Qt.zero(this.velocity),Qt.zero(this.acceleration)}}}),ne=Ot({props:{age:0,alive:!1},init({life:t=120}){if(!Number.isFinite(t)||t<=0)throw new Error("'life' must be a positive number.");this.life=t},methods:{updateLife(t=1){return this.age+=t,this.alive=this.age<this.life,this.alive},resetLife(){this.age=0,this.alive=!1}}}),re=Ot({methods:{config(t={}){if(this.opacity=(t.opacity??this.opacity)||1,this.radius=(t.radius??this.radius)||3,this.color=(t.color??this.color)||Zt,this.life=(t.life??this.life)||120,this.fill=t.fill??te,t.position&&Qt.copy(this.position,this.validateVector(t.position)),t.velocity&&Qt.copy(this.velocity,this.validateVector(t.velocity)),!Number.isFinite(this.radius)||this.radius<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(this.opacity)||this.opacity<0||this.opacity>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if(!Number.isFinite(this.life)||this.life<=0)throw new Error("'life' must be a positive number.")}}}),he=Ot().compose(Ht,Vt,ie,se,ne,re,Ot({methods:{reset(){this.resetRender(),this.resetPhysics(),this.resetLife()}}})),ae=Yt({init({object_stamp:t,pool_size:e=1e3}){if("function"!=typeof t)throw new Error("'object_stamp' must be a constructor function ( a stamp or factory ).");if(!Number.isInteger(e)||e<=0)throw new Error("'pool_size' must be a positive integer.");this.makeReadOnly({pool_size:e,object_stamp:t})}}),oe=Yt({init(t,{instance:e}){const i=new Array(this.pool_size);let s=0;const n=new WeakMap;for(let t=0;t<this.pool_size;t++){const e=this.object_stamp();e.reset(),i[t]=e}e._setIndex=function(t,e){n.set(t,e)},e.get=function(){if(s>=this.pool_size)return null;const t=i[s];return n.set(t,s),s++,t},e.free=function(t){const e=n.get(t);if(void 0===e||e>=s)return!1;s--;const r=i[s];return i[s]=t,i[e]=r,t!==r&&n.set(r,e),t.reset(),n.delete(t),!0},e.getActiveCount=function(){return s},e._getPoolArray=function(){return i}}}),le=Yt({methods:{M162:function(t){const e=this._getPoolArray();let i=0;for(;i<this.getActiveCount();){const s=e[i];this._setIndex(s,i),!1!==t(s)?i++:this.free(s)}},M203:function(t){this._getPoolArray().forEach(e=>t(e))}}}),ce=Yt().compose(Jt,ae,oe,le);import{fromValues as ue,copy as de,random as _e,create as Me}from"vec2";var pe={fromValues:ue,copy:de,random:_e,create:Me},me=pe.create(),fe="xhtzsiwjq2uqf~",ge="xhtzsiwjq2{nxnyx",Scoundrel=class{#Oi=null;#Vi=!1;#Bi=null;#Fi=-1;#Ei=null;#we=!1;#zi=pe.create();#Gi=null;#Hi=0;#ji=null;#Ui=null;#qi=null;#Wi=null;#$i=0;#Yi=0;#Xi=t("IGI_HealthLeft").childNodes[0];#Ji=t("IGI_HealthRight").childNodes[0];constructor(t){this.#Fi=this.#Qi(),this.#Oi=new xt({game_name:"SCOUNDREL",game_designer:"Zach Gage and Kurt Bieg",game_build:t,start_page:e.M17("page",vt),page_mode:xt.K117,on_resize:this.M148.bind(this),on_click:this.M177.bind(this),on_page:this.M204.bind(this),counter:fe,settings:{prefix:"scoundrel",schema:[{label:"Slay",id:"slay_level",type:"radio",options:["Less","Less or equal"],default:0,not_implemented:!0},{label:"Reds",id:"nr_reds",type:"radio",options:["10","11","12","13"],default:0,not_implemented:!0},{label:"Bombs",id:"nr_bombs",type:"radio",options:["0","1","2"],default:0,not_implemented:!0},{label:"Grenades",id:"nr_grenades",type:"radio",options:["0","1","2"],default:0,not_implemented:!0}]}}),this.#Oi.M104(ge,"up"),this.#Ei=this.#Oi.M175(Et),this.#Hi=this.#Oi.M103,this.#we=this.#Oi.M88(),this.#Zi(),this.#ts(),this.#es(),this.#Oi.M176(this.#Bi.M180())}M148(t,e,i){this.#Bi.M148(t,e,i),this.#ji.width=t,this.#ji.height=e,this.#Ui.width=t,this.#Ui.height=e,this.#Hi=i}M177(t,i,s){this.#Vi&&(e.M49||this.#we)&&this.#Bi.M177(t,i,s)}M204(t,e){const i=this.#Vi;this.#Vi=t===Et,this.#Vi&&(this.#Oi.M145(),i||window.requestAnimationFrame(this.#is.bind(this)),e&&this.#ss())}M150(e,i){if("string"!=typeof e)throw new Error("! "+e+" = "+typeof e);switch(e){default:return;case Pt.K47:let e=i.value;Number.isFinite(e)&&!Number.isInteger(e)&&(e=Math.round(e)),this.#ns(i.key,e);break;case _:let s=i.value;Number.isFinite(s)&&!Number.isInteger(s)&&(s=Math.round(s)),this.#ns(i.key,s,i.center);break;case u:const n=t("deck_seed");n&&(n.value=i);break;case d:break;case M:this.#rs(i.position,i.status);break;case p:this.#Oi.M104(fe,i?"up":"down"),this.#$i=i?1:-1}}#ss(){this.#Oi.M145(!1),this.#$i=0;const e={velocity_px_ms:this.#Oi.M105("cards_speed",!0),flip_time:this.#Oi.M105("cards_flip",!0)};this.#Bi.M215(e),t("damage").classList.remove("Score"),t("damage").innerHTML="&nbsp;",this.#Oi.M104(ge,"down")}#ts(){this.#Bi=new Pt({on_message_request:(t,e)=>this.M150(t,e),V25:["health"],parent_node:this.#Oi.M175(Et)}),this.#Bi.M148(this.#Oi.M213,this.#Oi.M199).M63(this.#Fi)}#es(){const t=document.createElement("canvas");t.id="canvas_clicks",t.width=window.innerWidth,t.height=window.innerHeight,t.style.zIndex=200,this.#Ei.appendChild(t);const e=document.createElement("canvas");e.id="canvas_particles",e.width=window.innerWidth,e.height=window.innerHeight,e.style.zIndex=100,this.#Ei.appendChild(e),this.#Wi=t.getContext("2d"),this.#qi=e.getContext("2d"),this.#Ui=t,this.#ji=e,this.#Gi=ce({object_stamp:he,pool_size:1e4}),this.#Gi.M203(t=>{t.user_data={click:!0}})}#is(t){this.#Vi&&(this.#Yi,this.#Yi=t,this.#Gi.M162(t=>{if(!t.updateLife())return t.user_data.click=!0,!1}),this.#Wi.clearRect(0,0,window.innerWidth,window.innerHeight),this.#qi.clearRect(0,0,window.innerWidth,window.innerHeight),this.#Gi.M162(t=>{t.opacity=i.M156(t.age,t.life,5),t.updatePhysics();const e=t.user_data.click;e&&(t.radius*=1.05),t.render(e?this.#Wi:this.#qi)}),0!==this.#$i&&this.M151(this.#qi,1===this.#$i?"SUCCESS":"YOU LOST",this.#Hi),window.requestAnimationFrame(this.#is.bind(this)))}#hs(){const t=window.visualViewport.width,e=window.visualViewport.height,i=Math.min(t,e),s=.03*i,n=Math.floor((i-s-this.#Hi-s)/5),r=(t-5*n-this.#Hi-s)/2,h=Math.floor(n/.7),a=Math.floor((e-4*h)/2);we(this.#qi,r,a,n,h,5,4)}#rs(t,e){if(e)return;const i=this.#Gi.get();i&&(i.config({position:t,velocity:me,color:e?"lime":"darkorange",life:e?60:30,radius:10,opacity:1,fill:!e}),i.user_data.click=!0)}#as(t,e=!0,s=0){const n=this.#Gi.get();if(!n)return;let r=e?"crimson":"white";n.config({position:t,velocity:pe.random(this.#zi,i.M70(1,3)),color:r,life:60*i.M70(1,3),radius:i.M109(s,s+3)||i.M70(1,3),opacity:1,fill:!0}),n.user_data.click=!1}#Qi(){let t=e.M17("level",2,!0);return[1,2,3].includes(t)||(t=2),t}#Zi(){}#ns(e,i,s=null){if("health"===e){const t=Math.round(i/20*100);this.#Xi.style.width=t+"%",this.#Ji.style.width=t+"%"}else if("damage"===e)if(i<0)i="&nbsp;";else{const t=10*i;for(let e=0;e<t;++e)this.#as(s,!0,i);i=-i}else{if("CanRun"===e||"CanHeal"===e)return void(i?t(e).classList.add("Active"):t(e).classList.remove("Active"));if("score"===e){const e=t("damage");return e.innerHTML=i,void e.classList.add("Score")}}const n=t(e);n&&(n.innerHTML=i)}M151(t,e="",i=0){const s=t.canvas.width-i,n=t.canvas.height,r=Math.floor(.18*s);t.font="bold "+r+"px card-game",t.fillStyle="rgba( 100, 149, 237, 0.50 )",t.textAlign="center",t.textBaseline="middle",t.fillText(e,s/2,n/2)}M229(e=100){const i=t("Play");i.style.transition="filter "+e+"ms ease",i.style.filter="brightness( 0.5 )",setTimeout(()=>i.style.filter="brightness( 1 )",e)}M216(e=0){e*=5;const i=t("Play");i.style.transition="filter "+e+"ms ease",i.style.filter="blur("+e+"px)",setTimeout(()=>i.style.filter="blur(0)",e)}},we=(t,e,i,s,n,r,h)=>{const a=r*s,o=h*n;t.strokeStyle="orange",t.beginPath();for(let n=0;n<=r;n++){const r=e+n*s;t.moveTo(r,i),t.lineTo(r,i+o)}for(let s=0;s<=h;s++){const r=i+s*n;t.moveTo(e,r),t.lineTo(e+a,r)}t.stroke()};export{Scoundrel};
//# sourceMappingURL=bundle.min.js.map