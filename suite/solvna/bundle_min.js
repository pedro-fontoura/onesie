// Build: February 2 2026 21:42

export const BUNDLE_URL = import.meta.url.split( '/' ).pop();

export const BUNDLE_ID = "2026-0202-2142";

function t(t){return document.getElementById(t)}class i{static get M58(){return window.location.href.includes("nighthawk.home")}static get M73(){return screen.orientation&&screen.orientation.type?screen.orientation.type.includes("landscape"):window.innerWidth>window.innerHeight}static get M131(){return navigator.maxTouchPoints>0}static get M99(){return navigator.userAgentData&&"Android"===navigator.userAgentData.platform||/android/i.test(navigator.userAgent)}static get M42(){const t=window.matchMedia("(display-mode: standalone)").matches,i=!0===window.navigator.standalone;return t||i}static get M187(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||/Mac/.test(navigator.userAgent)&&navigator.maxTouchPoints>1}static M5(t,i,e){Object.defineProperty(t,i,{value:e,writable:!1,enumerable:!0,configurable:!1})}static M11(t,i){if(!Array.isArray(t))return;const e=t.indexOf(i);-1!==e&&t.splice(e,1)}static M12(t){if(!Array.isArray(t))return t;for(let i=t.length-1;i>0;i--){const e=Math.floor(Math.random()*(i+1));[t[i],t[e]]=[t[e],t[i]]}return t}static M27(t){return function(){let i=t+=1831565813;return i=Math.imul(i^i>>>15,1|i),i^=i+Math.imul(i^i>>>7,61|i),((i^i>>>14)>>>0)/4294967296}}static M100(t){let i=0;for(let e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return i}static M17(t,i=null,e=!1){let s=new URLSearchParams(window.location.search).get(t);if(null===s)return i;if(e){const t=parseInt(s,10);return isNaN(t)?i:t}return s}static M74(t,i=document.documentElement,e=null){t.startsWith("--")||(t="--"+t);const s=window.getComputedStyle(i).getPropertyValue(t).trim();return""===s?e:s.replace(/^['"]|['"]$/g,"")}static M18(){if(i.M187)return;const t=document.documentElement,e=t.requestFullscreen||t.webkitRequestFullscreen;if(!e)return;const s=i.M99?{navigationUI:"hide"}:{};e.call(t,s).catch(t=>{})}static M19(t){const i=document.querySelector('script[type="importmap"]');if(!i)throw new Error('GetImportMapValue » <script type="importmap"> not found in DOM.');const e=JSON.parse(i.textContent),s=e.imports?.[t];if(void 0===s)throw new Error("GetImportMapValue » Key not found in imports: "+t);return s}static M59(t,i=0){if("string"!=typeof t)return t;let e="";for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);e+=String.fromCharCode(n+i)}return e}static M160(t,i,e){const s=t.style;s.width=i+"px",s.height=e+"px"}static M114(t,i,e,s,n){const r=t.style;r.width=i+"px",r.height=e+"px",r.left=s+"px",r.top=n+"px"}}class e{static get M188(){return(1+Math.sqrt(5))/2}static get M189(){return 2*Math.PI}static get M161(){return Math.PI/2}static get M75(){return Math.PI/180}static get M60(){return 180/Math.PI}static M162(t){return t*e.M75}static M163(t){return t*e.M60}static M115(t,i){return Math.floor(Math.random()*(i-t+1))+t}static M76(t,i){return t+Math.random()*(i-t)}static M61(t=.5){return Math.random()<t}static M29(t){return function(){let i=t+=1831565813;return i=Math.imul(i^i>>>15,1|i),i^=i+Math.imul(i^i>>>7,61|i),((i^i>>>14)>>>0)/4294967296}}static M219(t,i,e){return t+(i-t)*e}static M209(t,i,e,s,n){return s+(t-i)*(n-s)/(e-i)}static M210(t,i,e){return Math.max(i,Math.min(t,e))}static M132(t,i,e,s){return Math.hypot(e-t,s-i)}static M164(t,i,e=2){if(i<=0)return 0;const s=t/i;return 1-Math.pow(s,e)}}var s="busy",n="predict",r="eval",o="eval_ok",h="eval_nk",a="turn_ended",l="rm_stones",c="success",u="fail",d="user_error",_="ui_choice",M="ui_click",p="MSG_STONES_ON",f="MSG_STONES_OFF",m="MSG_GAME_OVER",g="deck_seed",b="R",w="RO",y="BE",x="E",E="D",v="H",k="S",L="C",C="O",I="BO",S="RE",A="B",N=w,T=y,D=I,R=S,O={[b]:"Red",[w]:"Red Odd",[y]:"Black Even",[x]:"Even",[E]:"Diamonds",[v]:"Hearts",[k]:"Spades",[L]:"Clubs",[C]:"Odd",[I]:"Black Odd",[S]:"Red Even",[A]:"Black"},P=[["R"],[w,y],["E"],["D","H"],["S","C"],["O"],[I,S],["B"]],B=1,V=2,K=3,F={[B]:"Easy",[V]:"Normal",[K]:"Hard"},z="DECK",U="TABLE",G=Object.defineProperty,j=class t{static K137=100;static K141=199;static K20=100;#t=0;#i=0;#e=100;#s=-1;#n=0;#r=0;#o=null;#h=null;#a=!1;#l=0;#c=0;#u=0;#d=0;#_=0;#M=0;#p=!1;#f=[];#m=!0;#g=!1;constructor(e,s,n=!1,r=0,o={}){i.M5(this,"IDX",e),i.M5(this,"ID",s);const{parent:h=null,is_box:a=!1}=o;i.M5(this,"IS_BOX",a),this.#l=r||t.K20,!0===n?this.#o=document.createElement("div"):n instanceof Node&&(this.#o=n),this.#o&&(this.#b(),h instanceof Node&&h.appendChild(this.#o))}#b(){i.M5(this,"ELEMENT",this.#o),this.#o.id=this.ID,this.#o.style.position="absolute",this.#o.style.top="0px",this.#o.style.left="0px",this.#o.style.zIndex=this.#e,this.#o.classList.add("FlexBoxEntity"),this.#o.dataset.smooth=this.#a?"yes":"no",this.#o.addEventListener("transitionend",this.#w.bind(this))}M165(){return this.#o&&(this.#o.remove(),this.#o=null,this.#f=null),this}M77(){return this.#o.offsetWidth,this}M101(){return this.#o}M133(){return this.#n}M116(){return this.#r}M190(){return this.#t}M166(){return this.#i}M114(t,i,e,s){this.#n=0|t,this.#r=0|i,s|=0,e|=0;const n=this.#t!==s||this.#i!==e;return n&&(this.#t=s,this.#i=e),this.#y(n),this}#x(){const t=window.getComputedStyle(this.#o).translate;t&&"none"!==t||(this.#u=0,this.#c=0);const i=t.split(" ");this.#u=parseFloat(i[0])||0,this.#c=parseFloat(i[1])||0}M78(t,i){if(t|=0,i|=0,this.#t===i&&this.#i===t)return this;if(this.#a){const e=this.M1(t,i);this.#E(e)}return this.#t=i,this.#i=t,this.#y(!0),this}M1(t,i){this.#x();const e=t-this.#u,s=i-this.#c;return Math.sqrt(e*e+s*s)/this.#l}M160(t,i){return t|=0,i|=0,this.#n===t&&this.#r===i||(this.#n=t,this.#r=i,this.#y(!1)),this}#y(t=!0){this.#v();const i=this.#o.style;i.width=this.#n+"px",i.height=this.#r+"px",t?(i.translate=this.#i+"px "+this.#t+"px 0px",this.#a&&(i.zIndex=199+this.#s)):i.zIndex=this.#e}#w(t){"translate"===t.propertyName&&(this.#x(),Math.abs(this.#u-this.#i)<1&&Math.abs(this.#c-this.#t)<1&&(this.#o.style.zIndex=this.#e,this.#p&&this.#k()))}M43(){return this.#M>0}M134(){return this.#M>0}M135(){return this.#M>0}#k(){const t=this.#f.length;for(let i=0;i<t;i++)this.#f[i](this);this.#f.length=0}M117(t=!0){return this.#a=!!t,this.#o.dataset.smooth=this.#a?"yes":"no",this}M136(){return this.#a}M79(t){return"function"!=typeof t?this:this.#p?(this.#f.push(t),this):void 0}M6(){this.#f.length=0}M13(t=!0){return this.#p=!!t,this}Error(t,i,...e){this.constructor.name,e.length>0&&e.forEach((t,i)=>{})}M118(){return this.#s}M119(t=-1){return this.#s=t,this}M191(t,i=-1){return null!==this.#h?(this.Error("SetBox","Already set",this.#h,t),this):(this.#h=t,i>=0&&(this.#s=i),this)}M137(){return this.#h=null,this.#s=-1,this}M192(){return this.#h}M220(t){return this.#h===t}M193(){return null!==this.#h}#E(t){return!Number.isFinite(t)||t<0?(this.Error("SetTranslationTime","Bad number",t),this):this.#o?(this.#o.style.transitionDuration=t+"ms",this):this}M30(i=0){return this.#l=i||t.K20,this}M221(t){return t|=0,this.#e===t||(this.#e=t,this.#o.style.zIndex=t),this}M138(t){return!Number.isFinite(t)||t<0?(this.Error("SetBaseZ","Bad number",t),this):(t|=0,this.#e<t&&(this.#e=t),this.#o.style.zIndex=t,this)}#v(){this.#d=this.#t+(this.#r>>1),this.#_=this.#i+(this.#n>>1)}M62(){return this.#d}M44(){return this.#_}M4(t,i){const e=t-this.#i,s=i-this.#t;return Math.sqrt(e*e+s*s)/this.#l}M120(){return this.#m}M139(){return!this.#m}M102(t=!0){return t=!!t,this.#m===t||(this.#m=t,this.M15(t)),this}M45(){return this.#m=!this.#m,this.M15(this.#m),this}M103(){return this.#g}M80(t=!0){return t=!!t,this.#g===t||(this.#g=t,this.M20(t)),this}M35(){return this.#g=!this.#g,this.M20(this.#g),this}},H=1/0,q=class extends j{static ROW=11;static COLUMN=12;static K138=3;static K142=1;static K149=2;static K139=4;static K132=5;static K140=6;static K143=7;#L=11;#C=!0;#I=[];#S=null;#A=null;#N=null;#T=H;#D=0;#R=0;#O=0;#P=0;#B=!1;#V=0;#K=0;#F=!1;#z=0;#U=0;#G=j.K137;#j=null;#H=null;#q=null;#$=null;#W=!1;#X=0;#Y=!1;constructor(t,i,e,s,n,r=!1,o={}){const{max_count:h=H,sorting:a=null,tuck:l=!1,uniform:c=!1,parent:u=null,velocity_px_ms:d=0,reverse_z:_=!1}=o;super(t,i,r,d,{is_box:!0,parent:u}),this.#T=h,this.M81(_),this.#L=e,11!==e&&12!==e&&this.Error("FlexBox","Bad orientation",e),this.#C=11===this.#L,"function"==typeof a&&(this.#S=a);const M=Number.isFinite(this.#T)?this.#T:64;this.#j=new Int32Array(M),this.#H=new Int32Array(M),s=s||4,this.#N=this.#Q(s),3!==(n=n||3)&&1!==n&&2!==n&&this.Error("FlexBox","Bad align",n),this.#A=this.#Q(n),this.#F=c,l>0&&this.M167(l),this.ELEMENT&&this.ELEMENT.classList.add("FlexBox")}M165(){super.M165(),this.#I=null,this.#A=null,this.#N=null,this.#S=null}#J(t,i){if(t.length<i){const e=t.length<<1;t=new Int32Array(e>i?e:i)}return t}M230(t,i=!0){if(!(t instanceof j))return this.Error("Add","Not a FlexBoxEntity",t),this;if(this.#I.includes(t))return this.Error("Add","Already here",t),this;if(this.M197())return this.Error("Add","I am full",t),this;t.M193()&&t.M192().M196(t),i?this.#I.push(t):this.#I.unshift(t);const e=this.#I.length;let s=!i&&e>1;return t.M191(this,i?this.#I.length-1:0),this.#J(this.#j,e),this.#J(this.#H,e),null!==this.#S&&(this.#I.sort(this.#S),s=!0),s&&this.#Z(),this.#F?(0!==this.#z&&0!=this.#U||(this.#z=t.M133(),this.#U=t.M116(),this.#W>0&&this.#tt()),this.#V+=this.#z,this.#K+=this.#U):(this.#V+=t.M133(),this.#K+=t.M116()),this.#B=!0,this.M7(),this}M194(t){return this.M230(t,!1)}M195(t){return this.M230(t,!0)}M196(t){return t instanceof j?this.#I.includes(t)?(t.M137(),t.M6(),i.M11(this.#I,t),this.#Z(),this.#F?(this.#V-=this.#z,this.#K-=this.#U):(this.#V-=t.M133(),this.#K-=t.M116()),this.#B=!0,this.M7(),this):(this.Error("Remove","Not here",t.ID),this):(this.Error("Remove","Not a FlexBoxEntity",t),this)}M160(t,i){t|=0,i|=0,super.M160(t,i),this.#D=t,this.#R=i}M114(t,i,e,s,n=!0){return t|=0,i|=0,e|=0,s|=0,super.M114(t,i,e,s),this.#D=t,this.#R=i,this.#P=e,this.#O=s,n&&this.M7(),this}M31(t,i,e=-1){return this.#z=0|t,this.#U=0|i,this.#W>0&&this.#tt(),this.#F=!0,this.#B=!1,e>=0&&(this.#G=e),this.M14(),this}M81(t=!0){this.#Y=!!t,this.M7()}M32(t=-1){t>=0&&(this.#G=0|t)}M14(){let t=0,i=0;const e=this.#I.length;if(e>0){if(this.#F){if(0===this.#z||0===this.#U){const t=this.#I[0];this.#z=t.M133(),this.#U=t.M116(),this.#W>0&&this.#tt()}t=e*this.#z,i=e*this.#U}else for(let s,n=0;n<e;n++)s=this.#I[n],t+=s.M133(),i+=s.M116();(isNaN(t)||isNaN(i))&&this.Error("UpdateEntitiesSize","total width/height is NaN"),(t<0||i<0)&&this.Error("UpdateEntitiesSize","total width/height is negative",t,i)}return this.#V=t,this.#K=i,this.#B=!0,this}#it(t=-1){if(-1===t&&(t=this.#I.length),0===t)return this;this.#B||this.M14();const i=this.#C;let e=i?this.#V:this.#K,s=this.#W&&t>1;if(s){const n=i?this.#D:this.#R;s=e>n,s&&(this.#et(t,n,e),e-=(t-1)*this.#X)}return i?(this.#q=this.#N(!0,!0,e,t),this.#$=this.#A(!1,!1,this.#K,t)):(this.#$=this.#N(!0,!1,e,t),this.#q=this.#A(!1,!0,this.#V,t)),s&&this.#st(i,t),t}#et(t,i,e){this.#C?this.#z:this.#U;const s=(e-i)/(t-1);this.#X=s}#st(t,i){const e=t?this.#q:this.#$;for(let t=1;t<i;t++)e[t]-=t*this.#X}M167(t=!0){this.#W=!!t,this.#W&&this.M7()}M140(t){return this.#F||0===t?t<0||t>1?(this.Error("SetTuck","Tuck must be [ 0 .. 1 ]",t),this):(this.#W=t,this.#tt(),void(this.#I.length>1&&this.M7())):(this.Error("SetTuck","Cannot tuck non-uniform entities"),this)}#tt(){if(!this.#F)return void(this.#X=0);const t=this.#C?this.#z:this.#U;this.#X=t*this.#W|0}M78(t,i){super.M78(t,i),this.#P=t,this.#O=i}M7(t=!0){const i=this.#I.length;if(0===i)return this;t&&this.#it(i);const e=this.#G;for(let t=0;t<i;t++){const s=this.#I[t];this.#Y?s.M221(e+(i-t)):s.M221(e+t),s.M78(this.#q[t],this.#$[t]),s.IS_BOX&&s.M7(!0)}return this}#nt(t,i=-1){if(i<0&&(i=t.M118()),this.#Y){const e=this.#I.length;t.M221(this.#G+(e-i))}else t.M221(this.#G+i);return t.M78(this.#q[i],this.#$[i]),this}#Q(t){switch(t){case 3:return this.#rt.bind(this);case 1:return this.#ot.bind(this);case 2:return this.#ht.bind(this);case 4:return this.#at.bind(this);case 5:return this.#lt.bind(this);case 6:return this.#ct.bind(this);case 7:return this.#ut.bind(this)}}#dt(t,i,e){const s=(t?this.#j:this.#H).subarray(0,e),n=i?this.#P:this.#O;var r=i?this.#z:this.#U;if(t&&this.#F)for(var o=0;o<e;++o)s[o]=n+o*r;else{var h=n;for(o=0;o<e;++o){if(t&&o>0){if(!this.#F){const t=this.#I[o-1];r=i?t.M133():t.M116()}h+=r}s[o]=h}}return s}#ot(t,i,e,s){return this.#dt(t,i,s)}#rt(t,i,e,s){const n=this.#dt(t,i,s),r=i?this.#D:this.#R,o=r-e>>1;var h=i?this.#z:this.#U;if(!t&&this.#F){const t=r-h>>1;for(var a=0;a<s;++a)n[a]+=t}else for(a=0;a<s;++a)if(t)n[a]+=o;else{if(!this.#F){const t=this.#I[a];h=i?t.M133():t.M116()}n[a]+=r-h>>1}return n}#ht(t,i,e,s){const n=this.#dt(t,i,s),r=i?this.#D:this.#R,o=Math.round(r-e);var h=i?this.#z:this.#U;if(!t&&this.#F){const t=r-h;for(var a=0;a<s;++a)n[a]+=t}else for(a=0;a<s;++a)if(t)n[a]+=o;else{if(!this.#F){const t=this.#I[a];h=i?t.M133():t.M116()}n[a]+=r-h}return n}#ut(t,i,e,s){const n=this.#dt(t,i,s),r=(i?this.#D:this.#R)>>1;var o=i?this.#z:this.#U;const h=n[0];for(var a=0;a<s;++a){if(!this.#F){const t=this.#I[a];o=i?t.M133():t.M116()}n[a]=h+r-(o>>1)}return n}#lt(t,i,e,s){if(s<2)return this.#ot(t,i,e,s);const n=this.#dt(t,i,s),r=i?this.#D:this.#R,o=Math.round((r-e)/(s-1));for(var h=1;h<s;++h)n[h]+=h*o;return n}#at(t,i,e,s){const n=this.#dt(t,i,s),r=i?this.#D:this.#R,o=Math.round((r-e)/(s+1));for(let t=0;t<s;++t)n[t]+=(t+1)*o;return n}#ct(t,i,e,s){if(s<2)return this.#rt(t,i,e,s);const n=this.#dt(t,i,s),r=((i?this.#D:this.#R)-e)/s,o=r>>1;for(let t=0;t<s;++t)n[t]+=o+t*r|0;return n}M82(t){return!Number.isFinite(t)||t<=0?(this.Error("SetMaxCount","Bad number",t),this):(this.#T=0|t,this)}M83(){return this.#T}M197(){return this.#I.length>=this.#T}M104(t){return"function"!=typeof t||(this.#S=t),this}M105(t){return this.#N=this.#Q(t||4),this}M222(t){return"function"!=typeof t&&(t=this.#S),"function"!=typeof t||(this.#I.sort(t),this.#Z(),this.M7()),this}#Z(t=-1){if(t<0&&(t=this.#I.length),!(t<0))for(let i=0;i<t;++i)this.#I[i].M119(i)}M168(){const t=this.#I.length;return t<=1||(M12(this.#I),this.#Z(t),this.M7()),this}M169(){return 0===this.#I.length}M141(t){return this.#I.includes(t)}M142(){return this.#I.length}M170(t){if("function"!=typeof t)return this;const i=this.#I.length;for(let e,s=0;s<i;s++)e=this.#I[s],t(e);return this}M171(){return this.#I.length>0?this.#I[0]:null}M106(){if(this.#I.length<=0)return null;const t=this.#I[0];return this.M196(t),t}M172(){const t=this.#I.length;return t>0?this.#I[t-1]:null}M107(){const t=this.#I.length;if(t<=0)return null;const i=this.#I[t-1];return this.M196(i),i}M84(t){return t<0||t>=this.#I.length?(this.Error("GetEntityAt","Bad idx",t),null):this.#I[t]}M198(){return[...this.#I]}M85(t){return"function"!=typeof t?null:this.#I.filter(t)}M211(){const t=this.#I.length;if(0===t)return this;for(let i=0;i<t;i++){const t=this.#I[i];t.M137(),t.M6()}return this.#I.length=0,this.#V=0,this.#K=0,this.#B=!0,this}#_t(t=0){const i=this.#I.length+t;return i>this.#T?(this.Error("#PrepareBatchAdd","Total exceeds max_count",i),this):(i>0&&(this.#j=this.#J(this.#j,i),this.#H=this.#J(this.#H,i)),this)}M143(t,i=!0,e=0){const s=t.length;if(0===s)return this;if(this.M197())return this.Error("BatchAdd","I am full"),this;const n=this.M142()+s;if(n>this.M83())return this.Error("BatchAdd","Not enough space"),this;for(let i=0;i<s;i++){const e=t[i];if(!(e instanceof j))return this.Error("BatchAdd","Not a FlexBoxEntity",e),this;if(this.#I.includes(e))return this.Error("BatchAdd","Already here",e),this}const r=[...this.#I],o=r.length;this.#_t(s);for(let e=0;e<s;e++){const s=t[e];s.M193()&&s.M192().M196(s),s.M191(this),i?this.#I.push(s):this.#I.unshift(s);const n=this.#F?this.#z:s.M133(),r=this.#F?this.#U:s.M116();this.#V+=n,this.#K+=r}this.#B=!0,null!==this.#S&&this.#I.sort(this.#S),this.#Z(n),this.#it(n);for(let t=0;t<o;t++){const i=r[t];this.#nt(i)}if(0===e)for(let i=0;i<s;i++){const e=t[i];this.#nt(e)}else{let i=e;e<=1&&(i=this.M2(t[0])*e);let n=0;for(let e=0;e<s;e++){const s=t[e];setTimeout(()=>{this.#nt(s)},n),n+=i}}return this}M86(t=null,e=0){const s=null===t?[...this.#I]:t,n=s.length;if(0===n)return this;for(let t=0;t<n;t++){const i=s[t];if(!(i instanceof j))return this.Error("BatchRemove","Not a FlexBoxEntity",i),this;if(!this.#I.includes(i))return this.Error("BatchRemove","Not here",i),this}for(let t=n-1;t>=0;t--){const e=s[t];i.M11(this.#I,e),e.M137(),e.M6();const n=this.#F?this.#z:e.M133(),r=this.#F?this.#U:e.M116();this.#V-=n,this.#K-=r}this.#B=!0;const r=this.#I,o=r.length;if(this.#Z(o),this.#it(o),0===e)this.M7(!1);else{let t=e;e<=1&&(t=this.M2(r[0])*e);let i=t;for(let e=0;e<o;e++){const s=r[e];setTimeout(()=>this.#nt(s),i),i+=t}}return this}M2(t){if(!t.M220(this))return this.Error("GetEntityTranslationTime","Not here",t),0;const i=t.M118();return i<0||i>=this.#I.length?(this.Error("GetEntityTranslationTime","Bad index",t),0):t.M1(this.#q[i],this.#$[i])}M3(t){return t.EstimateTravelTime(this.M44(),this.M62())}M173(t=""){for(let t=0;t<this.#I.length;++t)this.#I[t];return!0}},$={smooth:!0,touch_down_events:!1,velocity_px_ms:.5,visible:!1,selected:!1,flip_time:500,face_up:!0,flip_axis:"y"},W=class t extends j{static K137=110;#Mt=null;#pt=null;#ft=null;#mt=$.face_up;constructor(t){super(t,"Card_"+t,!0),this.#gt(t),i.M5(this,"BODY",this.#Mt),i.M5(this,"FACE",this.#pt),i.M5(this,"BACK",this.#ft),this.M212()}M165(){super.M165()}M212(i={}){for(const t in $){const e=i[t]??$[t];i[t]=e}this.M193()&&this.M192().M196(this),this.M6(),this.M117(i.smooth),this.M13(i.touch_down_events),this.M30(i.velocity_px_ms),this.M102(i.visible),this.M80(i.selected),this.M221(t.K137),this.M87(i.flip_time),this.M121(i.face_up),this.M88(i.flip_axis)}#gt(i){this.ELEMENT.classList.add("Card"),this.#Mt=document.createElement("div"),this.#Mt.classList.add("CardBody"),this.#Mt.classList.add("Clickable"),this.#Mt.dataset.idx=i,this.#Mt.card=this,this.#Mt.dataset.face=this.#mt?"up":"no",this.#Mt.dataset.visible=this.M120()?"yes":"no",this.#pt=document.createElement("div"),this.#pt.classList.add("CardFace"),this.#ft=document.createElement("div"),this.#ft.classList.add("CardBack"),this.#Mt.appendChild(this.#pt),this.#Mt.appendChild(this.#ft),this.ELEMENT.appendChild(this.#Mt),this.M138(t.K137)}M8(){return this.#Mt}M121(t=!0){return this.#mt=!!t,this.#Mt.dataset.face=this.#mt?"up":"down",this.OnFlip&&this.OnFlip(t),this}M144(){return this.#mt}M108(){return!this.#mt}M15(t){return this.#Mt.dataset.visible=t?"yes":"no",this}M20(t){return this.#Mt.dataset.selected=t?"yes":"no",this}M87(t){return!Number.isFinite(t)||t<0?(this.Error("SetFlipTime","Bad number",t),this):(this.#Mt.style.transitionDuration=t+"ms",this)}M88(t="x"){if("string"!=typeof t||1!==t.length)return this.Error("SetFlipAxis","Bad axis",t),this;if("x"!==(t=t.toLowerCase())&&"y"!==t)return this.Error("SetFlipAxis","Bad axis",t),this;const i="x"===t?"1":"0",e="y"===t?"1":"0";return this.#Mt.style.setProperty("--ROT_X",i),this.#Mt.style.setProperty("--ROT_Y",e),this}M223(){return this.#mt=!this.#mt,this.#Mt.dataset.face=this.#mt?"up":"down",this.OnFlip&&this.OnFlip(this),this}},X={};((t,i)=>{for(var e in i)G(t,e,{get:i[e],enumerable:!0})})(X,{K68:()=>nt,K69:()=>ot,K116:()=>rt,K89:()=>_t,K90:()=>Et,K91:()=>st,K117:()=>it,K118:()=>et,K21:()=>wt,K22:()=>bt,K127:()=>pt,K119:()=>ft,K92:()=>Mt,K120:()=>gt,K93:()=>yt,K94:()=>mt,K55:()=>xt,K70:()=>J,K71:()=>Z,K95:()=>Y,K23:()=>tt,K96:()=>Q,K144:()=>ut,K97:()=>ht,K31:()=>at,K72:()=>ct,K98:()=>dt,K73:()=>lt});var Y=0,Q=6,J=10,Z=14,tt=15,it=63,et=15,st=15,nt=1<<J,rt=2<<J,ot={[nt]:"Black",[rt]:"Red"},ht=1<<Q,at=2<<Q,lt=3<<Q,ct=4<<Q,ut=[ht,at,lt,ct].sort(),dt={[ht]:"Clubs",[at]:"Diamonds",[ct]:"Hearts",[lt]:"Spades"},_t=1<<Z,Mt=0,pt=1,ft=11,mt=12,gt=13,bt=Math.min(ft,mt,gt),wt=Math.max(ft,mt,gt),yt={[pt]:"Ace",[ft]:"Jack",[mt]:"Queen",[gt]:"King"},xt={[pt]:"A",[ft]:"J",[mt]:"Q",[gt]:"K"},Et={name:"Joker",suit:"joker",symbol:"JKR",rank:Mt,flag:_t},vt=class extends W{#bt=!1;#wt=!1;#yt=null;constructor(t,e){super(t),i.M5(this,"DNA",e);const s=e&it,n=e&et<<Q,r=e&st<<J;i.M5(this,"RANK",s),i.M5(this,"SUIT",n),i.M5(this,"COLOR",r),this.#bt=0!==(e&_t),this.#wt=!this.#bt&&this.RANK>=bt&&this.RANK<=wt,this.#xt(),this.#Et()}M145(){return"("+this.IDX+") "+this.M89()+" of "+this.M90()}#xt(){const t=this.M89().toLowerCase(),i=this.M90().toLowerCase(),e=this.M213()?"red":"black",s=this.BODY;s.dataset.rank=t,s.dataset.suit=i,s.dataset.color=e,this.#bt?s.dataset.joker="yes":this.#wt&&(s.dataset.royal="yes")}#Et(){const t=this.M47().toUpperCase(),i=this.M90();this.FACE.innerHTML="";const e=document.createElement("p");e.innerText=t,this.#yt=e,this.#wt&&this.M46(this.RANK),this.FACE.appendChild(this.#yt);{const t=this.#vt(i.toLowerCase());this.FACE.appendChild(t)}}M46(t){const i=document.createElement("span");i.innerText=t,this.#yt.appendChild(i)}#vt(t){this.M213();const i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("class","SuitIcon"),i.innerHTML=`<use href="#suit-${t}"/>`,i}M160(t,i){super.M160(t,i),this.FACE.style.fontSize=Math.round(.4*t)+"px"}static async M122(t){try{const i=M19("flex-box/"),e=await fetch(i+t),s=await e.text(),n=document.getElementById("card-sprite-sheet");n&&n.remove();const r=document.createElement("div");r.id="card-sprite-sheet",r.style.display="none",r.innerHTML=s,document.body.appendChild(r)}catch(t){}}M213(){return this.COLOR===rt}M174(){return this.COLOR===nt}M175(){return this.#bt}M176(){return this.#wt}M146(){return!this.#bt&&!this.#wt}M214(){return this.RANK===pt}M199(){return this.RANK===ft}M177(){return this.RANK===mt}M200(){return this.RANK===gt}M201(){return this.RANK%2==0}M215(){return this.RANK%2!=0}M202(t){return this.SUIT===t}M89(){return this.#bt?Et.name:yt[this.RANK]||this.RANK.toString()}M90(){return this.#bt?Et.suit:dt[this.SUIT]||"Unknown"}M47(){return this.#bt?Et.symbol:xt[this.RANK]||this.M89()}M63(){return ot[this.COLOR]||"Unknown"}},kt=1/0,Lt=!0,Ct=!0,It=class extends q{#mt=Ct;#kt=Lt;constructor(t,i,e,s,n,r,o={}){const{max_cards:h=kt,flip_after:a=Lt,face_up:l=Ct,sorting:c=null,tuck:u=!1,uniform:d=!0,parent:_=null,reverse_z:M=!1}=o;super(t,i,e,s,n,r,{max_count:h,sorting:c,tuck:u,uniform:d,parent:_,reverse_z:M}),this.M32(vt.K137),this.ELEMENT&&this.ELEMENT.classList.add("BoxOfCards"),this.M121(l),this.M64(a)}#Lt(t,i){t.M121(i)}M230(t,i=!0){return t instanceof vt?(super.M230(t,i),this.#kt?t.M79(this.#Lt.bind(this,t,this.#mt)):t.M121(this.#mt),this):(this.Error("Add","Not a Card instance",t),this)}M194(t){return this.M230(t,!1)}M195(t){return this.M230(t,!0)}M141(t){return t instanceof vt?super.M141(t):(this.Error("Includes","Not a Card instance",t),this)}M143(t,i=!0,e=0){const s=t.length;if(0===s)return this;for(let i=0;i<s;i++){const e=t[i];if(!(e instanceof vt))return this.Error("BatchAdd","Not a Card instance",e),this}if(this.M142()+s>this.M83())return this.Error("BatchAdd","I am full"),this;super.M143(t,i,e);for(let i=0;i<s;i++){const e=t[i];this.#kt?e.M79(this.#Lt.bind(this,e,this.#mt)):e.M121(this.#mt)}return this}M196(t){return t instanceof vt?(super.M196(t),this):(this.Error("Remove","Not a Card instance",t),this)}M86(t=null,i=0){const e=null===t?[...this.GetEntities()]:t,s=e.length;if(0===s)return this;for(let t=0;t<s;t++){const i=e[t];if(!(i instanceof vt))return this.Error("Remove","Not a Card instance",i),this}return super.M86(t,i),this}M123(t){return super.M84(t)}M121(t=!0){return this.#mt=!!t,this}M64(t=!0){return this.#kt=!!t,this}};function St(t,i){return t.IDX-i.IDX}var At=class{#Ct=[];#It=[];#St=[];#At=null;#Nt=0;#Tt=[];constructor(t={},i={}){const{jokers:e=0,exclude_ranks:s=[],exclude_cards:n=[],suits:r=ut,seed:o=0}=t;this.#Nt=o,this.#Dt(r,s,n,e),this.#At={smooth:i.smooth??!0,touch_down_events:i.touch_down_events??!0,velocity_px_ms:i.velocity_px_ms??100,flip_time:i.flip_time??500,face_up:i.face_up??!0,visible:i.visible??!0,flip_axis:i.flip_axis??"y"},this.M212()}#Rt(t,i,e){return(t&it)===i&&(t&et<<Q)===e}#Dt(t,i,e,s){for(const s of t){const t=s===at||s===ct?rt:nt;for(let n=1;n<=13;n++){if(i.includes(n))continue;if(e.some(t=>this.#Rt(n|s,t.rank,t.suit)))continue;const r=n|s|t,o=new vt(this.#Ct.length,r);this.#Ct.push(o)}}for(let t=0;t<s;t++){const i=_t|(t%2==0?nt:rt),e=new vt(this.#Ct.length,i);this.#Ct.push(e)}}M91(t){let i=0;for(const e of t)for(let t=0;t<this.#Ct.length;++t){const s=this.#Ct[t];if(this.#Rt(s.DNA,e.rank,e.suit)){i+=1,this.#Ct.splice(t,1),this.#Tt.push(s);break}}this.#Ot()}M65(t){}#Ot(){this.#St=[],this.#It=this.#Ct.map((t,i)=>i)}M212(){this.#Ot();const t=new Set;this.#Ct.forEach(i=>{const e=i.M192();e&&t.add(e)}),t.forEach(t=>t.M211());const i=this.#At;for(const t of this.#Ct)t.M212(i);return this}M224(t=null,i=0){if(null===t)return this;const e=this.M179(),s=i>0;return this.M170(t=>{t.M102(s),t.M117(s),t.M87(0),t.M121(!1)}),t.M143(e,!0,i>0?i:0),this.M170(t=>{t.M87(this.#At.flip_time),t.M117(this.#At.smooth)}),this}M168(t=0){let e=Math.random;0!==(t=t||this.#Nt)&&(t="string"==typeof t?M100(t):t,e=i.M27(t));const s=this.#It;for(let t=s.length-1;t>0;t--){const i=Math.floor(e()*(t+1));[s[t],s[i]]=[s[i],s[t]]}return this}M178(t=0){return this.#Nt="string"==typeof t?M100(t):0|t,this.#Nt}M225(){if(0===this.#It.length)return null;const t=this.#It.pop();return this.#St.push(t),this.#Ct[t]}M179(){const t=[];return this.#It.forEach(i=>{t.push(this.#Ct[i])}),this.#St=this.#It,this.#It=[],t}M147(){const t=this.#It[this.#It.length-1];return this.M180(t)}M180(t){return this.#Ct[t]}M48(t){if("function"!=typeof t)return[];const i=[];for(let e=this.#It.length-1;e>=0;e--){const s=this.#It[e],n=this.#Ct[s];t(n)&&(this.#It.splice(e,1),this.#St.push(s),i.push(n))}return i}M66(t,i){t|=0,i|=0,this.#Ct.forEach(e=>e.M160(t,i))}M181(){return this.#Ct.length}M21(){return this.#It.length}M170(t){return"function"!=typeof t||this.#Ct.forEach((i,e)=>t(i,e)),this}M22(t,i){const e=t.SUIT,s=i.SUIT;return e<s?-1:e>s?1:Math.sign(t.RANK-i.RANK)}},Nt="off",Tt=class extends It{static K74=Nt;static K75="top";static K32="right";static K24="bottom";static K56="left";#Pt=null;#Bt=!1;#Vt=0;#Kt=null;constructor(t,e,s={}){const{max_cards:n=1/0,counter_position:r=Nt,pop_effect:o=!1,face_up:h=!0,parent:a=null}=s;super(t,e,q.ROW,q.K143,q.K138,!0,{max_cards:n,parent:a}),this.#Ft(),this.#zt(),this.M16(r),this.M67(o),this.M121(h),i.M5(this,"COUNTER",this.#Pt)}#Ft(){const t=this.ELEMENT;t.classList.add("PileOfCards");const i=document.createElement("span");i.classList.add("PileCounter"),i.innerText="0",t.appendChild(i),this.#Pt=i}M230(t,i=!0){return super.M230(t,i),this.#Ut(t,i),this}#Ut(t,i=!0){t.M136()?(this.#Vt++,t.M79(()=>{this.#Vt--,this.#zt(),this.#Gt(i?t:null),i||this.#Kt===t||t.M102(!1)})):(this.#Gt(i?t:null),i||this.#Kt===t||t.M102(!1),this.#zt())}#Gt(t=null){const i=this.M142();if(0===i)return;const e=this.#Kt;if(null===t)for(let e=i-1-this.#Vt;e>=0;--e){const i=this.M84(e);if(!i.M134()){t=i;break}}e!==t&&(e&&e.M102(!1),this.#Kt=t,t.M102(!0))}M143(t,i=!0){super.M143(t,i);const e=t.length;let s;for(let i=0;i<e;i++)s=t[i],s.M102(!1);return this.#zt(),this.#Gt(i?s:null),this}M196(t){return super.M196(t),this.#jt(t),this}#jt(t,i=!0){t.M102(!0),t.M134()&&this.#Vt--,i&&(this.#Kt===t&&(this.#Kt=null,this.#Gt(null)),this.#zt())}M86(t=null,i=0){const e=this.#Kt,s=null===t?[...this.GetEntities()]:t,n=s.length;if(0===n)return this;super.M86(t,i);for(let t=0;t<n;t++){const i=s[t];this.#jt(i,!1)}return s.includes(e)&&this.#Gt(),this.#zt(),this}M211(){return super.M211(),this.#Kt=null,this.#Vt=0,this.#zt(),this}M148(t){return this.M230(t,!0)}M92(t){return this.M230(t,!1)}M93(){const t=this.M172();return t&&this.M196(t),t}M36(){const t=this.M171();return t&&this.M196(t),t}M190(){return this.M172()}M124(){return this.M171()}M168(){const t=this.M142();if(t>0&&this.#Ht(),t<=1)return;const i=this.#Kt;super.M168();const e=this.M84(t-1);return i!==e&&(i.M102(!1),e.M102(!0),this.#Kt=e),this}M16(t){return this.ELEMENT.dataset.counter=t,this}M67(t){return this.#Bt=!!t,this}#zt(){const t=this.M142()-this.#Vt;this.#Pt.innerText=t,this.#Bt&&this.#Ht()}#Ht(){const t=this.#Pt;t.classList.remove("PopEffect"),this.M77(),t.classList.add("PopEffect")}debug(){const t=this.M142();for(let i=0;i<t;++i)this.M84(i)}M182(){const t=this.M142();return 0===t?null:this.M84(t-1)}M109(){return 0===this.M142()?null:this.M84(0)}},Dt=class{#qt;#$t=[];#Wt;#Xt={};#Yt=null;#Qt="";constructor(t,i,e){this.#qt=t+"_",this.#Wt=i,this.#Qt=e??""}M125(t,i){this.#$t.push({id:t,schema:i}),i.forEach(t=>{const i=localStorage.getItem(this.#qt+t.id);null!==i?this.#Xt[t.id]=this.#Jt(i):(this.#Xt[t.id]=t.default,this.M226(t.id,t.default))})}#Jt(t){return"true"===t||"false"!==t&&(isNaN(t)||""===t?t:Number(t))}M203(){for(const{id:i,schema:e}of this.#$t)this.#Zt(t(i),e)}#Zt(t,i){if(!t)throw new Error("SettingsManager::RenderTo » No parent");this.#Yt=t;const e=i.map(t=>this.#ti(t));this.#Yt.innerHTML=e.join(""),this.#Yt.querySelectorAll("INPUT").forEach(t=>t.classList.add("Clickable")),this.#Yt.querySelectorAll("LABEL").forEach(t=>t.classList.add("Clickable")),this.#ii()}#ti(t){const i=this.#Xt[t.id];let e="";return"radio"===t.type?e=t.options.map((e,s)=>`\n                <label>\n                    <input type='radio' name='${t.id}' value='${s+1}' ${i===s+1?"checked":""}>\n                    ${e}\n                </label>\n            `).join(""):"range"===t.type?e=`\n                <input type='range' id='${t.id}' \n                    min='${t.min}' max='${t.max}' step='${t.step}' \n                    value='${i}'>\n            `:"checkbox"===t.type?e=`\n                <input type='checkbox' id='${t.id}' ${i?"checked":""}>\n            `:"text"===t.type&&(e=`\n                <input type='text' id='${t.id}' \n                    value='${i}'>\n            `),`\n            <div class='AppSettingsRow' data-setting-id='${t.id}'>\n                <label class='AppSettingsMainLabel'>${t.label}</label>\n                <div class='AppSettingsInputWrapper'>${e}</div>\n            </div>\n        `}#ii(){this.#Yt.addEventListener("input",t=>{t.stopPropagation(),t.preventDefault();const i=t.target,e=i.name||i.id;let s="checkbox"===i.type?i.checked:i.value;isNaN(s)||"range"!==i.type||(s=Number(s)),this.M49(e,s)}),this.#Yt.addEventListener(this.#Qt,t=>{"INPUT"===t.target.tagName&&(t.is_onesie_ui=!0),"LABEL"===t.target.tagName&&(t.is_onesie_ui=!0)})}M49(t,i){this.#Xt[t]=i,this.M226(t,i),this.#Wt&&this.#Wt(t,i)}M226(t,i){localStorage.setItem(this.#qt+t,i)}M231(t){return this.#Xt[t]}},Rt="https://",Ot="rqhvlh0vwdwv",Pt=window.visualViewport,Bt="AppRotate",Vt="AppError",Kt="AppErrorInfo",Ft="AppViewport",zt="PageHidden",Ut="Hidden",Gt=Bt.toLowerCase(),jt=Vt.toLowerCase(),Ht="Home".toLowerCase(),qt="Play".toLowerCase(),$t=class e{static K121=1;static K128=2;static K147=3;#ei=null;#si=null;#ni=new Map;#ri=e.K121;#oi=null;#hi=null;#ai=null;#li=null;#ci=null;#ui=null;#di=null;#_i=null;#Mi=null;#pi=null;#Qt="";#fi=!0;constructor(t={}){this.#Qt=i.M131?"touchstart":"click",this.#mi(t);const e=t.start_page||Ht;requestAnimationFrame(()=>this.M150(e))}#mi(t){if(this.#ei=document.getElementById(Ft),null===this.#ei)throw new Error("App » Element not found: #"+Ft);this.#gi();const i=this.#ni.get(Gt);if(!i)throw new Error("App » Element not found: #"+Bt);i.classList.add(Bt);const e=this.#ni.get(jt);if(!e)throw new Error("App » Element not found: #"+Vt);if(e.classList.add(Vt),this.#hi=document.getElementById(Kt),!this.#hi)throw new Error("App » Element not found: #"+Kt);this.#bi(t),this.#wi(),this.#yi(),this.#xi(),this.#Ei(t),this.#vi(t),this.#ri=t.page_mode??1,this.#ki(),this.#_i=t.on_resize||this.#_i||null,this.#Mi=t.on_click||this.#Mi||null,this.#pi=t.on_page||this.#pi||null}#bi(t){const i=new W("Onesie");i.M102(!0),i.M121(!1),i.M117(!1),this.#ui=i;const e=this.#ni.get(Ht);if(e.appendChild(i.ELEMENT),e.classList.add("Clickable"),t.blank_card)return;const s=t.game_name||"Some Card Game",n=t.game_designer||"Some Great Designer",r=t.game_build||("undefined"!=typeof BUNDLE_ID?BUNDLE_ID:"0000-0000-0000"),o="p";if(!t.blank_back){const t=document.createElement(o);t.classList.add("h1"),t.innerHTML="ONESIE",i.BACK.appendChild(t);const e=document.createElement(o);e.classList.add("h2"),e.innerHTML="1p card games",i.BACK.appendChild(e);const s=document.createElement(o);s.classList.add("h3"),s.innerHTML="build:<br><span>"+r+"</span>",i.BACK.appendChild(s)}if(!t.blank_face){const t=document.createElement(o);t.classList.add("h1"),t.innerHTML=s;const e=document.createElement(o);e.classList.add("h2"),e.innerHTML="<small>designed by:</small><br>"+n;const h=document.createElement(o);h.classList.add("h2"),h.innerHTML="<small>coded by:</small><br>Pedro Fontoura";const a=document.createElement(o);a.classList.add("h3"),a.innerHTML="build:<br><span>"+r+"</span>";const l=document.createElement(o);l.classList.add("h3"),l.innerHTML="♦ a solitaire card game ♦";for(const s of[t,l,e,h])i.FACE.appendChild(s)}}#gi(){document.querySelectorAll("#"+Ft+" > section").forEach(t=>{this.#ni.set(t.id.toLowerCase(),t),t.classList.add(zt)})}#xi(){window.addEventListener("resize",()=>this.#ki()),window.addEventListener("contextmenu",t=>{if(t.preventDefault(),t.stopPropagation(),"touchstart"===this.#Qt)return;const i=new MouseEvent(this.#Qt,{view:window,bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});t.target.dispatchEvent(i)},{passive:!1}),window.addEventListener("unhandledrejection",t=>{t.preventDefault(),t.stopPropagation();const i=[this.#Li(t.reason.stack)].join("<br>");this.#Ci("Error",i)}),window.addEventListener("error",t=>{t.preventDefault(),t.stopPropagation();const i=[t.error.message,t.error.fileName,t.error.lineNumber,this.#Li(t.error.stack)].join("<br>");this.#Ci("Error",i)}),this.#li.addEventListener(this.#Qt,t=>{this.#Ii(),t.stopPropagation(),this.#ci.classList.toggle(Ut)}),Array.from(this.#ci.children).forEach(t=>{const i=this.#Si(t);this.#ni.get(i)?t.addEventListener(this.#Qt,t=>{this.#Ii(),t.stopPropagation(),this.#Ai(t)}):t.remove()}),this.#ui.M8().addEventListener(this.#Qt,t=>{this.#Ii(),t.stopPropagation(),this.#ui.M144()?this.M150(qt):this.#ui.M223()}),this.M183(Ht).addEventListener(this.#Qt,t=>{this.#Ii(),t.stopPropagation(),this.#ui.M223()}),window.addEventListener(this.#Qt,t=>{t.stopPropagation(),this.#Ni(t)})}#Ii(){i.M58||i.M131&&i.M18()}#Ai(t){const i=this.#Si(t.target);this.#ni.get(i)&&this.M150(i)}#Ni(t){if(t.is_onesie_ui)return;let i=0,e=0;if("touchstart"===this.#Qt){const s=t.touches[0];i=s.clientX,e=s.clientY}else i=t.clientX,e=t.clientY;if(this.#Mi){if(!this.#fi)return;this.#Mi(t.target,0|i,0|e)}}#wi(){this.#ai=document.getElementById("AppSideMenu"),this.#li=document.getElementById("AppSideMenuMain"),this.#ci=document.getElementById("AppSideMenuGroup"),this.#ci.classList.add(Ut),i.M131&&this.#ai.classList.add("TopSpacing")}#Li(t){return t.split("at ").join("<br>&bull; ")}#Ci(t,i){null!==this.#hi&&(this.#hi.innerHTML+="<h3>"+t+"</h3>"+i,this.M150(jt))}#ki(){const t=Pt.width,i=Pt.height;if(this.#Ti(),this.#ui){const e=.75*Math.min(t,i)|0,s=.7*e|0;this.#ui.M160(s,e),this.#ui.M78(t-s>>1,i-e>>1)}this.#_i&&this.#_i(t,i,this.#ai.offsetWidth)}get M216(){return Pt.width}get M204(){return Pt.height}#Ti(){3!==this.#ri&&((Math.sign(Pt.width-Pt.height)>=0?1:2)!==this.#ri?this.#si!==Gt&&(this.#oi=this.#si,this.M150(Gt)):null!==this.#oi&&(this.M150(this.#oi),this.#oi=null))}async#yi(){await this.M126("./assets/app_icons.svg","icons-sprite-sheet")}async M126(t,i){try{const e=await fetch(t),s=await e.text(),n=document.getElementById(i);n&&n.remove();const r=(new DOMParser).parseFromString(s,"image/svg+xml").querySelector("svg");r&&(r.id=i,r.style.display="none",document.body.insertAdjacentElement("afterbegin",r))}catch(t){}}async M149(t){try{const i=await fetch(t);return i.ok?await i.json():null}catch(t){return null}}#Si(t){const i=t.querySelector("use");if(i)return(i.getAttribute("href")||i.getAttribute("xlink:href")).split("-").pop().toLowerCase()}get M110(){return this.#ai.offsetWidth}get M227(){return this.#ui}M150(t,i=!1){const e=this.#si===t;t=t.toLowerCase();const s=this.#ni.get(t);if(!s)throw new Error("App » No such page: "+t);t===qt&&this.#fi,this.#si&&this.#ni.get(this.#si).classList.add(zt),s.classList.remove(zt),this.#si=t,t===Ht?this.#ai.classList.add(Ut):this.#ai.classList.remove(Ut);const n=this.#ui;n&&n.M121(!1),this.#pi&&!i&&this.#pi(t,e)}M127(t){return this.#si===t}M183(t){const i=this.#ni.get(t);if(!i)throw new Error("App » No such page: "+t);return i}M68(){const t=window.matchMedia("(display-mode: standalone)").matches,i=!0===window.navigator.standalone;return t||i}M151(t=!0){(t=!!t)&&this.#fi?this.#ci.classList.remove(Ut):this.#ci.classList.add(Ut)}M33(t,i){t.classList.add("Clickable"),t.addEventListener(this.#Qt,e=>{e.preventDefault(),e.stopPropagation(),i(t)})}get M232(){const t=new Date,e=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}-${String(t.getHours()).padStart(2,"0")}-${String(t.getMinutes()).padStart(2,"0")}`;return i.M100("Onesie"+e)}async M94(t=!0){const e=await this.#Di();if("Wrpq}Qjt7qxvn"===i.M59(e,9))return this.#fi=!0,!0;let s=!1;return window.top===window.self&&"ynm{x6oxw}x~{j7pr}q~k7rx"===i.M59(window.location.hostname,9)&&(s=i.M17("key",0,!0)===this.M232),this.#fi=s,!s&&t&&this.#Ri(),s}#Ri(){const t=Rt+i.M59("ynm{x6oxw}x~{j7pr}q~k7rx8xwn|rn8HyjpnFyuj",-9);self.location.replace(t)}#Di=async()=>(await fetch(window.location.href,{method:"HEAD"})).headers.get("server");async M50(t,e=!0){const s=Rt+i.M59("etm2gsyrxivetm2hiz3z6",-4)+"/"+i.M59(Ot,-3)+"/"+i.M59(t,-5)+"/"+(e?"up":"down");if(!i.M58)try{const t=await fetch(s),i=await t.json();i.data&&i.data}catch(t){}}#Ei(i={}){const e=i.settings||{};this.#di=new Dt(e.prefix??"GAME",e.on_change??null,this.#Qt),t("GameSettings")&&this.#di.M125("GameSettings",e.schema||[]),t("GeneralSettings")&&this.#di.M125("GeneralSettings",[{id:"deck_seed",label:"Deck seed",type:"text",default:""},{id:"cards_theme",label:"Cards theme",type:"radio",options:["Normal","Vintage","Modern"],default:0},{id:"cards_speed",label:"Cards speed",type:"range",min:1,max:4,step:1,default:1},{id:"cards_flip",label:"Cards flip time",type:"range",min:1,max:4,step:1,default:1}]),this.#di.M203()}#Oi=null;M111(e,s="get"){if(!["get","up","down"].includes(s))return;if(null===this.#Oi)return;const n=i.M59(e,-5);i.M58||this.#Oi[s](n).then(i=>{i.data,"200"===i.code&&(t("stats_wins")&&(t("stats_wins").innerHTML=i.data.up_count),t("stats_losses")&&(t("stats_losses").innerHTML=i.data.down_count))})}#vi(e){const s=t("Stats");if(!s)return;const n=document.createElement("dl"),r=document.createElement("dt");r.innerHTML="Global stats";const o=document.createElement("dd");o.innerHTML="Wins: <span id='stats_wins'>#</span>";const h=document.createElement("dd");h.innerHTML="Losses: <span id='stats_losses'>#</span>",n.appendChild(r),n.appendChild(o),n.appendChild(h),s.appendChild(n),"function"==typeof Counter&&(this.#Oi=new Counter({debug:!0,timeout:8e3,workspace:i.M59(Ot,-3)}),"string"==typeof e.counter&&this.M111(e.counter,"get"))}},Wt="fsm_data_changed",Xt=class{#Pi=()=>{};V48=!0;V44=new Map;V22=null;V32={};V28=[];V29=[];constructor(t,i=[]){if(this.#Pi=t,i.length>0)for(const t of i)this.V28.push(t)}M37(t){this.#Bi(t)}M51(t){if(null!==t&&!this.V44.has(t))throw new Error("FSM::AssertStateId » Unknown id: "+t)}M52(t){if(!this.V32.hasOwnProperty(t))throw new Error("FSM::AssertDataKey » Unknown key: "+t)}M69(t,i,e=null){this.M51(t),this.M51(i),null!==t&&t!==this.V22.ID||this.#Bi(i,e)}#Bi(t,i=null){if(this.V22&&this.V22.M228(),this.V22=this.V44.get(t),!this.V22)throw new Error("FSM::#TransitionTo » No state! Key:",t);return this.V22.M217(i),!0}M38(t){if(null!==t)return this.M51(t),this.V22.ID===t}M70(t,i={}){this.M51(t);for(const[t,e]of Object.entries(i))this.M52(t),e!==this.V32[t]&&(this.V32[t]=e,this.#Vi(t,e));return this.M38(t)}#Vi(t,i){this.V28.includes(t)&&this.#Ki(Wt,{key:t,value:i})}M71(t,i){if(this.M51(t),"string"==typeof i)return this.M52(i),this.V32[i];const e={};for(const t of i)this.M52(t),this.V32[t],e[t]=this.V32[t];return e}M152(){const t=this.V32;for(const[i,e]of Object.entries(t));}M205(t=null,i,e){t&&this.M51(t),this.#Ki(i,e)}#Ki(t,i){this.#Pi(t,i)}M128(t){this.M51(t),this.V22&&(this.V22.Sleep(),this.V29.push(this.V22)),this.V22=this.V44.get(t),this.V22.M217()}M153(){const t=this.V29;if(0===t.length)throw new Error("FSM::PopState » Stack is empty");this.V22.M228(),this.V22=t.pop(),this.V22.WakeUp()}},Yt=class{constructor(t,e){i.M5(this,"ID",t),i.M5(this,"CONTROLLER",e)}M217(t){}M228(){}M184(t,i){return!1}M95(t,i){return!1}M112(t,i){return!1}M205(...t){return this.CONTROLLER.M205(this.ID,...t)}M185(...t){return this.CONTROLLER.M71(this.ID,...t)}M186(...t){return this.CONTROLLER.M70(this.ID,...t)}M69(...t){return this.CONTROLLER.M69(this.ID,...t)}},Qt=class extends Yt{constructor(t){super(t)}},Jt=class extends Yt{constructor(t,i){super(t,i)}M112(t){if(!t.classList.contains("PredictionBtn"))return this.M205(d,"Not a prediction button"),!1;const i=parseInt(t.dataset.slot_idx);if(this.CONTROLLER.M55(this.ID,i))return this.M205(d,"Slot is blocked"),!1;const e=t.dataset.id;let s=this.M185("nr_predictions");return s+=1,this.M186({slot_idx:i,prediction_key:e,nr_predictions:s}),this.M69(r),!0}},Zt=new Map;Zt.set("R",t=>t.M213()),Zt.set("B",t=>t.M174()),Zt.set("E",t=>t.M201()),Zt.set("O",t=>t.M215()),Zt.set("D",t=>t.M202(X.K31)),Zt.set("H",t=>t.M202(X.K72)),Zt.set("S",t=>t.M202(X.K73)),Zt.set("C",t=>t.M202(X.K97)),Zt.set(N,t=>t.M213()&&t.M215()),Zt.set(R,t=>t.M213()&&t.M201()),Zt.set(T,t=>t.M174()&&t.M201()),Zt.set(D,t=>t.M174()&&t.M215());var ti=class extends Yt{constructor(t,i){super(t,i)}M217(){const t=this.M185("prediction_key"),i=this.CONTROLLER.M157(this.ID),e=Zt.get(t)(i);this.M186({card_idx:i.IDX}),this.M69(e?o:h)}},ii=class extends Yt{constructor(t,i){super(t,i)}M217(){const{nr_predictions:t,nr_predictions_ok:i,slot_idx:e,card_idx:s}=this.M185(["nr_predictions","nr_predictions_ok","slot_idx","card_idx"]),n=i+1,r=n/t*100;this.M186({success:r,nr_predictions_ok:n});const o=this.CONTROLLER.M56(this.ID,s,e),h=this.CONTROLLER.M28(this.ID,e);this.M186({lst_slots_idx:h});const c=h.length>0?l:a;o.M79(t=>this.M69(c))}},ei=class extends Yt{constructor(t,i){super(t,i)}M217(){const{slot_idx:t,card_idx:i}=this.M185(["slot_idx","card_idx"]);this.CONTROLLER.M41(this.ID,i).M79(i=>{this.CONTROLLER.M98(this.ID)?this.M69(u):this.CONTROLLER.M40(this.ID,t).M79(t=>this.M69(a))})}},si=class extends Yt{constructor(t,i){super(t,i)}M217(){const t=this.CONTROLLER.M9(this.ID);this.M186({nr_completed:t}),8!==t?8!==this.CONTROLLER.M26(this.ID)?this.CONTROLLER.M98(this.ID)?this.M69(u):(this.CONTROLLER.M57(this.ID),this.M69(n)):this.M69(u):this.M69(c)}},ni="destination",ri="stone",oi=class extends Yt{#Fi="";#zi=null;#Ui=-1;#Gi="none";#ji=!1;constructor(t,i){super(t,i)}M217(){const{lst_slots_idx:t,level:i}=this.M185(["lst_slots_idx","level"]);this.#zi=t,this.CONTROLLER.M34(this.ID,t,!0),3===i&&this.#zi.length>1?this.#Hi():this.#qi()}#qi(){this.#Gi=ni,this.M205(_,{title:"Where to move the stones?",options:[{label:"Back to Deck (Face Down)",value:z},{label:"To the Table (Face Up)",value:U}],callback:t=>this.#$i(t)}),this.#ji=!0}#Hi(){this.#Gi=ri;const t=[];for(const i of this.#zi)t.push({label:"Slot",value:i});this.M205(_,{title:"Whick stone do you want to remove?",options:t,callback:t=>this.#Wi(t)}),this.#ji=!0}#$i(t){this.#ji=!1,this.#Fi=t,this.#Ui=0,this.#Xi()}#Xi(){if(this.#Ui>=this.#zi.length)return void this.M69(a);const t=this.#zi[this.#Ui];this.CONTROLLER.M34(this.ID,[t],!1),this.CONTROLLER.M96(this.ID,t,this.#Fi).M79(()=>{this.#Ui+=1,this.#Xi()})}#Wi(t){this.#ji=!1;for(const i of this.#zi)i!==t&&this.CONTROLLER.M34(this.ID,[i],!1);this.CONTROLLER.M34(this.ID,[t],!0),this.#zi=[t],this.#qi()}M95(t,i){if(!this.#ji)return!1;if(this.#Gi===ni)return this.#Yi(null,i);if(t.M144())return!1;if(!t.M103())return!1;const e=this.CONTROLLER.M130(this.ID,t,this.#zi);return this.#Wi(e),!0}M184(t,i){if(this.#ji)return this.#Yi(t,i)}#Yi(t,i){return!!this.#ji&&(this.#Gi!==ri?1===i?(this.#$i(z),!0):2===i&&(this.#$i(U),!0):void 0)}},hi=class extends Yt{constructor(t,i){super(t,i)}M217(){this.M205(m,!0)}},ai=class extends Yt{constructor(t,i){super(t,i)}M217(){this.M205(m,!1)}},li=.1,ci=1-li,ui=class extends q{#Qi=null;#Ji=null;#Zi=new Map;#te=!1;#ie=!1;#ee=0;#se=0;constructor(t,e,s,n,r={}){const{parent:o=null,title_height:h=li}=r;ci=1-(li=h),super(t,"PredictionSlot_"+t,q.COLUMN,q.K149,q.K138,!0,{max_count:1,uniform:!0,face_up:!1,parent:o}),i.M5(this,"IDX",t),i.M5(this,"ROW",e),i.M5(this,"COLUMN",s),this.ELEMENT.classList.add("PredictionSlot"),this.#Ji=new It(t,"Predictions_BoxOfCards_"+t,q.COLUMN,q.K138,q.K138,!0,{flip_after:!0,face_up:!0,parent:o,tuck:!0,reverse_z:!0}),this.M230(this.#Ji),this.#Qi=document.createElement("div"),this.#Qi.classList.add("PredictionSlotTitle"),this.ELEMENT.appendChild(this.#Qi);for(let i of n){const e=document.createElement("button"),s=O[i];e.innerText=s,e.dataset.id=i,e.dataset.slot_idx=t,e.classList.add("PredictionBtn"),e.classList.add("Clickable"),this.#Qi.appendChild(e),this.#Zi.set(i,e)}}M212(){this.#te=!1,this.#ie=!1,this.#ee=0,this.#se=0,this.#Ji.M170(t=>t.BACK.classList.remove("Trapped")),this.#ne(),this.#re(),this.#oe()}M23(t){t.appendChild(this.ELEMENT),t.appendChild(this.#Ji.ELEMENT)}M154(t,i,e,s,n,r,o,h){this.#Qi.style.height=Math.floor(i*li)+"px";const a=Math.min(18,.45*h|0)+"px";for(const[t,i]of this.#Zi)i.style.width=o+"px",i.style.height=h+"px",i.style.fontSize=a;this.#Ji.M31(n,r);const l=i*ci|0,c=o;this.#Ji.M160(c,l),this.M31(c,l),this.M114(t,i,e,s)}M53(t){this.#ee+=1,this.#he(t,!0)}M155(t){this.#se+=1,this.#ie=3===this.#se,this.#he(t,!1)}#he(t,i=!0){this.#Ji.M230(t,!1),this.#te=!i,t.M79(()=>{t.M121(i),this.#ae(),this.#ne(),this.#re(),this.#oe()})}#ae(){const t=this.#Ji.M142();let i=!1;for(let e=0;e<t;++e){const t=this.#Ji.M123(e);t.M144()?i=!0:i?t.BACK.classList.add("Trapped"):t.BACK.classList.remove("Trapped")}}M39(t){return t.M192()===this.#Ji&&(!!t.M108()&&(!!this.#te&&this.#Ji.M171()===t))}M96(){if(!this.#te)return null;const t=this.#se;if(0===t)return null;const i=this.#Ji.M171();if(this.#Ji.M196(i),this.#se-=1,0===this.#Ji.M142()||0===t)this.#te=!1;else{const t=this.#Ji.M171();this.#te=t.M108()}return this.#ne(),this.#re(),this.#oe(),i}#ne(){this.#ie=3===this.#se,this.#ie?this.ELEMENT.classList.add("Blocked"):this.ELEMENT.classList.remove("Blocked")}#oe(){const t=this.#ie;for(const[i,e]of this.#Zi)e.disabled=t}#re(){this.M97()?this.ELEMENT.classList.add("Completed"):this.ELEMENT.classList.remove("Completed")}M129(){return this.#ie}M24(){return this.#te}M156(){return this.#se>0}M54(){return this.#ee>0}M97(){return this.#ee>0&&!this.#te}M25(t){const i=this.#Ji.M171();return null!==i&&i.M80(t),i}},di=class extends Xt{static K57=Wt;#le=null;#ce=null;#ue=null;#de=null;#_e=null;#Me=0;#pe={position:new Array(2),status:0};#fe=null;constructor(t={}){const{on_message_request:i,V28:e=[],parent_node:n=window.document.body}=t;super(i,e),this.#fe=n,this.#me();for(const t of e)this.V32.hasOwnProperty(t);this.#ge(),this.M37(s),this.#be()}#me(){this.V32.nr_predictions=0,this.V32.nr_predictions_ok=0,this.V32.prediction_key="",this.V32.slot_idx=-1,this.V32.card_idx=-1,this.V32.success=0,this.V32.level=0,this.V32.nr_completed=0,this.V32.lst_slots_idx=null,this.V32.stones_destination=""}#ge(){const t=[[s,Qt],[n,Jt],[r,ti],[o,ii],[h,ei],[l,oi],[a,si],[c,hi],[u,ai]];for(const[i,e]of t)this.V44.set(i,new e(i,this))}M70(t,i){return super.M70(t,i),this.#we(),this.V22.ID===t}#we(){this.V32}M184(t,i,e){let s=!1;this.V48||(s=this.#ye(t)),this.#pe.position[0]=i,this.#pe.position[1]=e,this.#pe.status=s,this.M205(null,M,this.#pe)}#ye(t){if(!t.classList.contains("Clickable"))return!1;const i=t.classList;if(i.contains("CardBody")){const i=parseInt(t.dataset.idx),e=this.#le.M180(i),s=this.#xe(e);return this.V22.M95(e,s)}const e=this.#Ee(t);return"BUTTON"===t.nodeName?!t.disabled&&this.V22.M112(t,e):(i.contains("Table")||!!i.contains("DrawPile"))&&this.V22.M184(t,e)}#xe(t){const i=t.M192();return i===this.#de?1:i===this.#ue?2:0}#Ee(t){return t===this.#de.ELEMENT?1:t===this.#ue.ELEMENT?2:0}M72(t){return!Number.isInteger(t)||t<=0?(this.M205(null,MSG_APP_ERROR,"Invalid game_level: "+t),this):(this.V32.level=t,this)}M218(){for(const t of this.#ce)t.M212();const t=i.M17("seed",Date.now()%1e6,!0);this.M205(null,g,t),this.#le.M212().M168(t).M224(this.#de),this.#_e.classList.remove("Hidden"),this.V48||(this.#ve(),this.#ke()),this.V48=!1,this.M37(n)}M154(t,i,e=0){const s=Math.min(t,i),n=.03*s,r=(e||.1*s)+n,o=.03*s,h=t-n-r,a=i-2*o,l=Math.round(h/8),c=Math.round(a/5),u=Math.min(18,Math.round(.1*l))+"px",d=.75*c,_=.66*d;this.#le.M66(_,d);const M=(h-3*n)/4,p=(2*c*2-1*o)/2,f=Math.round(.9*(M>>1)),m=Math.round(.15*p*.8);let g=0,b=n,w=o;for(let t=0;t<2;++t){b=n;for(let i=0;i<4;++i){const e=this.#ce[g++];e&&(e.M154(M,p,b+i*M,t*p+w,_,d,f,m),b+=n)}w+=o}this.#ue.M31(_,d),this.#ue.M114(h-2*l,c-o,n+l,o+4*c+o),this.#de.M31(_,d),this.#de.M114(.8*l-n,c-o,n,o+4*c+o),this.#de.COUNTER.style.fontSize=u;const y=this.#_e.style;return y.bottom=o+"px",y.right=r+"px",y.width=l+"px",y.height=c-o+"px",y.fontSize=u,this}M55(t,i){return this.M51(t),this.#Le(i),this.#ce[i].M129()}M157(t){return this.M51(t),this.#de.M93()}M130(t,i,e){this.M51(t);for(const t of e)if(this.#Le(t),this.#ce[t].M39(i))return t;return-1}M56(t,i,e){this.M51(t),this.#Le(e),this.#Ce(i);const s=this.#le.M180(i);return this.#ce[e].M53(s),s}M40(t,i){this.M51(t),this.#Le(i);const e=this.#de.M93();return this.#ce[i].M155(e),e}M41(t,i){this.M51(t),this.#Ce(i);const e=this.#le.M180(i);return this.#ue.M230(e),e}M28(t,i){this.M51(t),this.#Le(i);const e=this.#Ie(i,this.V32.level);return this.#ce.filter(t=>e.includes(t.IDX)&&t.M24()).map(t=>t.IDX)}#Ie(t,i){const e=this.#ce[t],s=e.ROW,n=e.COLUMN,r=[],o=t-4,h=t+4,a=t-1,l=t+1,c=s>0,u=s<1,d=n>0,_=n<3;if(d&&r.push(a),_&&r.push(l),c&&r.push(o),u&&r.push(h),1!==i)return r;const M=o-1,p=o+1,f=h-1,m=h+1;return c&&d&&r.push(M),c&&_&&r.push(p),u&&d&&r.push(f),u&&_&&r.push(m),r}M34(t,i,e){this.M51(t);const s=this.#le.M180(this.V32.card_idx),n=e?{stones:[],prediction:[s.M44(),s.M62()]}:null;for(const t of i){const i=this.#ce[t].M25(e);e&&n.stones.push([i.M44(),i.M62()])}e?this.M205(null,p,n):this.M205(null,f,null)}M96(t,i,e){this.M51(t),this.#Le(i);const s=this.#ce[i].M96();return e===z?this.#de.M92(s):this.#ue.M230(s),s}M9(t){this.M51(t);let i=0;for(let t=0;t<this.#ce.length;++t)this.#ce[t].M97()&&(i+=1);return i}M26(t){this.M51(t);let i=0;for(let t=0;t<this.#ce.length;++t)this.#ce[t].M129()&&(i+=1);return i}M98(t){return this.M51(t),0===this.#de.M142()}M57(t){this.M51(t),this.#ve()}#ve(){this.V32.prediction_key="",this.V32.slot_idx=-1,this.V32.card_idx=-1,this.V32.lst_slots_idx=null,this.V32.stones_destination=""}#ke(){super.M70(null,{nr_predictions:0,nr_predictions_ok:0,success:0,nr_completed:0})}#Le(t){if(t<0||t>this.#ce.length-1)throw new Error("GC::AssertSlotIdx » Bad idx: "+t)}#Ce(t){if(t<0||t>this.#Me-1)throw new Error("GC::AssertCardIdx » Bad idx: "+t)}#be(){this.#Se(),this.#Ae()}#Se(){this.#le=new At({jokers:0,exclude_ranks:[7,8,9,10,11,12,13]},{velocity_px_ms:1.25,flip_time:300,visible:!1,touch_down_events:!0,smooth:!0,flip_axis:e.M61(.5)?"x":"y"}),this.#le.M170(t=>{this.#fe.appendChild(t.ELEMENT)}),this.#Me=this.#le.M181()}#Ae(){const i=this.#le.M181(),e=this.#fe;let s=0;this.#ce=[];for(let t=0;t<2;++t)for(let i=0;i<4;++i){const n=new ui(s,t,i,P[s],{parent:e,title_height:.15});this.#ce.push(n),s+=1}this.#ue=new It(s++,"Table",It.ROW,It.K138,It.K138,!0,{max_count:i,flip_after:!0,face_up:!0,sorting:St,parent:e}),this.#ue.ELEMENT.classList.add("Table"),this.#ue.ELEMENT.classList.add("Clickable"),this.#de=new Tt(s++,"DrawPile",{max_cards:i,flip_after:!1,face_up:!1,parent:e,counter_position:Tt.K32,pop_effect:!0}),this.#de.ELEMENT.classList.add("DrawPile"),this.#de.ELEMENT.classList.add("Clickable"),this.#_e=t("InGameInfo")}};import _i from"stampit";import stampit from"stampit";var Mi=stampit({props:{M113:!1,M229:null,M10:NaN},methods:{setImage(t){this.resetImage(),this.M113=!0;let i=null;"string"==typeof t?(i=new Image,i.onload=()=>{this.M229=i,this.M10=i.width/i.height},i.onerror=()=>{this.resetImage()},i.src=t):(t instanceof HTMLImageElement||t instanceof Image)&&(this.M229=t,this.M10=t.width/t.height)},getImage(){return this.M229&&this.M229.complete?this.M229:null},getImageAspectRatio(){return this.M229&&this.M229.complete?this.M10:NaN},resetImage(){this.M229=null,this.M10=NaN,this.M113=!1}}});import pi from"stampit";import{ARRAY_TYPE as fi}from"glMatrix";import{fromValues as mi,create as gi}from"vec2";var vec2={fromValues:mi,create:gi},bi=pi({methods:{validateVector(t,i=null){const e=t||i;if(!e)return vec2.create();if(!(Array.isArray(e)||e instanceof fi))throw new Error("Vector input must be an Array or glMatrix ARRAY_TYPE.");if(2!==e.length)throw new Error("Vector input must have exactly 2 elements.");if(!Number.isFinite(e[0])||!Number.isFinite(e[1]))throw new Error("Vector array must contain only numeric values.");return vec2.fromValues(e[0],e[1])}}});import{add as wi,create as yi,scaleAndAdd as xi,zero as Ei,copy as vi}from"vec2";import ki from"stampit";import Li from"stampit";var Ci=Li({methods:{makeReadOnly:function(t){if("object"!=typeof t||null===t||Array.isArray(t))return;const i={};Object.entries(t).forEach(([t,e])=>{Object.prototype.hasOwnProperty.call(this,t),i[t]={configurable:!1,writable:!1,value:e,enumerable:!0}}),Object.defineProperties(this,i)}}}),Ii={add:wi,create:yi,scaleAndAdd:xi,zero:Ei,copy:vi},Si="#FFFFFF",Ai=!0,Ni=2*Math.PI,Ti=_i({props:{M206:null},init({radius:t=3,color:i=Si,opacity:e=1,fill:s=Ai,user_data:n=null}){if(!Number.isFinite(t)||t<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(e)||e<0||e>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if("string"!=typeof i||i.length<3)throw new Error("'color' must be a valid string format ( e.g., '#FFF' or 'red' ).");this.radius=t,this.color=i,this.opacity=e,this.fill=s,this.user_data=n},methods:{render(t){if(t.save(),t.globalAlpha=this.opacity,this.M113){const i=this.getImageAspectRatio();if(Number.isFinite(i)){const e=this.getImage(),s=this.position[0],n=this.position[1],r=(e.width,e.height,this.M10,2*this.radius),o=r*i;t.drawImage(e,s-o/2,n-r/2,o,r)}}else t.beginPath(),t.arc(...this.position,this.radius,0,Ni),this.fill?(t.fillStyle=this.color,t.fill()):(t.strokeStyle=this.color,t.stroke());t.restore()},resetRender(){this.resetImage(),this.fill=Ai}}}),Di=_i({init({position:t,velocity:i}){this.position=this.validateVector(t),this.velocity=this.validateVector(i),this.acceleration=Ii.create()},methods:{applyForce(t){Ii.add(this.acceleration,this.acceleration,t)},updatePhysics(t=1){Ii.scaleAndAdd(this.velocity,this.velocity,this.acceleration,t),Ii.scaleAndAdd(this.position,this.position,this.velocity,t),Ii.zero(this.acceleration)},resetPhysics(){Ii.zero(this.position),Ii.zero(this.velocity),Ii.zero(this.acceleration)}}}),Ri=_i({props:{age:0,alive:!1},init({life:t=120}){if(!Number.isFinite(t)||t<=0)throw new Error("'life' must be a positive number.");this.life=t},methods:{updateLife(t=1){return this.age+=t,this.alive=this.age<this.life,this.alive},resetLife(){this.age=0,this.alive=!1}}}),Oi=_i({methods:{config(t={}){if(this.opacity=(t.opacity??this.opacity)||1,this.radius=(t.radius??this.radius)||3,this.color=(t.color??this.color)||Si,this.life=(t.life??this.life)||120,this.fill=t.fill??Ai,t.position&&Ii.copy(this.position,this.validateVector(t.position)),t.velocity&&Ii.copy(this.velocity,this.validateVector(t.velocity)),!Number.isFinite(this.radius)||this.radius<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(this.opacity)||this.opacity<0||this.opacity>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if(!Number.isFinite(this.life)||this.life<=0)throw new Error("'life' must be a positive number.")}}}),Pi=_i().compose(bi,Mi,Ti,Di,Ri,Oi,_i({methods:{reset(){this.resetRender(),this.resetPhysics(),this.resetLife()}}})),Bi=ki({init({object_stamp:t,pool_size:i=1e3}){if("function"!=typeof t)throw new Error("'object_stamp' must be a constructor function ( a stamp or factory ).");if(!Number.isInteger(i)||i<=0)throw new Error("'pool_size' must be a positive integer.");this.makeReadOnly({pool_size:i,object_stamp:t})}}),Vi=ki({init(t,{instance:i}){const e=new Array(this.pool_size);let s=0;const n=new WeakMap;for(let t=0;t<this.pool_size;t++){const i=this.object_stamp();i.reset(),e[t]=i}i._setIndex=function(t,i){n.set(t,i)},i.get=function(){if(s>=this.pool_size)return null;const t=e[s];return n.set(t,s),s++,t},i.free=function(t){const i=n.get(t);if(void 0===i||i>=s)return!1;s--;const r=e[s];return e[s]=t,e[i]=r,t!==r&&n.set(r,i),t.reset(),n.delete(t),!0},i.getActiveCount=function(){return s},i._getPoolArray=function(){return e}}}),Ki=ki({methods:{M170:function(t){const i=this._getPoolArray();let e=0;for(;e<this.getActiveCount();){const s=i[e];this._setIndex(s,e),!1!==t(s)?e++:this.free(s)}},M207:function(t){this._getPoolArray().forEach(i=>t(i))}}}),Fi=ki().compose(Ci,Bi,Vi,Ki);import{fromValues as zi,copy as Ui,random as Gi,create as ji}from"vec2";var Hi={fromValues:zi,copy:Ui,random:Gi,create:ji},qi=Hi.create(),$i="xtq{sf2uqf~",Solvna=class{#Ne=null;#Te=!1;#De=null;#Re=-1;#fe=null;V33=null;V36=0;V45=0;#fi=!1;#Oe=null;#Pe=null;#Be=0;#Ve=null;#Ke=null;#Fe=null;#ze=null;#Ue=0;#Ge=0;#je=null;constructor(t){this.#Re=this.#He(),this.#Ne=new $t({game_name:"SOLVNA",game_designer:"Jean-Baptiste Lévêque",game_build:t,start_page:i.M17("page",Ht),page_mode:$t.K121,on_resize:this.M154.bind(this),on_click:this.M184.bind(this),on_page:this.M208.bind(this),counter:$i,settings:{prefix:"solvna",schema:[{id:"game_level",label:"Game level",type:"radio",options:["Easy","Normal","Hard"],default:1}]}}),this.#fe=this.#Ne.M183(qt),this.#Be=this.#Ne.M110,this.#fi=this.#Ne.M94(),this.#qe(),this.#$e(),this.#We(),this.#Xe()}M154(t,i,e){this.#De.M154(t,i,e),this.#Ve.width=t,this.#Ve.height=i,this.#Ke.width=t,this.#Ke.height=i,this.#Be=e}M184(t,e,s){this.#Te&&(i.M58||this.#fi)&&this.#De.M184(t,e,s)}M208(t,i){const e=this.#Te;this.#Te=t===qt,this.#Te&&(this.#Ne.M151(),e||window.requestAnimationFrame(this.#Ye.bind(this)),i&&this.#Qe())}M158(i,e){switch(i){default:return;case di.K57:let i=e.value;Number.isFinite(i)&&!Number.isInteger(i)&&(i=Math.round(i)),this.#Je(e.key,i);break;case g:const s=t("deck_seed");s&&(s.value=e);break;case _:break;case M:this.#Ze(e.position,e.status);break;case p:this.#ts(e);break;case f:this.#je=null;break;case m:this.#Ne.M111($i,e?"up":"down"),this.#Ue=e?1:-1}}async#Xe(){await this.#Ne.M126("./assets/theme-2.svg","card-sprite-sheet")}#Qe(){this.#Ne.M151(!1),this.#Ue=0,this.#De.M218(),i.M58||this.#Ne.M50("xtq{sf2uqf~")}#$e(){this.#De=new di({on_message_request:(t,i)=>this.M158(t,i),V28:["nr_predictions","nr_predictions_ok","success","nr_completed"],parent_node:this.#Ne.M183(qt)}),this.#De.M154(this.#Ne.M216,this.#Ne.M204).M72(this.#Re)}#We(){this.#Oe=Hi.create(),this.#Ge=0;const t=document.createElement("canvas");t.id="canvas_clicks",t.width=window.innerWidth,t.height=window.innerHeight,t.style.zIndex=200,this.#fe.appendChild(t);const i=document.createElement("canvas");i.id="canvas_particles",i.width=window.innerWidth,i.height=window.innerHeight,i.style.zIndex=100,this.#fe.appendChild(i),this.#ze=t.getContext("2d"),this.#Fe=i.getContext("2d"),this.#Ke=t,this.#Ve=i,this.#Pe=Fi({object_stamp:Pi,pool_size:1e4}),this.#Pe.M207(t=>{t.user_data={click:!0}})}#Ye(t){this.#Te&&(this.#Ge,this.#Ge=t,this.#Pe.M170(t=>{if(!t.updateLife())return t.user_data.click=!0,!1}),null!==this.#je&&this.#is(),this.#ze.clearRect(0,0,window.innerWidth,window.innerHeight),this.#Fe.clearRect(0,0,window.innerWidth,window.innerHeight),this.#Pe.M170(t=>{t.opacity=e.M164(t.age,t.life,5),t.updatePhysics();const i=t.user_data.click;i&&(t.radius*=1.05),t.render(i?this.#ze:this.#Fe)}),0!==this.#Ue&&this.M159(this.#Fe,1===this.#Ue?"SUCCESS":"YOU LOST",this.#Be),window.requestAnimationFrame(this.#Ye.bind(this)))}#is(){const t=this.#je;for(const i of t.stones)for(let t=0;t<5;++t)this.#es(i)}#es(t,i=!0){const s=this.#Pe.get();if(!s)return;let n=i?"hsl("+e.M115(40,60)+", 100%, 50%)":"white";s.config({position:t,velocity:Hi.random(this.#Oe,1),color:n,life:60*e.M76(1,3),radius:e.M76(1,3),opacity:1,fill:!0}),s.user_data.click=!1}#He(){let t=i.M17("level",2,!0);return[1,2,3].includes(t)||(t=2),t}#qe(){t("level").innerHTML=F[this.#Re],t("nr_slots").innerHTML=8}#ts(t){this.#je={stones:[...t.stones],prediction:t.prediction}}#Ze(t,i){if(i)return;const e=this.#Pe.get();e&&(e.config({position:t,velocity:qi,color:i?"lime":"darkorange",life:i?60:30,radius:10,opacity:1,fill:!i}),e.user_data.click=!0)}#Je(i,e){const s=t(i);s&&(s.innerText=e)}M159(t,i="",e=0){const s=t.canvas.width-e,n=t.canvas.height,r=Math.floor(.18*s);t.font="bold "+r+"px card-game",t.fillStyle="rgba( 100, 149, 237, 0.50 )",t.textAlign="center",t.textBaseline="middle",t.fillText(i,s/2,n/2)}};export{Solvna};