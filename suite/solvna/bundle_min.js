// Build: January 31 2026 23:49

export const BUNDLE_URL = import.meta.url.split( '/' ).pop();

export const BUNDLE_ID = "2026-0131-2349";

function t(t){return document.getElementById(t)}class i{static get M57(){return window.location.href.includes("nighthawk.home")}static get M72(){return screen.orientation&&screen.orientation.type?screen.orientation.type.includes("landscape"):window.innerWidth>window.innerHeight}static get M128(){return navigator.maxTouchPoints>0}static get M98(){return navigator.userAgentData&&"Android"===navigator.userAgentData.platform||/android/i.test(navigator.userAgent)}static get M42(){const t=window.matchMedia("(display-mode: standalone)").matches,i=!0===window.navigator.standalone;return t||i}static get M184(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||/Mac/.test(navigator.userAgent)&&navigator.maxTouchPoints>1}static M5(t,i,s){Object.defineProperty(t,i,{value:s,writable:!1,enumerable:!0,configurable:!1})}static M11(t,i){if(!Array.isArray(t))return;const s=t.indexOf(i);-1!==s&&t.splice(s,1)}static M12(t){if(!Array.isArray(t))return t;for(let i=t.length-1;i>0;i--){const s=Math.floor(Math.random()*(i+1));[t[i],t[s]]=[t[s],t[i]]}return t}static M27(t){return function(){let i=t+=1831565813;return i=Math.imul(i^i>>>15,1|i),i^=i+Math.imul(i^i>>>7,61|i),((i^i>>>14)>>>0)/4294967296}}static M99(t){let i=0;for(let s=0;s<t.length;s++)i=(i<<5)-i+t.charCodeAt(s),i|=0;return i}static M17(t,i=null,s=!1){let e=new URLSearchParams(window.location.search).get(t);if(null===e)return i;if(s){const t=parseInt(e,10);return isNaN(t)?i:t}return e}static M73(t,i=document.documentElement,s=null){t.startsWith("--")||(t="--"+t);const e=window.getComputedStyle(i).getPropertyValue(t).trim();return""===e?s:e.replace(/^['"]|['"]$/g,"")}static M18(){if(i.M184)return;const t=document.documentElement,s=t.requestFullscreen||t.webkitRequestFullscreen;if(!s)return;const e=i.M98?{navigationUI:"hide"}:{};s.call(t,e).catch(t=>{})}static M19(t){const i=document.querySelector('script[type="importmap"]');if(!i)throw new Error('GetImportMapValue » <script type="importmap"> not found in DOM.');const s=JSON.parse(i.textContent),e=s.imports?.[t];if(void 0===e)throw new Error("GetImportMapValue » Key not found in imports: "+t);return e}static M58(t,i=0){if("string"!=typeof t)return t;let s="";for(let e=0;e<t.length;e++){const n=t.charCodeAt(e);s+=String.fromCharCode(n+i)}return s}static M157(t,i,s){const e=t.style;e.width=i+"px",e.height=s+"px"}static M112(t,i,s,e,n){const r=t.style;r.width=i+"px",r.height=s+"px",r.left=e+"px",r.top=n+"px"}}class s{static get M185(){return(1+Math.sqrt(5))/2}static get M186(){return 2*Math.PI}static get M158(){return Math.PI/2}static get M74(){return Math.PI/180}static get M59(){return 180/Math.PI}static M159(t){return t*s.M74}static M160(t){return t*s.M59}static M113(t,i){return Math.floor(Math.random()*(i-t+1))+t}static M75(t,i){return t+Math.random()*(i-t)}static M60(t=.5){return Math.random()<t}static M29(t){return function(){let i=t+=1831565813;return i=Math.imul(i^i>>>15,1|i),i^=i+Math.imul(i^i>>>7,61|i),((i^i>>>14)>>>0)/4294967296}}static M215(t,i,s){return t+(i-t)*s}static M205(t,i,s,e,n){return e+(t-i)*(n-e)/(s-i)}static M206(t,i,s){return Math.max(i,Math.min(t,s))}static M129(t,i,s,e){return Math.hypot(s-t,e-i)}static M161(t,i,s=2){if(i<=0)return 0;const e=t/i;return 1-Math.pow(e,s)}}var e="busy",n="predict",r="eval",h="eval_ok",o="eval_nk",a="turn_ended",l="rm_stones",c="success",u="fail",d="user_error",_="ui_choice",M="ui_click",p="MSG_STONES_ON",f="MSG_STONES_OFF",m="MSG_GAME_OVER",g="deck_seed",b="R",w="RO",y="BE",x="E",E="D",v="H",k="S",L="C",C="O",I="BO",A="RE",S="B",T=w,N=y,D=I,O=A,R={[b]:"Red",[w]:"Red Odd",[y]:"Black Even",[x]:"Even",[E]:"Diamonds",[v]:"Hearts",[k]:"Spades",[L]:"Clubs",[C]:"Odd",[I]:"Black Odd",[A]:"Red Even",[S]:"Black"},B=[["R"],[w,y],["E"],["D","H"],["S","C"],["O"],[I,A],["B"]],P=1,V=2,K=3,F={[P]:"Easy",[V]:"Normal",[K]:"Hard"},z="DECK",U="TABLE",j=Object.defineProperty,G=class t{static K136=100;static K140=199;static K20=100;#t=0;#i=0;#s=100;#e=-1;#n=0;#r=0;#h=null;#o=null;#a=!1;#l=0;#c=0;#u=0;#d=0;#_=0;#M=0;#p=!1;#f=[];#m=!0;#g=!1;constructor(s,e,n=!1,r=0,h={}){i.M5(this,"IDX",s),i.M5(this,"ID",e);const{parent:o=null,is_box:a=!1}=h;i.M5(this,"IS_BOX",a),this.#l=r||t.K20,!0===n?this.#h=document.createElement("div"):n instanceof Node&&(this.#h=n),this.#h&&(this.#b(),o instanceof Node&&o.appendChild(this.#h))}#b(){i.M5(this,"ELEMENT",this.#h),this.#h.id=this.ID,this.#h.style.position="absolute",this.#h.style.top="0px",this.#h.style.left="0px",this.#h.style.zIndex=this.#s,this.#h.classList.add("FlexBoxEntity"),this.#h.dataset.smooth=this.#a?"yes":"no",this.#h.addEventListener("transitionend",this.#w.bind(this))}M162(){return this.#h&&(this.#h.remove(),this.#h=null,this.#f=null),this}M76(){return this.#h.offsetWidth,this}M100(){return this.#h}M130(){return this.#n}M114(){return this.#r}M187(){return this.#t}M163(){return this.#i}M112(t,i,s,e){this.#n=0|t,this.#r=0|i,e|=0,s|=0;const n=this.#t!==e||this.#i!==s;return n&&(this.#t=e,this.#i=s),this.#y(n),this}#x(){const t=window.getComputedStyle(this.#h).translate;t&&"none"!==t||(this.#u=0,this.#c=0);const i=t.split(" ");this.#u=parseFloat(i[0])||0,this.#c=parseFloat(i[1])||0}M77(t,i){if(t|=0,i|=0,this.#t===i&&this.#i===t)return this;if(this.#a){const s=this.M1(t,i);this.#E(s)}return this.#t=i,this.#i=t,this.#y(!0),this}M1(t,i){this.#x();const s=t-this.#u,e=i-this.#c;return Math.sqrt(s*s+e*e)/this.#l}M157(t,i){return t|=0,i|=0,this.#n===t&&this.#r===i||(this.#n=t,this.#r=i,this.#y(!1)),this}#y(t=!0){this.#v();const i=this.#h.style;i.width=this.#n+"px",i.height=this.#r+"px",t?(i.translate=this.#i+"px "+this.#t+"px 0px",this.#a&&(i.zIndex=199+this.#e)):i.zIndex=this.#s}#w(t){"translate"===t.propertyName&&(this.#x(),Math.abs(this.#u-this.#i)<1&&Math.abs(this.#c-this.#t)<1&&(this.#h.style.zIndex=this.#s,this.#p&&this.#k()))}M43(){return this.#M>0}M131(){return this.#M>0}M132(){return this.#M>0}#k(){const t=this.#f.length;for(let i=0;i<t;i++)this.#f[i](this);this.#f.length=0}M115(t=!0){return this.#a=!!t,this.#h.dataset.smooth=this.#a?"yes":"no",this}M133(){return this.#a}M78(t){return"function"!=typeof t?this:this.#p?(this.#f.push(t),this):void 0}M6(){this.#f.length=0}M13(t=!0){return this.#p=!!t,this}Error(t,i,...s){this.constructor.name,s.length>0&&s.forEach((t,i)=>{})}M116(){return this.#e}M117(t=-1){return this.#e=t,this}M188(t,i=-1){return null!==this.#o?(this.Error("SetBox","Already set",this.#o,t),this):(this.#o=t,i>=0&&(this.#e=i),this)}M134(){return this.#o=null,this.#e=-1,this}M189(){return this.#o}M216(t){return this.#o===t}M190(){return null!==this.#o}#E(t){return!Number.isFinite(t)||t<0?(this.Error("SetTranslationTime","Bad number",t),this):this.#h?(this.#h.style.transitionDuration=t+"ms",this):this}M30(i=0){return this.#l=i||t.K20,this}M217(t){return t|=0,this.#s===t||(this.#s=t,this.#h.style.zIndex=t),this}M135(t){return!Number.isFinite(t)||t<0?(this.Error("SetBaseZ","Bad number",t),this):(t|=0,this.#s<t&&(this.#s=t),this.#h.style.zIndex=t,this)}#v(){this.#d=this.#t+(this.#r>>1),this.#_=this.#i+(this.#n>>1)}M61(){return this.#d}M44(){return this.#_}M4(t,i){const s=t-this.#i,e=i-this.#t;return Math.sqrt(s*s+e*e)/this.#l}M118(){return this.#m}M136(){return!this.#m}M101(t=!0){return t=!!t,this.#m===t||(this.#m=t,this.M15(t)),this}M45(){return this.#m=!this.#m,this.M15(this.#m),this}M102(){return this.#g}M79(t=!0){return t=!!t,this.#g===t||(this.#g=t,this.M20(t)),this}M35(){return this.#g=!this.#g,this.M20(this.#g),this}},H=1/0,q=class extends G{static ROW=11;static COLUMN=12;static K137=3;static K141=1;static K148=2;static K138=4;static K131=5;static K139=6;static K142=7;#L=11;#C=!0;#I=[];#A=null;#S=null;#T=null;#N=H;#D=0;#O=0;#R=0;#B=0;#P=!1;#V=0;#K=0;#F=!1;#z=0;#U=0;#j=G.K136;#G=null;#H=null;#q=null;#W=null;#X=!1;#Y=0;#Q=!1;constructor(t,i,s,e,n,r=!1,h={}){const{max_count:o=H,sorting:a=null,tuck:l=!1,uniform:c=!1,parent:u=null,velocity_px_ms:d=0,reverse_z:_=!1}=h;super(t,i,r,d,{is_box:!0,parent:u}),this.#N=o,this.M80(_),this.#L=s,11!==s&&12!==s&&this.Error("FlexBox","Bad orientation",s),this.#C=11===this.#L,"function"==typeof a&&(this.#A=a);const M=Number.isFinite(this.#N)?this.#N:64;this.#G=new Int32Array(M),this.#H=new Int32Array(M),e=e||4,this.#T=this.#$(e),3!==(n=n||3)&&1!==n&&2!==n&&this.Error("FlexBox","Bad align",n),this.#S=this.#$(n),this.#F=c,l>0&&this.M164(l),this.ELEMENT&&this.ELEMENT.classList.add("FlexBox")}M162(){super.M162(),this.#I=null,this.#S=null,this.#T=null,this.#A=null}#J(t,i){if(t.length<i){const s=t.length<<1;t=new Int32Array(s>i?s:i)}return t}M225(t,i=!0){if(!(t instanceof G))return this.Error("Add","Not a FlexBoxEntity",t),this;if(this.#I.includes(t))return this.Error("Add","Already here",t),this;if(this.M194())return this.Error("Add","I am full",t),this;t.M190()&&t.M189().M193(t),i?this.#I.push(t):this.#I.unshift(t);const s=this.#I.length;let e=!i&&s>1;return t.M188(this,i?this.#I.length-1:0),this.#J(this.#G,s),this.#J(this.#H,s),null!==this.#A&&(this.#I.sort(this.#A),e=!0),e&&this.#Z(),this.#F?(0!==this.#z&&0!=this.#U||(this.#z=t.M130(),this.#U=t.M114(),this.#X>0&&this.#tt()),this.#V+=this.#z,this.#K+=this.#U):(this.#V+=t.M130(),this.#K+=t.M114()),this.#P=!0,this.M7(),this}M191(t){return this.M225(t,!1)}M192(t){return this.M225(t,!0)}M193(t){return t instanceof G?this.#I.includes(t)?(t.M134(),t.M6(),i.M11(this.#I,t),this.#Z(),this.#F?(this.#V-=this.#z,this.#K-=this.#U):(this.#V-=t.M130(),this.#K-=t.M114()),this.#P=!0,this.M7(),this):(this.Error("Remove","Not here",t.ID),this):(this.Error("Remove","Not a FlexBoxEntity",t),this)}M157(t,i){t|=0,i|=0,super.M157(t,i),this.#D=t,this.#O=i}M112(t,i,s,e,n=!0){return t|=0,i|=0,s|=0,e|=0,super.M112(t,i,s,e),this.#D=t,this.#O=i,this.#B=s,this.#R=e,n&&this.M7(),this}M31(t,i,s=-1){return this.#z=0|t,this.#U=0|i,this.#X>0&&this.#tt(),this.#F=!0,this.#P=!1,s>=0&&(this.#j=s),this.M14(),this}M80(t=!0){this.#Q=!!t,this.M7()}M32(t=-1){t>=0&&(this.#j=0|t)}M14(){let t=0,i=0;const s=this.#I.length;if(s>0){if(this.#F){if(0===this.#z||0===this.#U){const t=this.#I[0];this.#z=t.M130(),this.#U=t.M114(),this.#X>0&&this.#tt()}t=s*this.#z,i=s*this.#U}else for(let e,n=0;n<s;n++)e=this.#I[n],t+=e.M130(),i+=e.M114();(isNaN(t)||isNaN(i))&&this.Error("UpdateEntitiesSize","total width/height is NaN"),(t<0||i<0)&&this.Error("UpdateEntitiesSize","total width/height is negative",t,i)}return this.#V=t,this.#K=i,this.#P=!0,this}#it(t=-1){if(-1===t&&(t=this.#I.length),0===t)return this;this.#P||this.M14();const i=this.#C;let s=i?this.#V:this.#K,e=this.#X&&t>1;if(e){const n=i?this.#D:this.#O;e=s>n,e&&(this.#st(t,n,s),s-=(t-1)*this.#Y)}return i?(this.#q=this.#T(!0,!0,s,t),this.#W=this.#S(!1,!1,this.#K,t)):(this.#W=this.#T(!0,!1,s,t),this.#q=this.#S(!1,!0,this.#V,t)),e&&this.#et(i,t),t}#st(t,i,s){this.#C?this.#z:this.#U;const e=(s-i)/(t-1);this.#Y=e}#et(t,i){const s=t?this.#q:this.#W;for(let t=1;t<i;t++)s[t]-=t*this.#Y}M164(t=!0){this.#X=!!t,this.#X&&this.M7()}M137(t){return this.#F||0===t?t<0||t>1?(this.Error("SetTuck","Tuck must be [ 0 .. 1 ]",t),this):(this.#X=t,this.#tt(),void(this.#I.length>1&&this.M7())):(this.Error("SetTuck","Cannot tuck non-uniform entities"),this)}#tt(){if(!this.#F)return void(this.#Y=0);const t=this.#C?this.#z:this.#U;this.#Y=t*this.#X|0}M77(t,i){super.M77(t,i),this.#B=t,this.#R=i}M7(t=!0){const i=this.#I.length;if(0===i)return this;t&&this.#it(i);const s=this.#j;for(let t=0;t<i;t++){const e=this.#I[t];this.#Q?e.M217(s+(i-t)):e.M217(s+t),e.M77(this.#q[t],this.#W[t]),e.IS_BOX&&e.M7(!0)}return this}#nt(t,i=-1){if(i<0&&(i=t.M116()),this.#Q){const s=this.#I.length;t.M217(this.#j+(s-i))}else t.M217(this.#j+i);return t.M77(this.#q[i],this.#W[i]),this}#$(t){switch(t){case 3:return this.#rt.bind(this);case 1:return this.#ht.bind(this);case 2:return this.#ot.bind(this);case 4:return this.#at.bind(this);case 5:return this.#lt.bind(this);case 6:return this.#ct.bind(this);case 7:return this.#ut.bind(this)}}#dt(t,i,s){const e=(t?this.#G:this.#H).subarray(0,s),n=i?this.#B:this.#R;var r=i?this.#z:this.#U;if(t&&this.#F)for(var h=0;h<s;++h)e[h]=n+h*r;else{var o=n;for(h=0;h<s;++h){if(t&&h>0){if(!this.#F){const t=this.#I[h-1];r=i?t.M130():t.M114()}o+=r}e[h]=o}}return e}#ht(t,i,s,e){return this.#dt(t,i,e)}#rt(t,i,s,e){const n=this.#dt(t,i,e),r=i?this.#D:this.#O,h=r-s>>1;var o=i?this.#z:this.#U;if(!t&&this.#F){const t=r-o>>1;for(var a=0;a<e;++a)n[a]+=t}else for(a=0;a<e;++a)if(t)n[a]+=h;else{if(!this.#F){const t=this.#I[a];o=i?t.M130():t.M114()}n[a]+=r-o>>1}return n}#ot(t,i,s,e){const n=this.#dt(t,i,e),r=i?this.#D:this.#O,h=Math.round(r-s);var o=i?this.#z:this.#U;if(!t&&this.#F){const t=r-o;for(var a=0;a<e;++a)n[a]+=t}else for(a=0;a<e;++a)if(t)n[a]+=h;else{if(!this.#F){const t=this.#I[a];o=i?t.M130():t.M114()}n[a]+=r-o}return n}#ut(t,i,s,e){const n=this.#dt(t,i,e),r=(i?this.#D:this.#O)>>1;var h=i?this.#z:this.#U;const o=n[0];for(var a=0;a<e;++a){if(!this.#F){const t=this.#I[a];h=i?t.M130():t.M114()}n[a]=o+r-(h>>1)}return n}#lt(t,i,s,e){if(e<2)return this.#ht(t,i,s,e);const n=this.#dt(t,i,e),r=i?this.#D:this.#O,h=Math.round((r-s)/(e-1));for(var o=1;o<e;++o)n[o]+=o*h;return n}#at(t,i,s,e){const n=this.#dt(t,i,e),r=i?this.#D:this.#O,h=Math.round((r-s)/(e+1));for(let t=0;t<e;++t)n[t]+=(t+1)*h;return n}#ct(t,i,s,e){if(e<2)return this.#rt(t,i,s,e);const n=this.#dt(t,i,e),r=((i?this.#D:this.#O)-s)/e,h=r>>1;for(let t=0;t<e;++t)n[t]+=h+t*r|0;return n}M81(t){return!Number.isFinite(t)||t<=0?(this.Error("SetMaxCount","Bad number",t),this):(this.#N=0|t,this)}M82(){return this.#N}M194(){return this.#I.length>=this.#N}M103(t){return"function"!=typeof t||(this.#A=t),this}M104(t){return this.#T=this.#$(t||4),this}M218(t){return"function"!=typeof t&&(t=this.#A),"function"!=typeof t||(this.#I.sort(t),this.#Z(),this.M7()),this}#Z(t=-1){if(t<0&&(t=this.#I.length),!(t<0))for(let i=0;i<t;++i)this.#I[i].M117(i)}M165(){const t=this.#I.length;return t<=1||(M12(this.#I),this.#Z(t),this.M7()),this}M166(){return 0===this.#I.length}M138(t){return this.#I.includes(t)}M139(){return this.#I.length}M167(t){if("function"!=typeof t)return this;const i=this.#I.length;for(let s,e=0;e<i;e++)s=this.#I[e],t(s);return this}M168(){return this.#I.length>0?this.#I[0]:null}M105(){if(this.#I.length<=0)return null;const t=this.#I[0];return this.M193(t),t}M169(){const t=this.#I.length;return t>0?this.#I[t-1]:null}M106(){const t=this.#I.length;if(t<=0)return null;const i=this.#I[t-1];return this.M193(i),i}M83(t){return t<0||t>=this.#I.length?(this.Error("GetEntityAt","Bad idx",t),null):this.#I[t]}M195(){return[...this.#I]}M84(t){return"function"!=typeof t?null:this.#I.filter(t)}M207(){const t=this.#I.length;if(0===t)return this;for(let i=0;i<t;i++){const t=this.#I[i];t.M134(),t.M6()}return this.#I.length=0,this.#V=0,this.#K=0,this.#P=!0,this}#_t(t=0){const i=this.#I.length+t;return i>this.#N?(this.Error("#PrepareBatchAdd","Total exceeds max_count",i),this):(i>0&&(this.#G=this.#J(this.#G,i),this.#H=this.#J(this.#H,i)),this)}M140(t,i=!0,s=0){const e=t.length;if(0===e)return this;if(this.M194())return this.Error("BatchAdd","I am full"),this;const n=this.M139()+e;if(n>this.M82())return this.Error("BatchAdd","Not enough space"),this;for(let i=0;i<e;i++){const s=t[i];if(!(s instanceof G))return this.Error("BatchAdd","Not a FlexBoxEntity",s),this;if(this.#I.includes(s))return this.Error("BatchAdd","Already here",s),this}const r=[...this.#I],h=r.length;this.#_t(e);for(let s=0;s<e;s++){const e=t[s];e.M190()&&e.M189().M193(e),e.M188(this),i?this.#I.push(e):this.#I.unshift(e);const n=this.#F?this.#z:e.M130(),r=this.#F?this.#U:e.M114();this.#V+=n,this.#K+=r}this.#P=!0,null!==this.#A&&this.#I.sort(this.#A),this.#Z(n),this.#it(n);for(let t=0;t<h;t++){const i=r[t];this.#nt(i)}if(0===s)for(let i=0;i<e;i++){const s=t[i];this.#nt(s)}else{let i=s;s<=1&&(i=this.M2(t[0])*s);let n=0;for(let s=0;s<e;s++){const e=t[s];setTimeout(()=>{this.#nt(e)},n),n+=i}}return this}M85(t=null,s=0){const e=null===t?[...this.#I]:t,n=e.length;if(0===n)return this;for(let t=0;t<n;t++){const i=e[t];if(!(i instanceof G))return this.Error("BatchRemove","Not a FlexBoxEntity",i),this;if(!this.#I.includes(i))return this.Error("BatchRemove","Not here",i),this}for(let t=n-1;t>=0;t--){const s=e[t];i.M11(this.#I,s),s.M134(),s.M6();const n=this.#F?this.#z:s.M130(),r=this.#F?this.#U:s.M114();this.#V-=n,this.#K-=r}this.#P=!0;const r=this.#I,h=r.length;if(this.#Z(h),this.#it(h),0===s)this.M7(!1);else{let t=s;s<=1&&(t=this.M2(r[0])*s);let i=t;for(let s=0;s<h;s++){const e=r[s];setTimeout(()=>this.#nt(e),i),i+=t}}return this}M2(t){if(!t.M216(this))return this.Error("GetEntityTranslationTime","Not here",t),0;const i=t.M116();return i<0||i>=this.#I.length?(this.Error("GetEntityTranslationTime","Bad index",t),0):t.M1(this.#q[i],this.#W[i])}M3(t){return t.EstimateTravelTime(this.M44(),this.M61())}M170(t=""){for(let t=0;t<this.#I.length;++t)this.#I[t];return!0}},W={smooth:!0,touch_down_events:!1,velocity_px_ms:.5,visible:!1,selected:!1,flip_time:500,face_up:!0,flip_axis:"y"},X=class t extends G{static K136=110;#Mt=null;#pt=null;#ft=null;#mt=W.face_up;constructor(t){super(t,"Card_"+t,!0),this.#gt(t),i.M5(this,"BODY",this.#Mt),i.M5(this,"FACE",this.#pt),i.M5(this,"BACK",this.#ft),this.M208()}M162(){super.M162()}M208(i={}){for(const t in W){const s=i[t]??W[t];i[t]=s}this.M190()&&this.M189().M193(this),this.M6(),this.M115(i.smooth),this.M13(i.touch_down_events),this.M30(i.velocity_px_ms),this.M101(i.visible),this.M79(i.selected),this.M217(t.K136),this.M86(i.flip_time),this.M119(i.face_up),this.M87(i.flip_axis)}#gt(i){this.ELEMENT.classList.add("Card"),this.#Mt=document.createElement("div"),this.#Mt.classList.add("CardBody"),this.#Mt.classList.add("Clickable"),this.#Mt.dataset.idx=i,this.#Mt.card=this,this.#Mt.dataset.face=this.#mt?"up":"no",this.#Mt.dataset.visible=this.M118()?"yes":"no",this.#pt=document.createElement("div"),this.#pt.classList.add("CardFace"),this.#ft=document.createElement("div"),this.#ft.classList.add("CardBack"),this.#Mt.appendChild(this.#pt),this.#Mt.appendChild(this.#ft),this.ELEMENT.appendChild(this.#Mt),this.M135(t.K136)}M8(){return this.#Mt}M119(t=!0){return this.#mt=!!t,this.#Mt.dataset.face=this.#mt?"up":"down",this.OnFlip&&this.OnFlip(t),this}M141(){return this.#mt}M107(){return!this.#mt}M15(t){return this.#Mt.dataset.visible=t?"yes":"no",this}M20(t){return this.#Mt.dataset.selected=t?"yes":"no",this}M86(t){return!Number.isFinite(t)||t<0?(this.Error("SetFlipTime","Bad number",t),this):(this.#Mt.style.transitionDuration=t+"ms",this)}M87(t="x"){if("string"!=typeof t||1!==t.length)return this.Error("SetFlipAxis","Bad axis",t),this;if("x"!==(t=t.toLowerCase())&&"y"!==t)return this.Error("SetFlipAxis","Bad axis",t),this;const i="x"===t?"1":"0",s="y"===t?"1":"0";return this.#Mt.style.setProperty("--ROT_X",i),this.#Mt.style.setProperty("--ROT_Y",s),this}M219(){return this.#mt=!this.#mt,this.#Mt.dataset.face=this.#mt?"up":"down",this.OnFlip&&this.OnFlip(this),this}},Y={};((t,i)=>{for(var s in i)j(t,s,{get:i[s],enumerable:!0})})(Y,{K68:()=>nt,K69:()=>ht,K115:()=>rt,K89:()=>_t,K90:()=>Et,K91:()=>et,K116:()=>it,K117:()=>st,K21:()=>wt,K22:()=>bt,K126:()=>pt,K118:()=>ft,K92:()=>Mt,K119:()=>gt,K93:()=>yt,K94:()=>mt,K55:()=>xt,K70:()=>J,K71:()=>Z,K95:()=>Q,K23:()=>tt,K96:()=>$,K143:()=>ut,K97:()=>ot,K31:()=>at,K72:()=>ct,K98:()=>dt,K73:()=>lt});var Q=0,$=6,J=10,Z=14,tt=15,it=63,st=15,et=15,nt=1<<J,rt=2<<J,ht={[nt]:"Black",[rt]:"Red"},ot=1<<$,at=2<<$,lt=3<<$,ct=4<<$,ut=[ot,at,lt,ct].sort(),dt={[ot]:"Clubs",[at]:"Diamonds",[ct]:"Hearts",[lt]:"Spades"},_t=1<<Z,Mt=0,pt=1,ft=11,mt=12,gt=13,bt=Math.min(ft,mt,gt),wt=Math.max(ft,mt,gt),yt={[pt]:"Ace",[ft]:"Jack",[mt]:"Queen",[gt]:"King"},xt={[pt]:"A",[ft]:"J",[mt]:"Q",[gt]:"K"},Et={name:"Joker",suit:"joker",symbol:"JKR",rank:Mt,flag:_t},vt=class extends X{#bt=!1;#wt=!1;#yt=null;constructor(t,s){super(t),i.M5(this,"DNA",s);const e=s&it,n=s&st<<$,r=s&et<<J;i.M5(this,"RANK",e),i.M5(this,"SUIT",n),i.M5(this,"COLOR",r),this.#bt=0!==(s&_t),this.#wt=!this.#bt&&this.RANK>=bt&&this.RANK<=wt,this.#xt(),this.#Et()}M142(){return"("+this.IDX+") "+this.M88()+" of "+this.M89()}#xt(){const t=this.M88().toLowerCase(),i=this.M89().toLowerCase(),s=this.M209()?"red":"black",e=this.BODY;e.dataset.rank=t,e.dataset.suit=i,e.dataset.color=s,this.#bt?e.dataset.joker="yes":this.#wt&&(e.dataset.royal="yes")}#Et(){const t=this.M47().toUpperCase(),i=this.M89();this.FACE.innerHTML="";const s=document.createElement("p");s.innerText=t,this.#yt=s,this.#wt&&this.M46(this.RANK),this.FACE.appendChild(this.#yt);{const t=this.#vt(i.toLowerCase());this.FACE.appendChild(t)}}M46(t){const i=document.createElement("span");i.innerText=t,this.#yt.appendChild(i)}#vt(t){this.M209();const i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("class","SuitIcon"),i.innerHTML=`<use href="#suit-${t}"/>`,i}M157(t,i){super.M157(t,i),this.FACE.style.fontSize=Math.round(.4*t)+"px"}static async M120(t){try{const i=M19("flex-box/"),s=await fetch(i+t),e=await s.text(),n=document.getElementById("card-sprite-sheet");n&&n.remove();const r=document.createElement("div");r.id="card-sprite-sheet",r.style.display="none",r.innerHTML=e,document.body.appendChild(r)}catch(t){}}M209(){return this.COLOR===rt}M171(){return this.COLOR===nt}M172(){return this.#bt}M173(){return this.#wt}M143(){return!this.#bt&&!this.#wt}M210(){return this.RANK===pt}M196(){return this.RANK===ft}M174(){return this.RANK===mt}M197(){return this.RANK===gt}M198(){return this.RANK%2==0}M211(){return this.RANK%2!=0}M199(t){return this.SUIT===t}M88(){return this.#bt?Et.name:yt[this.RANK]||this.RANK.toString()}M89(){return this.#bt?Et.suit:dt[this.SUIT]||"Unknown"}M47(){return this.#bt?Et.symbol:xt[this.RANK]||this.M88()}M62(){return ht[this.COLOR]||"Unknown"}},kt=1/0,Lt=!0,Ct=!0,It=class extends q{#mt=Ct;#kt=Lt;constructor(t,i,s,e,n,r,h={}){const{max_cards:o=kt,flip_after:a=Lt,face_up:l=Ct,sorting:c=null,tuck:u=!1,uniform:d=!0,parent:_=null,reverse_z:M=!1}=h;super(t,i,s,e,n,r,{max_count:o,sorting:c,tuck:u,uniform:d,parent:_,reverse_z:M}),this.M32(vt.K136),this.ELEMENT&&this.ELEMENT.classList.add("BoxOfCards"),this.M119(l),this.M63(a)}#Lt(t,i){t.M119(i)}M225(t,i=!0){return t instanceof vt?(super.M225(t,i),this.#kt?t.M78(this.#Lt.bind(this,t,this.#mt)):t.M119(this.#mt),this):(this.Error("Add","Not a Card instance",t),this)}M191(t){return this.M225(t,!1)}M192(t){return this.M225(t,!0)}M138(t){return t instanceof vt?super.M138(t):(this.Error("Includes","Not a Card instance",t),this)}M140(t,i=!0,s=0){const e=t.length;if(0===e)return this;for(let i=0;i<e;i++){const s=t[i];if(!(s instanceof vt))return this.Error("BatchAdd","Not a Card instance",s),this}if(this.M139()+e>this.M82())return this.Error("BatchAdd","I am full"),this;super.M140(t,i,s);for(let i=0;i<e;i++){const s=t[i];this.#kt?s.M78(this.#Lt.bind(this,s,this.#mt)):s.M119(this.#mt)}return this}M193(t){return t instanceof vt?(super.M193(t),this):(this.Error("Remove","Not a Card instance",t),this)}M85(t=null,i=0){const s=null===t?[...this.GetEntities()]:t,e=s.length;if(0===e)return this;for(let t=0;t<e;t++){const i=s[t];if(!(i instanceof vt))return this.Error("Remove","Not a Card instance",i),this}return super.M85(t,i),this}M121(t){return super.M83(t)}M119(t=!0){return this.#mt=!!t,this}M63(t=!0){return this.#kt=!!t,this}};function At(t,i){return t.IDX-i.IDX}var St=class{#Ct=[];#It=[];#At=[];#St=null;#Tt=0;#Nt=[];constructor(t={},i={}){const{jokers:s=0,exclude_ranks:e=[],exclude_cards:n=[],suits:r=ut,seed:h=0}=t;this.#Tt=h,this.#Dt(r,e,n,s),this.#St={smooth:i.smooth??!0,touch_down_events:i.touch_down_events??!0,velocity_px_ms:i.velocity_px_ms??100,flip_time:i.flip_time??500,face_up:i.face_up??!0,visible:i.visible??!0,flip_axis:i.flip_axis??"y"},this.M208()}#Ot(t,i,s){return(t&it)===i&&(t&st<<$)===s}#Dt(t,i,s,e){for(const e of t){const t=e===at||e===ct?rt:nt;for(let n=1;n<=13;n++){if(i.includes(n))continue;if(s.some(t=>this.#Ot(n|e,t.rank,t.suit)))continue;const r=n|e|t,h=new vt(this.#Ct.length,r);this.#Ct.push(h)}}for(let t=0;t<e;t++){const i=_t|(t%2==0?nt:rt),s=new vt(this.#Ct.length,i);this.#Ct.push(s)}}M90(t){let i=0;for(const s of t)for(let t=0;t<this.#Ct.length;++t){const e=this.#Ct[t];if(this.#Ot(e.DNA,s.rank,s.suit)){i+=1,this.#Ct.splice(t,1),this.#Nt.push(e);break}}this.#Rt()}M64(t){}#Rt(){this.#At=[],this.#It=this.#Ct.map((t,i)=>i)}M208(){this.#Rt();const t=new Set;this.#Ct.forEach(i=>{const s=i.M189();s&&t.add(s)}),t.forEach(t=>t.M207());const i=this.#St;for(const t of this.#Ct)t.M208(i);return this}M220(t=null,i=0){if(null===t)return this;const s=this.M176(),e=i>0;return this.M167(t=>{t.M101(e),t.M115(e),t.M86(0),t.M119(!1)}),t.M140(s,!0,i>0?i:0),this.M167(t=>{t.M86(this.#St.flip_time),t.M115(this.#St.smooth)}),this}M165(t=0){let s=Math.random;0!==(t=t||this.#Tt)&&(t="string"==typeof t?M99(t):t,s=i.M27(t));const e=this.#It;for(let t=e.length-1;t>0;t--){const i=Math.floor(s()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return this}M175(t=0){return this.#Tt="string"==typeof t?M99(t):0|t,this.#Tt}M221(){if(0===this.#It.length)return null;const t=this.#It.pop();return this.#At.push(t),this.#Ct[t]}M176(){const t=[];return this.#It.forEach(i=>{t.push(this.#Ct[i])}),this.#At=this.#It,this.#It=[],t}M144(){const t=this.#It[this.#It.length-1];return this.M177(t)}M177(t){return this.#Ct[t]}M48(t){if("function"!=typeof t)return[];const i=[];for(let s=this.#It.length-1;s>=0;s--){const e=this.#It[s],n=this.#Ct[e];t(n)&&(this.#It.splice(s,1),this.#At.push(e),i.push(n))}return i}M65(t,i){t|=0,i|=0,this.#Ct.forEach(s=>s.M157(t,i))}M178(){return this.#Ct.length}M21(){return this.#It.length}M167(t){return"function"!=typeof t||this.#Ct.forEach((i,s)=>t(i,s)),this}M22(t,i){const s=t.SUIT,e=i.SUIT;return s<e?-1:s>e?1:Math.sign(t.RANK-i.RANK)}},Tt="off",Nt=class extends It{static K74=Tt;static K75="top";static K32="right";static K24="bottom";static K56="left";#Bt=null;#Pt=!1;#Vt=0;#Kt=null;constructor(t,s,e={}){const{max_cards:n=1/0,counter_position:r=Tt,pop_effect:h=!1,face_up:o=!0,parent:a=null}=e;super(t,s,q.ROW,q.K142,q.K137,!0,{max_cards:n,parent:a}),this.#Ft(),this.#zt(),this.M16(r),this.M66(h),this.M119(o),i.M5(this,"COUNTER",this.#Bt)}#Ft(){const t=this.ELEMENT;t.classList.add("PileOfCards");const i=document.createElement("span");i.classList.add("PileCounter"),i.innerText="0",t.appendChild(i),this.#Bt=i}M225(t,i=!0){return super.M225(t,i),this.#Ut(t,i),this}#Ut(t,i=!0){t.M133()?(this.#Vt++,t.M78(()=>{this.#Vt--,this.#zt(),this.#jt(i?t:null),i||this.#Kt===t||t.M101(!1)})):(this.#jt(i?t:null),i||this.#Kt===t||t.M101(!1),this.#zt())}#jt(t=null){const i=this.M139();if(0===i)return;const s=this.#Kt;if(null===t)for(let s=i-1-this.#Vt;s>=0;--s){const i=this.M83(s);if(!i.M131()){t=i;break}}s!==t&&(s&&s.M101(!1),this.#Kt=t,t.M101(!0))}M140(t,i=!0){super.M140(t,i);const s=t.length;let e;for(let i=0;i<s;i++)e=t[i],e.M101(!1);return this.#zt(),this.#jt(i?e:null),this}M193(t){return super.M193(t),this.#Gt(t),this}#Gt(t,i=!0){t.M101(!0),t.M131()&&this.#Vt--,i&&(this.#Kt===t&&(this.#Kt=null,this.#jt(null)),this.#zt())}M85(t=null,i=0){const s=this.#Kt,e=null===t?[...this.GetEntities()]:t,n=e.length;if(0===n)return this;super.M85(t,i);for(let t=0;t<n;t++){const i=e[t];this.#Gt(i,!1)}return e.includes(s)&&this.#jt(),this.#zt(),this}M207(){return super.M207(),this.#Kt=null,this.#Vt=0,this.#zt(),this}M145(t){return this.M225(t,!0)}M91(t){return this.M225(t,!1)}M92(){const t=this.M169();return t&&this.M193(t),t}M36(){const t=this.M168();return t&&this.M193(t),t}M187(){return this.M169()}M122(){return this.M168()}M165(){const t=this.M139();if(t>0&&this.#Ht(),t<=1)return;const i=this.#Kt;super.M165();const s=this.M83(t-1);return i!==s&&(i.M101(!1),s.M101(!0),this.#Kt=s),this}M16(t){return this.ELEMENT.dataset.counter=t,this}M66(t){return this.#Pt=!!t,this}#zt(){const t=this.M139()-this.#Vt;this.#Bt.innerText=t,this.#Pt&&this.#Ht()}#Ht(){const t=this.#Bt;t.classList.remove("PopEffect"),this.M76(),t.classList.add("PopEffect")}debug(){const t=this.M139();for(let i=0;i<t;++i)this.M83(i)}M179(){const t=this.M139();return 0===t?null:this.M83(t-1)}M108(){return 0===this.M139()?null:this.M83(0)}},Dt="https://",Ot=window.visualViewport,Rt="AppRotate",Bt="AppError",Pt="AppErrorInfo",Vt="AppViewport",Kt="PageHidden",Ft="Hidden",zt=Rt.toLowerCase(),Ut=Bt.toLowerCase(),jt="Home".toLowerCase(),Gt="Play".toLowerCase(),Ht=class t{static K120=1;static K127=2;static K146=3;#qt=null;#Wt=null;#Xt=new Map;#Yt=t.K120;#Qt=null;#$t=null;#Jt=null;#Zt=null;#ti=null;#ii=null;#si=null;#ei=null;#ni=null;#ri="";#hi=!0;constructor(t={}){this.#ri=i.M128?"touchstart":"click",this.#oi(t);const s=t.start_page||jt;requestAnimationFrame(()=>this.M147(s))}#oi(t){if(this.#qt=document.getElementById(Vt),null===this.#qt)throw new Error("App » Element not found: #"+Vt);this.#ai();const i=this.#Xt.get(zt);if(!i)throw new Error("App » Element not found: #"+Rt);i.classList.add(Rt);const s=this.#Xt.get(Ut);if(!s)throw new Error("App » Element not found: #"+Bt);if(s.classList.add(Bt),this.#$t=document.getElementById(Pt),!this.#$t)throw new Error("App » Element not found: #"+Pt);this.#li(t),this.#ci(),this.#ui(),this.#di(),this.#Yt=t.page_mode??1,this.#_i(),this.#si=t.on_resize||this.#si||null,this.#ei=t.on_click||this.#ei||null,this.#ni=t.on_page||this.#ni||null}#li(t){const i=new X("Onesie");i.M101(!0),i.M119(!1),i.M115(!1),this.#ii=i;const s=this.#Xt.get(jt);if(s.appendChild(i.ELEMENT),s.classList.add("Clickable"),t.blank_card)return;const e=t.game_name||"Some Card Game",n=t.game_designer||"Some Great Designer",r=t.game_build||("undefined"!=typeof BUNDLE_ID?BUNDLE_ID:"0000-0000-0000"),h="p";if(!t.blank_back){const t=document.createElement(h);t.classList.add("h1"),t.innerHTML="ONESIE",i.BACK.appendChild(t);const s=document.createElement(h);s.classList.add("h2"),s.innerHTML="1p card games",i.BACK.appendChild(s);const e=document.createElement(h);e.classList.add("h3"),e.innerHTML="build:<br><span>"+r+"</span>",i.BACK.appendChild(e)}if(!t.blank_face){const t=document.createElement(h);t.classList.add("h1"),t.innerHTML=e;const s=document.createElement(h);s.classList.add("h2"),s.innerHTML="<small>designed by:</small><br>"+n;const o=document.createElement(h);o.classList.add("h2"),o.innerHTML="<small>coded by:</small><br>Pedro Fontoura";const a=document.createElement(h);a.classList.add("h3"),a.innerHTML="build:<br><span>"+r+"</span>";const l=document.createElement(h);l.classList.add("h3"),l.innerHTML="♦ a solitaire card game ♦";for(const e of[t,l,s,o])i.FACE.appendChild(e)}}#ai(){document.querySelectorAll("#"+Vt+" > section").forEach(t=>{this.#Xt.set(t.id.toLowerCase(),t),t.classList.add(Kt)})}#di(){window.addEventListener("resize",()=>this.#_i()),window.addEventListener("contextmenu",t=>{if(t.preventDefault(),t.stopPropagation(),"touchstart"===this.#ri)return;const i=new MouseEvent(this.#ri,{view:window,bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});t.target.dispatchEvent(i)},{passive:!1}),window.addEventListener("unhandledrejection",t=>{t.preventDefault(),t.stopPropagation();const i=[this.#Mi(t.reason.stack)].join("<br>");this.#pi("Error",i)}),window.addEventListener("error",t=>{t.preventDefault(),t.stopPropagation();const i=[t.error.message,t.error.fileName,t.error.lineNumber,this.#Mi(t.error.stack)].join("<br>");this.#pi("Error",i)}),this.#Zt.addEventListener(this.#ri,t=>{this.#fi(),t.stopPropagation(),this.#ti.classList.toggle(Ft)}),Array.from(this.#ti.children).forEach(t=>{const i=this.#mi(t);this.#Xt.get(i)?t.addEventListener(this.#ri,t=>{this.#fi(),t.stopPropagation(),this.#gi(t)}):t.remove()}),this.#ii.M8().addEventListener(this.#ri,t=>{this.#fi(),t.stopPropagation(),this.#ii.M141()?this.M147(Gt):this.#ii.M219()}),this.M180(jt).addEventListener(this.#ri,t=>{this.#fi(),t.stopPropagation(),this.#ii.M219()}),window.addEventListener(this.#ri,t=>{t.stopPropagation(),this.#bi(t)})}#fi(){i.M57||i.M128&&i.M18()}#gi(t){const i=this.#mi(t.target);this.#Xt.get(i)&&this.M147(i)}#bi(t){let i=0,s=0;if("touchstart"===this.#ri){const e=t.touches[0];i=e.clientX,s=e.clientY}else i=t.clientX,s=t.clientY;if(this.#ei){if(!this.#hi)return;this.#ei(t.target,0|i,0|s)}}#ci(){this.#Jt=document.getElementById("AppSideMenu"),this.#Zt=document.getElementById("AppSideMenuMain"),this.#ti=document.getElementById("AppSideMenuGroup"),this.#ti.classList.add(Ft),i.M128&&this.#Jt.classList.add("TopSpacing")}#Mi(t){return t.split("at ").join("<br>&bull; ")}#pi(t,i){null!==this.#$t&&(this.#$t.innerHTML+="<h3>"+t+"</h3>"+i,this.M147(Ut))}#_i(){const t=Ot.width,i=Ot.height;if(this.#wi(),this.#ii){const s=.75*Math.min(t,i)|0,e=.7*s|0;this.#ii.M157(e,s),this.#ii.M77(t-e>>1,i-s>>1)}this.#si&&this.#si(t,i,this.#Jt.offsetWidth)}get M212(){return Ot.width}get M200(){return Ot.height}#wi(){3!==this.#Yt&&((Math.sign(Ot.width-Ot.height)>=0?1:2)!==this.#Yt?this.#Wt!==zt&&(this.#Qt=this.#Wt,this.M147(zt)):null!==this.#Qt&&(this.M147(this.#Qt),this.#Qt=null))}async#ui(){await this.M123("./assets/app_icons.svg","icons-sprite-sheet")}async M123(t,i){try{const s=await fetch(t),e=await s.text(),n=document.getElementById(i);n&&n.remove();const r=(new DOMParser).parseFromString(e,"image/svg+xml").querySelector("svg");r&&(r.id=i,r.style.display="none",document.body.insertAdjacentElement("afterbegin",r))}catch(t){}}async M146(t){try{const i=await fetch(t);return i.ok?await i.json():null}catch(t){return null}}#mi(t){const i=t.querySelector("use");if(i)return(i.getAttribute("href")||i.getAttribute("xlink:href")).split("-").pop().toLowerCase()}get M109(){return this.#Jt.offsetWidth}get M222(){return this.#ii}M147(t,i=!1){const s=this.#Wt===t;t=t.toLowerCase();const e=this.#Xt.get(t);if(!e)throw new Error("App » No such page: "+t);t===Gt&&this.#hi,this.#Wt&&this.#Xt.get(this.#Wt).classList.add(Kt),e.classList.remove(Kt),this.#Wt=t,t===jt?this.#Jt.classList.add(Ft):this.#Jt.classList.remove(Ft);const n=this.#ii;n&&n.M119(!1),this.#ni&&!i&&this.#ni(t,s)}M124(t){return this.#Wt===t}M180(t){const i=this.#Xt.get(t);if(!i)throw new Error("App » No such page: "+t);return i}M67(){const t=window.matchMedia("(display-mode: standalone)").matches,i=!0===window.navigator.standalone;return t||i}M148(t=!0){(t=!!t)&&this.#hi?this.#ti.classList.remove(Ft):this.#ti.classList.add(Ft)}M33(t,i){t.classList.add("Clickable"),t.addEventListener(this.#ri,s=>{s.preventDefault(),s.stopPropagation(),i(t)})}get M226(){const t=new Date,s=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}-${String(t.getHours()).padStart(2,"0")}-${String(t.getMinutes()).padStart(2,"0")}`;return i.M99("Onesie"+s)}async M93(t=!0){const s=await this.#yi();if("Wrpq}Qjt7qxvn"===i.M58(s,9))return this.#hi=!0,!0;let e=!1;return window.top===window.self&&"ynm{x6oxw}x~{j7pr}q~k7rx"===i.M58(window.location.hostname,9)&&(e=i.M17("key",0,!0)===this.M226),this.#hi=e,!e&&t&&this.#xi(),e}#xi(){const t=Dt+i.M58("ynm{x6oxw}x~{j7pr}q~k7rx8xwn|rn8HyjpnFyuj",-9);self.location.replace(t)}#yi=async()=>(await fetch(window.location.href,{method:"HEAD"})).headers.get("server");async M49(t,s=!0){const e=Dt+i.M58("etm2gsyrxivetm2hiz3z6",-4)+"/"+i.M58("rqhvlh0vwdwv",-3)+"/"+i.M58(t,-5)+"/"+(s?"up":"down");try{const t=await fetch(e),i=await t.json();i.data&&i.data}catch(t){}}},qt="fsm_data_changed",Wt=class{#Ei=()=>{};V47=!0;V43=new Map;V21=null;V31={};V27=[];V28=[];constructor(t,i=[]){if(this.#Ei=t,i.length>0)for(const t of i)this.V27.push(t)}M37(t){this.#vi(t)}M50(t){if(null!==t&&!this.V43.has(t))throw new Error("FSM::AssertStateId » Unknown id: "+t)}M51(t){if(!this.V31.hasOwnProperty(t))throw new Error("FSM::AssertDataKey » Unknown key: "+t)}M68(t,i,s=null){this.M50(t),this.M50(i),null!==t&&t!==this.V21.ID||this.#vi(i,s)}#vi(t,i=null){if(this.V21&&this.V21.M223(),this.V21=this.V43.get(t),!this.V21)throw new Error("FSM::#TransitionTo » No state! Key:",t);return this.V21.M213(i),!0}M38(t){if(null!==t)return this.M50(t),this.V21.ID===t}M69(t,i={}){this.M50(t);for(const[t,s]of Object.entries(i))this.M51(t),s!==this.V31[t]&&(this.V31[t]=s,this.#ki(t,s));return this.M38(t)}#ki(t,i){this.V27.includes(t)&&this.#Li(qt,{key:t,value:i})}M70(t,i){if(this.M50(t),"string"==typeof i)return this.M51(i),this.V31[i];const s={};for(const t of i)this.M51(t),this.V31[t],s[t]=this.V31[t];return s}M149(){const t=this.V31;for(const[i,s]of Object.entries(t));}M201(t=null,i,s){t&&this.M50(t),this.#Li(i,s)}#Li(t,i){this.#Ei(t,i)}M125(t){this.M50(t),this.V21&&(this.V21.Sleep(),this.V28.push(this.V21)),this.V21=this.V43.get(t),this.V21.M213()}M150(){const t=this.V28;if(0===t.length)throw new Error("FSM::PopState » Stack is empty");this.V21.M223(),this.V21=t.pop(),this.V21.WakeUp()}},Xt=class{constructor(t,s){i.M5(this,"ID",t),i.M5(this,"CONTROLLER",s)}M213(t){}M223(){}M181(t,i){return!1}M94(t,i){return!1}M110(t,i){return!1}M201(...t){return this.CONTROLLER.M201(this.ID,...t)}M182(...t){return this.CONTROLLER.M70(this.ID,...t)}M183(...t){return this.CONTROLLER.M69(this.ID,...t)}M68(...t){return this.CONTROLLER.M68(this.ID,...t)}},Yt=class extends Xt{constructor(t){super(t)}},Qt=class extends Xt{constructor(t,i){super(t,i)}M110(t){if(!t.classList.contains("PredictionBtn"))return this.M201(d,"Not a prediction button"),!1;const i=parseInt(t.dataset.slot_idx);if(this.CONTROLLER.M54(this.ID,i))return this.M201(d,"Slot is blocked"),!1;const s=t.dataset.id;let e=this.M182("nr_predictions");return e+=1,this.M183({slot_idx:i,prediction_key:s,nr_predictions:e}),this.M68(r),!0}},$t=new Map;$t.set("R",t=>t.M209()),$t.set("B",t=>t.M171()),$t.set("E",t=>t.M198()),$t.set("O",t=>t.M211()),$t.set("D",t=>t.M199(Y.K31)),$t.set("H",t=>t.M199(Y.K72)),$t.set("S",t=>t.M199(Y.K73)),$t.set("C",t=>t.M199(Y.K97)),$t.set(T,t=>t.M209()&&t.M211()),$t.set(O,t=>t.M209()&&t.M198()),$t.set(N,t=>t.M171()&&t.M198()),$t.set(D,t=>t.M171()&&t.M211());var Jt=class extends Xt{constructor(t,i){super(t,i)}M213(){const t=this.M182("prediction_key"),i=this.CONTROLLER.M154(this.ID),s=$t.get(t)(i);this.M183({card_idx:i.IDX}),this.M68(s?h:o)}},Zt=class extends Xt{constructor(t,i){super(t,i)}M213(){const{nr_predictions:t,nr_predictions_ok:i,slot_idx:s,card_idx:e}=this.M182(["nr_predictions","nr_predictions_ok","slot_idx","card_idx"]),n=i+1,r=n/t*100;this.M183({success:r,nr_predictions_ok:n});const h=this.CONTROLLER.M55(this.ID,e,s),o=this.CONTROLLER.M28(this.ID,s);this.M183({lst_slots_idx:o});const c=o.length>0?l:a;h.M78(t=>this.M68(c))}},ti=class extends Xt{constructor(t,i){super(t,i)}M213(){const{slot_idx:t,card_idx:i}=this.M182(["slot_idx","card_idx"]);this.CONTROLLER.M41(this.ID,i).M78(i=>{this.CONTROLLER.M97(this.ID)?this.M68(u):this.CONTROLLER.M40(this.ID,t).M78(t=>this.M68(a))})}},ii=class extends Xt{constructor(t,i){super(t,i)}M213(){const t=this.CONTROLLER.M9(this.ID);this.M183({nr_completed:t}),8!==t?8!==this.CONTROLLER.M26(this.ID)?this.CONTROLLER.M97(this.ID)?this.M68(u):(this.CONTROLLER.M56(this.ID),this.M68(n)):this.M68(u):this.M68(c)}},si="destination",ei="stone",ni=class extends Xt{#Ci="";#Ii=null;#Ai=-1;#Si="none";#Ti=!1;constructor(t,i){super(t,i)}M213(){const{lst_slots_idx:t,level:i}=this.M182(["lst_slots_idx","level"]);this.#Ii=t,this.CONTROLLER.M34(this.ID,t,!0),3===i&&this.#Ii.length>1?this.#Ni():this.#Di()}#Di(){this.#Si=si,this.M201(_,{title:"Where to move the stones?",options:[{label:"Back to Deck (Face Down)",value:z},{label:"To the Table (Face Up)",value:U}],callback:t=>this.#Oi(t)}),this.#Ti=!0}#Ni(){this.#Si=ei;const t=[];for(const i of this.#Ii)t.push({label:"Slot",value:i});this.M201(_,{title:"Whick stone do you want to remove?",options:t,callback:t=>this.#Ri(t)}),this.#Ti=!0}#Oi(t){this.#Ti=!1,this.#Ci=t,this.#Ai=0,this.#Bi()}#Bi(){if(this.#Ai>=this.#Ii.length)return void this.M68(a);const t=this.#Ii[this.#Ai];this.CONTROLLER.M34(this.ID,[t],!1),this.CONTROLLER.M95(this.ID,t,this.#Ci).M78(()=>{this.#Ai+=1,this.#Bi()})}#Ri(t){this.#Ti=!1;for(const i of this.#Ii)i!==t&&this.CONTROLLER.M34(this.ID,[i],!1);this.CONTROLLER.M34(this.ID,[t],!0),this.#Ii=[t],this.#Di()}M94(t,i){if(!this.#Ti)return!1;if(this.#Si===si)return this.#Pi(null,i);if(t.M141())return!1;if(!t.M102())return!1;const s=this.CONTROLLER.M127(this.ID,t,this.#Ii);return this.#Ri(s),!0}M181(t,i){if(this.#Ti)return this.#Pi(t,i)}#Pi(t,i){return!!this.#Ti&&(this.#Si!==ei?1===i?(this.#Oi(z),!0):2===i&&(this.#Oi(U),!0):void 0)}},ri=class extends Xt{constructor(t,i){super(t,i)}M213(){this.M201(m,!0)}},hi=class extends Xt{constructor(t,i){super(t,i)}M213(){this.M201(m,!1)}},oi=.1,ai=1-oi,li=class extends q{#Vi=null;#Ki=null;#Fi=new Map;#zi=!1;#Ui=!1;#ji=0;#Gi=0;constructor(t,s,e,n,r={}){const{parent:h=null,title_height:o=oi}=r;ai=1-(oi=o),super(t,"PredictionSlot_"+t,q.COLUMN,q.K148,q.K137,!0,{max_count:1,uniform:!0,face_up:!1,parent:h}),i.M5(this,"IDX",t),i.M5(this,"ROW",s),i.M5(this,"COLUMN",e),this.ELEMENT.classList.add("PredictionSlot"),this.#Ki=new It(t,"Predictions_BoxOfCards_"+t,q.COLUMN,q.K137,q.K137,!0,{flip_after:!0,face_up:!0,parent:h,tuck:!0,reverse_z:!0}),this.M225(this.#Ki),this.#Vi=document.createElement("div"),this.#Vi.classList.add("PredictionSlotTitle"),this.ELEMENT.appendChild(this.#Vi);for(let i of n){const s=document.createElement("button"),e=R[i];s.innerText=e,s.dataset.id=i,s.dataset.slot_idx=t,s.classList.add("PredictionBtn"),s.classList.add("Clickable"),this.#Vi.appendChild(s),this.#Fi.set(i,s)}}M208(){this.#zi=!1,this.#Ui=!1,this.#ji=0,this.#Gi=0,this.#Ki.M167(t=>t.BACK.classList.remove("Trapped")),this.#Hi(),this.#qi(),this.#Wi()}M23(t){t.appendChild(this.ELEMENT),t.appendChild(this.#Ki.ELEMENT)}M151(t,i,s,e,n,r,h,o){this.#Vi.style.height=Math.floor(i*oi)+"px";const a=Math.min(18,.45*o|0)+"px";for(const[t,i]of this.#Fi)i.style.width=h+"px",i.style.height=o+"px",i.style.fontSize=a;this.#Ki.M31(n,r);const l=i*ai|0,c=h;this.#Ki.M157(c,l),this.M31(c,l),this.M112(t,i,s,e)}M52(t){this.#ji+=1,this.#Xi(t,!0)}M152(t){this.#Gi+=1,this.#Ui=3===this.#Gi,this.#Xi(t,!1)}#Xi(t,i=!0){this.#Ki.M225(t,!1),this.#zi=!i,t.M78(()=>{t.M119(i),this.#Yi(),this.#Hi(),this.#qi(),this.#Wi()})}#Yi(){const t=this.#Ki.M139();let i=!1;for(let s=0;s<t;++s){const t=this.#Ki.M121(s);t.M141()?i=!0:i?t.BACK.classList.add("Trapped"):t.BACK.classList.remove("Trapped")}}M39(t){return t.M189()===this.#Ki&&(!!t.M107()&&(!!this.#zi&&this.#Ki.M168()===t))}M95(){if(!this.#zi)return null;const t=this.#Gi;if(0===t)return null;const i=this.#Ki.M168();if(this.#Ki.M193(i),this.#Gi-=1,0===this.#Ki.M139()||0===t)this.#zi=!1;else{const t=this.#Ki.M168();this.#zi=t.M107()}return this.#Hi(),this.#qi(),this.#Wi(),i}#Hi(){this.#Ui=3===this.#Gi,this.#Ui?this.ELEMENT.classList.add("Blocked"):this.ELEMENT.classList.remove("Blocked")}#Wi(){const t=this.#Ui;for(const[i,s]of this.#Fi)s.disabled=t}#qi(){this.M96()?this.ELEMENT.classList.add("Completed"):this.ELEMENT.classList.remove("Completed")}M126(){return this.#Ui}M24(){return this.#zi}M153(){return this.#Gi>0}M53(){return this.#ji>0}M96(){return this.#ji>0&&!this.#zi}M25(t){const i=this.#Ki.M168();return null!==i&&i.M79(t),i}},ci=class extends Wt{static K57=qt;#Qi=null;#$i=null;#Ji=null;#Zi=null;#ts=null;#is=0;#ss={position:new Array(2),status:0};#es=null;constructor(t={}){const{on_message_request:i,V27:s=[],parent_node:n=window.document.body}=t;super(i,s),this.#es=n,this.#ns();for(const t of s)this.V31.hasOwnProperty(t);this.#rs(),this.M37(e),this.#hs()}#ns(){this.V31.nr_predictions=0,this.V31.nr_predictions_ok=0,this.V31.prediction_key="",this.V31.slot_idx=-1,this.V31.card_idx=-1,this.V31.success=0,this.V31.level=0,this.V31.nr_completed=0,this.V31.lst_slots_idx=null,this.V31.stones_destination=""}#rs(){const t=[[e,Yt],[n,Qt],[r,Jt],[h,Zt],[o,ti],[l,ni],[a,ii],[c,ri],[u,hi]];for(const[i,s]of t)this.V43.set(i,new s(i,this))}M69(t,i){return super.M69(t,i),this.#os(),this.V21.ID===t}#os(){this.V31}M181(t,i,s){let e=!1;this.V47||(e=this.#as(t)),this.#ss.position[0]=i,this.#ss.position[1]=s,this.#ss.status=e,this.M201(null,M,this.#ss)}#as(t){if(!t.classList.contains("Clickable"))return!1;const i=t.classList;if(i.contains("CardBody")){const i=parseInt(t.dataset.idx),s=this.#Qi.M177(i),e=this.#ls(s);return this.V21.M94(s,e)}const s=this.#cs(t);return"BUTTON"===t.nodeName?!t.disabled&&this.V21.M110(t,s):(i.contains("Table")||!!i.contains("DrawPile"))&&this.V21.M181(t,s)}#ls(t){const i=t.M189();return i===this.#Zi?1:i===this.#Ji?2:0}#cs(t){return t===this.#Zi.ELEMENT?1:t===this.#Ji.ELEMENT?2:0}M71(t){return!Number.isInteger(t)||t<=0?(this.M201(null,MSG_APP_ERROR,"Invalid game_level: "+t),this):(this.V31.level=t,this)}M214(){for(const t of this.#$i)t.M208();const t=i.M17("seed",Date.now()%1e6,!0);this.M201(null,g,t),this.#Qi.M208().M165(t).M220(this.#Zi),this.#ts.classList.remove("Hidden"),this.V47||(this.#us(),this.#ds()),this.V47=!1,this.M37(n)}M151(t,i,s=0){const e=Math.min(t,i),n=.03*e,r=(s||.1*e)+n,h=.03*e,o=t-n-r,a=i-2*h,l=Math.round(o/8),c=Math.round(a/5),u=Math.min(18,Math.round(.1*l))+"px",d=.75*c,_=.66*d;this.#Qi.M65(_,d);const M=(o-3*n)/4,p=(2*c*2-1*h)/2,f=Math.round(.9*(M>>1)),m=Math.round(.15*p*.8);let g=0,b=n,w=h;for(let t=0;t<2;++t){b=n;for(let i=0;i<4;++i){const s=this.#$i[g++];s&&(s.M151(M,p,b+i*M,t*p+w,_,d,f,m),b+=n)}w+=h}this.#Ji.M31(_,d),this.#Ji.M112(o-2*l,c-h,n+l,h+4*c+h),this.#Zi.M31(_,d),this.#Zi.M112(.8*l-n,c-h,n,h+4*c+h),this.#Zi.COUNTER.style.fontSize=u;const y=this.#ts.style;return y.bottom=h+"px",y.right=r+"px",y.width=l+"px",y.height=c-h+"px",y.fontSize=u,this}M54(t,i){return this.M50(t),this.#_s(i),this.#$i[i].M126()}M154(t){return this.M50(t),this.#Zi.M92()}M127(t,i,s){this.M50(t);for(const t of s)if(this.#_s(t),this.#$i[t].M39(i))return t;return-1}M55(t,i,s){this.M50(t),this.#_s(s),this.#Ms(i);const e=this.#Qi.M177(i);return this.#$i[s].M52(e),e}M40(t,i){this.M50(t),this.#_s(i);const s=this.#Zi.M92();return this.#$i[i].M152(s),s}M41(t,i){this.M50(t),this.#Ms(i);const s=this.#Qi.M177(i);return this.#Ji.M225(s),s}M28(t,i){this.M50(t),this.#_s(i);const s=this.#ps(i,this.V31.level);return this.#$i.filter(t=>s.includes(t.IDX)&&t.M24()).map(t=>t.IDX)}#ps(t,i){const s=this.#$i[t],e=s.ROW,n=s.COLUMN,r=[],h=t-4,o=t+4,a=t-1,l=t+1,c=e>0,u=e<1,d=n>0,_=n<3;if(d&&r.push(a),_&&r.push(l),c&&r.push(h),u&&r.push(o),1!==i)return r;const M=h-1,p=h+1,f=o-1,m=o+1;return c&&d&&r.push(M),c&&_&&r.push(p),u&&d&&r.push(f),u&&_&&r.push(m),r}M34(t,i,s){this.M50(t);const e=this.#Qi.M177(this.V31.card_idx),n=s?{stones:[],prediction:[e.M44(),e.M61()]}:null;for(const t of i){const i=this.#$i[t].M25(s);s&&n.stones.push([i.M44(),i.M61()])}s?this.M201(null,p,n):this.M201(null,f,null)}M95(t,i,s){this.M50(t),this.#_s(i);const e=this.#$i[i].M95();return s===z?this.#Zi.M91(e):this.#Ji.M225(e),e}M9(t){this.M50(t);let i=0;for(let t=0;t<this.#$i.length;++t)this.#$i[t].M96()&&(i+=1);return i}M26(t){this.M50(t);let i=0;for(let t=0;t<this.#$i.length;++t)this.#$i[t].M126()&&(i+=1);return i}M97(t){return this.M50(t),0===this.#Zi.M139()}M56(t){this.M50(t),this.#us()}#us(){this.V31.prediction_key="",this.V31.slot_idx=-1,this.V31.card_idx=-1,this.V31.lst_slots_idx=null,this.V31.stones_destination=""}#ds(){super.M69(null,{nr_predictions:0,nr_predictions_ok:0,success:0,nr_completed:0})}#_s(t){if(t<0||t>this.#$i.length-1)throw new Error("GC::AssertSlotIdx » Bad idx: "+t)}#Ms(t){if(t<0||t>this.#is-1)throw new Error("GC::AssertCardIdx » Bad idx: "+t)}#hs(){this.#fs(),this.#ms()}#fs(){this.#Qi=new St({jokers:0,exclude_ranks:[7,8,9,10,11,12,13]},{velocity_px_ms:1.25,flip_time:300,visible:!1,touch_down_events:!0,smooth:!0,flip_axis:s.M60(.5)?"x":"y"}),this.#Qi.M167(t=>{this.#es.appendChild(t.ELEMENT)}),this.#is=this.#Qi.M178()}#ms(){const i=this.#Qi.M178(),s=this.#es;let e=0;this.#$i=[];for(let t=0;t<2;++t)for(let i=0;i<4;++i){const n=new li(e,t,i,B[e],{parent:s,title_height:.15});this.#$i.push(n),e+=1}this.#Ji=new It(e++,"Table",It.ROW,It.K137,It.K137,!0,{max_count:i,flip_after:!0,face_up:!0,sorting:At,parent:s}),this.#Ji.ELEMENT.classList.add("Table"),this.#Ji.ELEMENT.classList.add("Clickable"),this.#Zi=new Nt(e++,"DrawPile",{max_cards:i,flip_after:!1,face_up:!1,parent:s,counter_position:Nt.K32,pop_effect:!0}),this.#Zi.ELEMENT.classList.add("DrawPile"),this.#Zi.ELEMENT.classList.add("Clickable"),this.#ts=t("InGameInfo")}};import ui from"stampit";import stampit from"stampit";var di=stampit({props:{M111:!1,M224:null,M10:NaN},methods:{setImage(t){this.resetImage(),this.M111=!0;let i=null;"string"==typeof t?(i=new Image,i.onload=()=>{this.M224=i,this.M10=i.width/i.height},i.onerror=()=>{this.resetImage()},i.src=t):(t instanceof HTMLImageElement||t instanceof Image)&&(this.M224=t,this.M10=t.width/t.height)},getImage(){return this.M224&&this.M224.complete?this.M224:null},getImageAspectRatio(){return this.M224&&this.M224.complete?this.M10:NaN},resetImage(){this.M224=null,this.M10=NaN,this.M111=!1}}});import _i from"stampit";import{ARRAY_TYPE as Mi}from"glMatrix";import{fromValues as pi,create as fi}from"vec2";var vec2={fromValues:pi,create:fi},mi=_i({methods:{validateVector(t,i=null){const s=t||i;if(!s)return vec2.create();if(!(Array.isArray(s)||s instanceof Mi))throw new Error("Vector input must be an Array or glMatrix ARRAY_TYPE.");if(2!==s.length)throw new Error("Vector input must have exactly 2 elements.");if(!Number.isFinite(s[0])||!Number.isFinite(s[1]))throw new Error("Vector array must contain only numeric values.");return vec2.fromValues(s[0],s[1])}}});import{add as gi,create as bi,scaleAndAdd as wi,zero as yi,copy as xi}from"vec2";import Ei from"stampit";import vi from"stampit";var ki=vi({methods:{makeReadOnly:function(t){if("object"!=typeof t||null===t||Array.isArray(t))return;const i={};Object.entries(t).forEach(([t,s])=>{Object.prototype.hasOwnProperty.call(this,t),i[t]={configurable:!1,writable:!1,value:s,enumerable:!0}}),Object.defineProperties(this,i)}}}),Li={add:gi,create:bi,scaleAndAdd:wi,zero:yi,copy:xi},Ci="#FFFFFF",Ii=!0,Ai=2*Math.PI,Si=ui({props:{M202:null},init({radius:t=3,color:i=Ci,opacity:s=1,fill:e=Ii,user_data:n=null}){if(!Number.isFinite(t)||t<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(s)||s<0||s>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if("string"!=typeof i||i.length<3)throw new Error("'color' must be a valid string format ( e.g., '#FFF' or 'red' ).");this.radius=t,this.color=i,this.opacity=s,this.fill=e,this.user_data=n},methods:{render(t){if(t.save(),t.globalAlpha=this.opacity,this.M111){const i=this.getImageAspectRatio();if(Number.isFinite(i)){const s=this.getImage(),e=this.position[0],n=this.position[1],r=(s.width,s.height,this.M10,2*this.radius),h=r*i;t.drawImage(s,e-h/2,n-r/2,h,r)}}else t.beginPath(),t.arc(...this.position,this.radius,0,Ai),this.fill?(t.fillStyle=this.color,t.fill()):(t.strokeStyle=this.color,t.stroke());t.restore()},resetRender(){this.resetImage(),this.fill=Ii}}}),Ti=ui({init({position:t,velocity:i}){this.position=this.validateVector(t),this.velocity=this.validateVector(i),this.acceleration=Li.create()},methods:{applyForce(t){Li.add(this.acceleration,this.acceleration,t)},updatePhysics(t=1){Li.scaleAndAdd(this.velocity,this.velocity,this.acceleration,t),Li.scaleAndAdd(this.position,this.position,this.velocity,t),Li.zero(this.acceleration)},resetPhysics(){Li.zero(this.position),Li.zero(this.velocity),Li.zero(this.acceleration)}}}),Ni=ui({props:{age:0,alive:!1},init({life:t=120}){if(!Number.isFinite(t)||t<=0)throw new Error("'life' must be a positive number.");this.life=t},methods:{updateLife(t=1){return this.age+=t,this.alive=this.age<this.life,this.alive},resetLife(){this.age=0,this.alive=!1}}}),Di=ui({methods:{config(t={}){if(this.opacity=(t.opacity??this.opacity)||1,this.radius=(t.radius??this.radius)||3,this.color=(t.color??this.color)||Ci,this.life=(t.life??this.life)||120,this.fill=t.fill??Ii,t.position&&Li.copy(this.position,this.validateVector(t.position)),t.velocity&&Li.copy(this.velocity,this.validateVector(t.velocity)),!Number.isFinite(this.radius)||this.radius<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(this.opacity)||this.opacity<0||this.opacity>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if(!Number.isFinite(this.life)||this.life<=0)throw new Error("'life' must be a positive number.")}}}),Oi=ui().compose(mi,di,Si,Ti,Ni,Di,ui({methods:{reset(){this.resetRender(),this.resetPhysics(),this.resetLife()}}})),Ri=Ei({init({object_stamp:t,pool_size:i=1e3}){if("function"!=typeof t)throw new Error("'object_stamp' must be a constructor function ( a stamp or factory ).");if(!Number.isInteger(i)||i<=0)throw new Error("'pool_size' must be a positive integer.");this.makeReadOnly({pool_size:i,object_stamp:t})}}),Bi=Ei({init(t,{instance:i}){const s=new Array(this.pool_size);let e=0;const n=new WeakMap;for(let t=0;t<this.pool_size;t++){const i=this.object_stamp();i.reset(),s[t]=i}i._setIndex=function(t,i){n.set(t,i)},i.get=function(){if(e>=this.pool_size)return null;const t=s[e];return n.set(t,e),e++,t},i.free=function(t){const i=n.get(t);if(void 0===i||i>=e)return!1;e--;const r=s[e];return s[e]=t,s[i]=r,t!==r&&n.set(r,i),t.reset(),n.delete(t),!0},i.getActiveCount=function(){return e},i._getPoolArray=function(){return s}}}),Pi=Ei({methods:{M167:function(t){const i=this._getPoolArray();let s=0;for(;s<this.getActiveCount();){const e=i[s];this._setIndex(e,s),!1!==t(e)?s++:this.free(e)}},M203:function(t){this._getPoolArray().forEach(i=>t(i))}}}),Vi=Ei().compose(ki,Ri,Bi,Pi);import{fromValues as Ki,copy as Fi,random as zi,create as Ui}from"vec2";var ji={fromValues:Ki,copy:Fi,random:zi,create:Ui},Gi=ji.create(),Solvna=class{#gs=null;#bs=!1;#ws=null;#ys=-1;#es=null;V32=null;V35=0;V44=0;#hi=!1;#xs=null;#Es=null;#vs=0;#ks=null;#Ls=null;#Cs=null;#Is=null;#As=0;#Ss=0;#Ts=null;constructor(t){this.#ys=this.#Ns(),this.#gs=new Ht({game_name:"SOLVNA",game_designer:"Jean-Baptiste Lévêque",game_build:t,start_page:i.M17("page",jt),page_mode:Ht.K120,on_resize:this.M151.bind(this),on_click:this.M181.bind(this),on_page:this.M204.bind(this)}),this.#es=this.#gs.M180(Gt),this.#vs=this.#gs.M109,this.#hi=this.#gs.M93(),this.#Ds(),this.#Os(),this.#Rs(),this.#Bs(),this.#hi||(this.#gs.M180(Gt).style.visibility="hidden")}M151(t,i,s){this.#ws.M151(t,i,s),this.#ks.width=t,this.#ks.height=i,this.#Ls.width=t,this.#Ls.height=i,this.#vs=s}M181(t,s,e){this.#bs&&(i.M57||this.#hi)&&this.#ws.M181(t,s,e)}M204(t,i){const s=this.#bs;this.#bs=t===Gt,this.#bs&&(this.#gs.M148(),s||window.requestAnimationFrame(this.#Ps.bind(this)),i&&this.#Vs())}M155(i,s){switch(i){default:return;case ci.K57:let i=s.value;Number.isFinite(i)&&!Number.isInteger(i)&&(i=Math.round(i)),this.#Ks(s.key,i);break;case g:const e=t("deck_seed");e&&(e.innerText=s);break;case _:break;case M:this.#Fs(s.position,s.status);break;case p:this.#zs(s);break;case f:this.#Ts=null;break;case m:this.#As=s?1:-1}}async#Bs(){await this.#gs.M123("./assets/theme-2.svg","card-sprite-sheet")}#Vs(){this.#gs.M148(!1),this.#As=0,this.#ws.M214()}#Os(){this.#ws=new ci({on_message_request:(t,i)=>this.M155(t,i),V27:["nr_predictions","nr_predictions_ok","success","nr_completed"],parent_node:this.#gs.M180(Gt)}),this.#ws.M151(this.#gs.M212,this.#gs.M200).M71(this.#ys).M214()}#Rs(){this.#xs=ji.create(),this.#Ss=0;const t=document.createElement("canvas");t.id="canvas_clicks",t.width=window.innerWidth,t.height=window.innerHeight,t.style.zIndex=200,this.#es.appendChild(t);const i=document.createElement("canvas");i.id="canvas_particles",i.width=window.innerWidth,i.height=window.innerHeight,i.style.zIndex=100,this.#es.appendChild(i),this.#Is=t.getContext("2d"),this.#Cs=i.getContext("2d"),this.#Ls=t,this.#ks=i,this.#Es=Vi({object_stamp:Oi,pool_size:1e4}),this.#Es.M203(t=>{t.user_data={click:!0}})}#Ps(t){this.#bs&&(this.#Ss,this.#Ss=t,this.#Es.M167(t=>{if(!t.updateLife())return t.user_data.click=!0,!1}),null!==this.#Ts&&this.#Us(),this.#Is.clearRect(0,0,window.innerWidth,window.innerHeight),this.#Cs.clearRect(0,0,window.innerWidth,window.innerHeight),this.#Es.M167(t=>{t.opacity=s.M161(t.age,t.life,5),t.updatePhysics();const i=t.user_data.click;i&&(t.radius*=1.05),t.render(i?this.#Is:this.#Cs)}),0!==this.#As&&this.M156(this.#Cs,1===this.#As?"SUCCESS":"YOU LOST",this.#vs),window.requestAnimationFrame(this.#Ps.bind(this)))}#Us(){const t=this.#Ts;for(const i of t.stones)for(let t=0;t<5;++t)this.#js(i)}#js(t,i=!0){const e=this.#Es.get();if(!e)return;let n=i?"hsl("+s.M113(40,60)+", 100%, 50%)":"white";e.config({position:t,velocity:ji.random(this.#xs,1),color:n,life:60*s.M75(1,3),radius:s.M75(1,3),opacity:1,fill:!0}),e.user_data.click=!1}#Ns(){let t=i.M17("level",2,!0);return[1,2,3].includes(t)||(t=2),t}#Ds(){t("level").innerHTML=F[this.#ys],t("nr_slots").innerHTML=8}#zs(t){this.#Ts={stones:[...t.stones],prediction:t.prediction}}#Fs(t,i){if(i)return;const s=this.#Es.get();s&&(s.config({position:t,velocity:Gi,color:i?"lime":"darkorange",life:i?60:30,radius:10,opacity:1,fill:!i}),s.user_data.click=!0)}#Ks(i,s){const e=t(i);e&&(e.innerText=s)}M156(t,i="",s=0){const e=t.canvas.width-s,n=t.canvas.height,r=Math.floor(.18*e);t.font="bold "+r+"px card-game",t.fillStyle="rgba( 100, 149, 237, 0.50 )",t.textAlign="center",t.textBaseline="middle",t.fillText(i,e/2,n/2)}};export{Solvna};