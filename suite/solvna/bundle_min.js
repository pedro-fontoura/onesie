// Build: February 4 2026 02:57

export const BUNDLE_URL = import.meta.url.split( '/' ).pop();

export const BUNDLE_ID = "2026-0204-0257";

function t(t){return document.getElementById(t)}class e{static get M58(){return window.location.href.includes("nighthawk.home")}static get M73(){return screen.orientation&&screen.orientation.type?screen.orientation.type.includes("landscape"):window.innerWidth>window.innerHeight}static get M132(){return navigator.maxTouchPoints>0}static get M99(){return navigator.userAgentData&&"Android"===navigator.userAgentData.platform||/android/i.test(navigator.userAgent)}static get M42(){const t=window.matchMedia("(display-mode: standalone)").matches,e=!0===window.navigator.standalone;return t||e}static get M190(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||/Mac/.test(navigator.userAgent)&&navigator.maxTouchPoints>1}static M5(t,e,i){Object.defineProperty(t,e,{value:i,writable:!1,enumerable:!0,configurable:!1})}static M11(t,e){if(!Array.isArray(t))return;const i=t.indexOf(e);-1!==i&&t.splice(i,1)}static M12(t){if(!Array.isArray(t))return t;for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}static M27(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}static M100(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}static M17(t,e=null,i=!1){let s=new URLSearchParams(window.location.search).get(t);if(null===s)return e;if(i){const t=parseInt(s,10);return isNaN(t)?e:t}return s}static M74(t,e=document.documentElement,i=null){t.startsWith("--")||(t="--"+t);const s=window.getComputedStyle(e).getPropertyValue(t).trim();return""===s?i:s.replace(/^['"]|['"]$/g,"")}static M18(){if(e.M190)return;const t=document.documentElement,i=t.requestFullscreen||t.webkitRequestFullscreen;if(!i)return;const s=e.M99?{navigationUI:"hide"}:{};i.call(t,s).catch(t=>{})}static M19(t){const e=document.querySelector('script[type="importmap"]');if(!e)throw new Error('GetImportMapValue » <script type="importmap"> not found in DOM.');const i=JSON.parse(e.textContent),s=i.imports?.[t];if(void 0===s)throw new Error("GetImportMapValue » Key not found in imports: "+t);return s}static M59(t,e=0){if("string"!=typeof t)return t;let i="";for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);i+=String.fromCharCode(n+e)}return i}static M161(t,e,i){const s=t.style;s.width=e+"px",s.height=i+"px"}static M115(t,e,i,s,n){const r=t.style;r.width=e+"px",r.height=i+"px",r.left=s+"px",r.top=n+"px"}}class i{static get M191(){return(1+Math.sqrt(5))/2}static get M192(){return 2*Math.PI}static get M162(){return Math.PI/2}static get M75(){return Math.PI/180}static get M60(){return 180/Math.PI}static M163(t){return t*i.M75}static M164(t){return t*i.M60}static M116(t,e){return Math.floor(Math.random()*(e-t+1))+t}static M76(t,e){return t+Math.random()*(e-t)}static M61(t=.5){return Math.random()<t}static M29(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}static M222(t,e,i){return t+(e-t)*i}static M212(t,e,i,s,n){return s+(t-e)*(n-s)/(i-e)}static M213(t,e,i){return Math.max(e,Math.min(t,i))}static M133(t,e,i,s){return Math.hypot(i-t,s-e)}static M165(t,e,i=2){if(e<=0)return 0;const s=t/e;return 1-Math.pow(s,i)}}var s="busy",n="predict",r="eval",o="eval_ok",h="eval_nk",a="turn_ended",l="rm_stones",c="success",d="fail",u="user_error",_="ui_choice",M="ui_click",p="MSG_STONES_ON",f="MSG_STONES_OFF",m="MSG_GAME_OVER",g="deck_seed",b="R",y="RO",w="BE",x="E",v="D",E="H",k="S",L="C",C="O",S="BO",I="RE",N="B",A=y,T=w,D=S,O=I,R={[b]:"Red",[y]:"Red Odd",[w]:"Black Even",[x]:"Even",[v]:"Diamonds",[E]:"Hearts",[k]:"Spades",[L]:"Clubs",[C]:"Odd",[S]:"Black Odd",[I]:"Red Even",[N]:"Black"},P=[["R"],[y,w],["E"],["D","H"],["S","C"],["O"],[S,I],["B"]],V=0,B=1,K=2,F={[V]:"Easy",[B]:"Normal",[K]:"Hard"},z="DECK",U="TABLE",G=Object.defineProperty,j=class t{static K136=100;static K140=199;static K20=100;#t=0;#e=0;#i=100;#s=-1;#n=0;#r=0;#o=null;#h=null;#a=!1;#l=0;#c=0;#d=0;#u=0;#_=0;#M=0;#p=!1;#f=[];#m=!0;#g=!1;constructor(i,s,n=!1,r=0,o={}){e.M5(this,"IDX",i),e.M5(this,"ID",s);const{parent:h=null,is_box:a=!1}=o;e.M5(this,"IS_BOX",a),this.#l=r||t.K20,!0===n?this.#o=document.createElement("div"):n instanceof Node&&(this.#o=n),this.#o&&(this.#b(),h instanceof Node&&h.appendChild(this.#o))}#b(){e.M5(this,"ELEMENT",this.#o),this.#o.id=this.ID,this.#o.style.position="absolute",this.#o.style.top="0px",this.#o.style.left="0px",this.#o.style.zIndex=this.#i,this.#o.classList.add("FlexBoxEntity"),this.#o.dataset.smooth=this.#a?"yes":"no",this.#o.addEventListener("transitionend",this.#y.bind(this))}M166(){return this.#o&&(this.#o.remove(),this.#o=null,this.#f=null),this}M77(){return this.#o.offsetWidth,this}M101(){return this.#o}M134(){return this.#n}M117(){return this.#r}M193(){return this.#t}M167(){return this.#e}M115(t,e,i,s){this.#n=0|t,this.#r=0|e,s|=0,i|=0;const n=this.#t!==s||this.#e!==i;return n&&(this.#t=s,this.#e=i),this.#w(n),this}#x(){const t=window.getComputedStyle(this.#o).translate;t&&"none"!==t||(this.#d=0,this.#c=0);const e=t.split(" ");this.#d=parseFloat(e[0])||0,this.#c=parseFloat(e[1])||0}M78(t,e){if(t|=0,e|=0,this.#t===e&&this.#e===t)return this;if(this.#a){const i=this.M1(t,e);this.#v(i)}return this.#t=e,this.#e=t,this.#w(!0),this}M1(t,e){this.#x();const i=t-this.#d,s=e-this.#c;return Math.sqrt(i*i+s*s)/this.#l}M161(t,e){return t|=0,e|=0,this.#n===t&&this.#r===e||(this.#n=t,this.#r=e,this.#w(!1)),this}#w(t=!0){this.#E();const e=this.#o.style;e.width=this.#n+"px",e.height=this.#r+"px",t?(e.translate=this.#e+"px "+this.#t+"px 0px",this.#a&&(e.zIndex=199+this.#s)):e.zIndex=this.#i}#y(t){"translate"===t.propertyName&&(this.#x(),Math.abs(this.#d-this.#e)<1&&Math.abs(this.#c-this.#t)<1&&(this.#o.style.zIndex=this.#i,this.#p&&this.#k()))}M43(){return this.#M>0}M135(){return this.#M>0}M136(){return this.#M>0}#k(){const t=this.#f.length;for(let e=0;e<t;e++)this.#f[e](this);this.#f.length=0}M118(t=!0){return this.#a=!!t,this.#o.dataset.smooth=this.#a?"yes":"no",this}M137(){return this.#a}M79(t){return"function"!=typeof t?this:this.#p?(this.#f.push(t),this):void 0}M6(){this.#f.length=0}M13(t=!0){return this.#p=!!t,this}Error(t,e,...i){this.constructor.name,i.length>0&&i.forEach((t,e)=>{})}M119(){return this.#s}M120(t=-1){return this.#s=t,this}M194(t,e=-1){return null!==this.#h?(this.Error("SetBox","Already set",this.#h,t),this):(this.#h=t,e>=0&&(this.#s=e),this)}M138(){return this.#h=null,this.#s=-1,this}M195(){return this.#h}M223(t){return this.#h===t}M196(){return null!==this.#h}#v(t){return!Number.isFinite(t)||t<0?(this.Error("SetTranslationTime","Bad number",t),this):this.#o?(this.#o.style.transitionDuration=t+"ms",this):this}M30(e=0){return this.#l=e||t.K20,this}M224(t){return t|=0,this.#i===t||(this.#i=t,this.#o.style.zIndex=t),this}M139(t){return!Number.isFinite(t)||t<0?(this.Error("SetBaseZ","Bad number",t),this):(t|=0,this.#i<t&&(this.#i=t),this.#o.style.zIndex=t,this)}#E(){this.#u=this.#t+(this.#r>>1),this.#_=this.#e+(this.#n>>1)}M62(){return this.#u}M44(){return this.#_}M4(t,e){const i=t-this.#e,s=e-this.#t;return Math.sqrt(i*i+s*s)/this.#l}M121(){return this.#m}M140(){return!this.#m}M102(t=!0){return t=!!t,this.#m===t||(this.#m=t,this.M15(t)),this}M45(){return this.#m=!this.#m,this.M15(this.#m),this}M103(){return this.#g}M80(t=!0){return t=!!t,this.#g===t||(this.#g=t,this.M20(t)),this}M35(){return this.#g=!this.#g,this.M20(this.#g),this}},H=1/0,q=class extends j{static ROW=11;static COLUMN=12;static K137=3;static K141=1;static K148=2;static K138=4;static K131=5;static K139=6;static K142=7;#L=11;#C=!0;#S=[];#I=null;#N=null;#A=null;#T=H;#D=0;#O=0;#R=0;#P=0;#V=!1;#B=0;#K=0;#F=!1;#z=0;#U=0;#G=j.K136;#j=null;#H=null;#q=null;#$=null;#W=!1;#X=0;#Y=!1;constructor(t,e,i,s,n,r=!1,o={}){const{max_count:h=H,sorting:a=null,tuck:l=!1,uniform:c=!1,parent:d=null,velocity_px_ms:u=0,reverse_z:_=!1}=o;super(t,e,r,u,{is_box:!0,parent:d}),this.#T=h,this.M81(_),this.#L=i,11!==i&&12!==i&&this.Error("FlexBox","Bad orientation",i),this.#C=11===this.#L,"function"==typeof a&&(this.#I=a);const M=Number.isFinite(this.#T)?this.#T:64;this.#j=new Int32Array(M),this.#H=new Int32Array(M),s=s||4,this.#A=this.#Q(s),3!==(n=n||3)&&1!==n&&2!==n&&this.Error("FlexBox","Bad align",n),this.#N=this.#Q(n),this.#F=c,l>0&&this.M168(l),this.ELEMENT&&this.ELEMENT.classList.add("FlexBox")}M166(){super.M166(),this.#S=null,this.#N=null,this.#A=null,this.#I=null}#J(t,e){if(t.length<e){const i=t.length<<1;t=new Int32Array(i>e?i:e)}return t}M233(t,e=!0){if(!(t instanceof j))return this.Error("Add","Not a FlexBoxEntity",t),this;if(this.#S.includes(t))return this.Error("Add","Already here",t),this;if(this.M200())return this.Error("Add","I am full",t),this;t.M196()&&t.M195().M199(t),e?this.#S.push(t):this.#S.unshift(t);const i=this.#S.length;let s=!e&&i>1;return t.M194(this,e?this.#S.length-1:0),this.#J(this.#j,i),this.#J(this.#H,i),null!==this.#I&&(this.#S.sort(this.#I),s=!0),s&&this.#Z(),this.#F?(0!==this.#z&&0!=this.#U||(this.#z=t.M134(),this.#U=t.M117(),this.#W>0&&this.#tt()),this.#B+=this.#z,this.#K+=this.#U):(this.#B+=t.M134(),this.#K+=t.M117()),this.#V=!0,this.M7(),this}M197(t){return this.M233(t,!1)}M198(t){return this.M233(t,!0)}M199(t){return t instanceof j?this.#S.includes(t)?(t.M138(),t.M6(),e.M11(this.#S,t),this.#Z(),this.#F?(this.#B-=this.#z,this.#K-=this.#U):(this.#B-=t.M134(),this.#K-=t.M117()),this.#V=!0,this.M7(),this):(this.Error("Remove","Not here",t.ID),this):(this.Error("Remove","Not a FlexBoxEntity",t),this)}M161(t,e){t|=0,e|=0,super.M161(t,e),this.#D=t,this.#O=e}M115(t,e,i,s,n=!0){return t|=0,e|=0,i|=0,s|=0,super.M115(t,e,i,s),this.#D=t,this.#O=e,this.#P=i,this.#R=s,n&&this.M7(),this}M31(t,e,i=-1){return this.#z=0|t,this.#U=0|e,this.#W>0&&this.#tt(),this.#F=!0,this.#V=!1,i>=0&&(this.#G=i),this.M14(),this}M81(t=!0){this.#Y=!!t,this.M7()}M32(t=-1){t>=0&&(this.#G=0|t)}M14(){let t=0,e=0;const i=this.#S.length;if(i>0){if(this.#F){if(0===this.#z||0===this.#U){const t=this.#S[0];this.#z=t.M134(),this.#U=t.M117(),this.#W>0&&this.#tt()}t=i*this.#z,e=i*this.#U}else for(let s,n=0;n<i;n++)s=this.#S[n],t+=s.M134(),e+=s.M117();(isNaN(t)||isNaN(e))&&this.Error("UpdateEntitiesSize","total width/height is NaN"),(t<0||e<0)&&this.Error("UpdateEntitiesSize","total width/height is negative",t,e)}return this.#B=t,this.#K=e,this.#V=!0,this}#et(t=-1){if(-1===t&&(t=this.#S.length),0===t)return this;this.#V||this.M14();const e=this.#C;let i=e?this.#B:this.#K,s=this.#W&&t>1;if(s){const n=e?this.#D:this.#O;s=i>n,s&&(this.#it(t,n,i),i-=(t-1)*this.#X)}return e?(this.#q=this.#A(!0,!0,i,t),this.#$=this.#N(!1,!1,this.#K,t)):(this.#$=this.#A(!0,!1,i,t),this.#q=this.#N(!1,!0,this.#B,t)),s&&this.#st(e,t),t}#it(t,e,i){this.#C?this.#z:this.#U;const s=(i-e)/(t-1);this.#X=s}#st(t,e){const i=t?this.#q:this.#$;for(let t=1;t<e;t++)i[t]-=t*this.#X}M168(t=!0){this.#W=!!t,this.#W&&this.M7()}M141(t){return this.#F||0===t?t<0||t>1?(this.Error("SetTuck","Tuck must be [ 0 .. 1 ]",t),this):(this.#W=t,this.#tt(),void(this.#S.length>1&&this.M7())):(this.Error("SetTuck","Cannot tuck non-uniform entities"),this)}#tt(){if(!this.#F)return void(this.#X=0);const t=this.#C?this.#z:this.#U;this.#X=t*this.#W|0}M78(t,e){super.M78(t,e),this.#P=t,this.#R=e}M7(t=!0){const e=this.#S.length;if(0===e)return this;t&&this.#et(e);const i=this.#G;for(let t=0;t<e;t++){const s=this.#S[t];this.#Y?s.M224(i+(e-t)):s.M224(i+t),s.M78(this.#q[t],this.#$[t]),s.IS_BOX&&s.M7(!0)}return this}#nt(t,e=-1){if(e<0&&(e=t.M119()),this.#Y){const i=this.#S.length;t.M224(this.#G+(i-e))}else t.M224(this.#G+e);return t.M78(this.#q[e],this.#$[e]),this}#Q(t){switch(t){case 3:return this.#rt.bind(this);case 1:return this.#ot.bind(this);case 2:return this.#ht.bind(this);case 4:return this.#at.bind(this);case 5:return this.#lt.bind(this);case 6:return this.#ct.bind(this);case 7:return this.#dt.bind(this)}}#ut(t,e,i){const s=(t?this.#j:this.#H).subarray(0,i),n=e?this.#P:this.#R;var r=e?this.#z:this.#U;if(t&&this.#F)for(var o=0;o<i;++o)s[o]=n+o*r;else{var h=n;for(o=0;o<i;++o){if(t&&o>0){if(!this.#F){const t=this.#S[o-1];r=e?t.M134():t.M117()}h+=r}s[o]=h}}return s}#ot(t,e,i,s){return this.#ut(t,e,s)}#rt(t,e,i,s){const n=this.#ut(t,e,s),r=e?this.#D:this.#O,o=r-i>>1;var h=e?this.#z:this.#U;if(!t&&this.#F){const t=r-h>>1;for(var a=0;a<s;++a)n[a]+=t}else for(a=0;a<s;++a)if(t)n[a]+=o;else{if(!this.#F){const t=this.#S[a];h=e?t.M134():t.M117()}n[a]+=r-h>>1}return n}#ht(t,e,i,s){const n=this.#ut(t,e,s),r=e?this.#D:this.#O,o=Math.round(r-i);var h=e?this.#z:this.#U;if(!t&&this.#F){const t=r-h;for(var a=0;a<s;++a)n[a]+=t}else for(a=0;a<s;++a)if(t)n[a]+=o;else{if(!this.#F){const t=this.#S[a];h=e?t.M134():t.M117()}n[a]+=r-h}return n}#dt(t,e,i,s){const n=this.#ut(t,e,s),r=(e?this.#D:this.#O)>>1;var o=e?this.#z:this.#U;const h=n[0];for(var a=0;a<s;++a){if(!this.#F){const t=this.#S[a];o=e?t.M134():t.M117()}n[a]=h+r-(o>>1)}return n}#lt(t,e,i,s){if(s<2)return this.#ot(t,e,i,s);const n=this.#ut(t,e,s),r=e?this.#D:this.#O,o=Math.round((r-i)/(s-1));for(var h=1;h<s;++h)n[h]+=h*o;return n}#at(t,e,i,s){const n=this.#ut(t,e,s),r=e?this.#D:this.#O,o=Math.round((r-i)/(s+1));for(let t=0;t<s;++t)n[t]+=(t+1)*o;return n}#ct(t,e,i,s){if(s<2)return this.#rt(t,e,i,s);const n=this.#ut(t,e,s),r=((e?this.#D:this.#O)-i)/s,o=r>>1;for(let t=0;t<s;++t)n[t]+=o+t*r|0;return n}M82(t){return!Number.isFinite(t)||t<=0?(this.Error("SetMaxCount","Bad number",t),this):(this.#T=0|t,this)}M83(){return this.#T}M200(){return this.#S.length>=this.#T}M104(t){return"function"!=typeof t||(this.#I=t),this}M105(t){return this.#A=this.#Q(t||4),this}M225(t){return"function"!=typeof t&&(t=this.#I),"function"!=typeof t||(this.#S.sort(t),this.#Z(),this.M7()),this}#Z(t=-1){if(t<0&&(t=this.#S.length),!(t<0))for(let e=0;e<t;++e)this.#S[e].M120(e)}M169(){const t=this.#S.length;return t<=1||(M12(this.#S),this.#Z(t),this.M7()),this}M170(){return 0===this.#S.length}M142(t){return this.#S.includes(t)}M143(){return this.#S.length}M171(t){if("function"!=typeof t)return this;const e=this.#S.length;for(let i,s=0;s<e;s++)i=this.#S[s],t(i);return this}M172(){return this.#S.length>0?this.#S[0]:null}M106(){if(this.#S.length<=0)return null;const t=this.#S[0];return this.M199(t),t}M173(){const t=this.#S.length;return t>0?this.#S[t-1]:null}M107(){const t=this.#S.length;if(t<=0)return null;const e=this.#S[t-1];return this.M199(e),e}M84(t){return t<0||t>=this.#S.length?(this.Error("GetEntityAt","Bad idx",t),null):this.#S[t]}M201(){return[...this.#S]}M85(t){return"function"!=typeof t?null:this.#S.filter(t)}M214(){const t=this.#S.length;if(0===t)return this;for(let e=0;e<t;e++){const t=this.#S[e];t.M138(),t.M6()}return this.#S.length=0,this.#B=0,this.#K=0,this.#V=!0,this}#_t(t=0){const e=this.#S.length+t;return e>this.#T?(this.Error("#PrepareBatchAdd","Total exceeds max_count",e),this):(e>0&&(this.#j=this.#J(this.#j,e),this.#H=this.#J(this.#H,e)),this)}M144(t,e=!0,i=0){const s=t.length;if(0===s)return this;if(this.M200())return this.Error("BatchAdd","I am full"),this;const n=this.M143()+s;if(n>this.M83())return this.Error("BatchAdd","Not enough space"),this;for(let e=0;e<s;e++){const i=t[e];if(!(i instanceof j))return this.Error("BatchAdd","Not a FlexBoxEntity",i),this;if(this.#S.includes(i))return this.Error("BatchAdd","Already here",i),this}const r=[...this.#S],o=r.length;this.#_t(s);for(let i=0;i<s;i++){const s=t[i];s.M196()&&s.M195().M199(s),s.M194(this),e?this.#S.push(s):this.#S.unshift(s);const n=this.#F?this.#z:s.M134(),r=this.#F?this.#U:s.M117();this.#B+=n,this.#K+=r}this.#V=!0,null!==this.#I&&this.#S.sort(this.#I),this.#Z(n),this.#et(n);for(let t=0;t<o;t++){const e=r[t];this.#nt(e)}if(0===i)for(let e=0;e<s;e++){const i=t[e];this.#nt(i)}else{let e=i;i<=1&&(e=this.M2(t[0])*i);let n=0;for(let i=0;i<s;i++){const s=t[i];setTimeout(()=>{this.#nt(s)},n),n+=e}}return this}M86(t=null,i=0){const s=null===t?[...this.#S]:t,n=s.length;if(0===n)return this;for(let t=0;t<n;t++){const e=s[t];if(!(e instanceof j))return this.Error("BatchRemove","Not a FlexBoxEntity",e),this;if(!this.#S.includes(e))return this.Error("BatchRemove","Not here",e),this}for(let t=n-1;t>=0;t--){const i=s[t];e.M11(this.#S,i),i.M138(),i.M6();const n=this.#F?this.#z:i.M134(),r=this.#F?this.#U:i.M117();this.#B-=n,this.#K-=r}this.#V=!0;const r=this.#S,o=r.length;if(this.#Z(o),this.#et(o),0===i)this.M7(!1);else{let t=i;i<=1&&(t=this.M2(r[0])*i);let e=t;for(let i=0;i<o;i++){const s=r[i];setTimeout(()=>this.#nt(s),e),e+=t}}return this}M2(t){if(!t.M223(this))return this.Error("GetEntityTranslationTime","Not here",t),0;const e=t.M119();return e<0||e>=this.#S.length?(this.Error("GetEntityTranslationTime","Bad index",t),0):t.M1(this.#q[e],this.#$[e])}M3(t){return t.EstimateTravelTime(this.M44(),this.M62())}M174(t=""){for(let t=0;t<this.#S.length;++t)this.#S[t];return!0}},$={smooth:!0,touch_down_events:!1,visible:!1,selected:!1,velocity_px_ms:1,flip_time:500,face_up:!0,flip_axis:"y"},W=class t extends j{static K136=110;#Mt=null;#pt=null;#ft=null;#mt=$.face_up;constructor(t){super(t,"Card_"+t,!0),this.#gt(t),e.M5(this,"BODY",this.#Mt),e.M5(this,"FACE",this.#pt),e.M5(this,"BACK",this.#ft),this.M215()}M166(){super.M166()}M215(e={}){for(const t in $){const i=e[t]??$[t];e[t]=i}this.M196()&&this.M195().M199(this),this.M6(),this.M118(e.smooth),this.M13(e.touch_down_events),this.M30(e.velocity_px_ms),this.M102(e.visible),this.M80(e.selected),this.M224(t.K136),this.M87(e.flip_time),this.M122(e.face_up),this.M88(e.flip_axis)}#gt(e){this.ELEMENT.classList.add("Card"),this.#Mt=document.createElement("div"),this.#Mt.classList.add("CardBody"),this.#Mt.classList.add("Clickable"),this.#Mt.dataset.idx=e,this.#Mt.card=this,this.#Mt.dataset.face=this.#mt?"up":"no",this.#Mt.dataset.visible=this.M121()?"yes":"no",this.#pt=document.createElement("div"),this.#pt.classList.add("CardFace"),this.#ft=document.createElement("div"),this.#ft.classList.add("CardBack"),this.#Mt.appendChild(this.#pt),this.#Mt.appendChild(this.#ft),this.ELEMENT.appendChild(this.#Mt),this.M139(t.K136)}M8(){return this.#Mt}M122(t=!0){return this.#mt=!!t,this.#Mt.dataset.face=this.#mt?"up":"down",this.OnFlip&&this.OnFlip(t),this}M145(){return this.#mt}M108(){return!this.#mt}M15(t){return this.#Mt.dataset.visible=t?"yes":"no",this}M20(t){return this.#Mt.dataset.selected=t?"yes":"no",this}M87(t){return!Number.isFinite(t)||t<0?(this.Error("SetFlipTime","Bad number",t),this):(this.#Mt.style.transitionDuration=t+"ms",this)}M88(t="x"){if("string"!=typeof t||1!==t.length)return this.Error("SetFlipAxis","Bad axis",t),this;if("x"!==(t=t.toLowerCase())&&"y"!==t)return this.Error("SetFlipAxis","Bad axis",t),this;const e="x"===t?"1":"0",i="y"===t?"1":"0";return this.#Mt.style.setProperty("--ROT_X",e),this.#Mt.style.setProperty("--ROT_Y",i),this}M226(){return this.#mt=!this.#mt,this.#Mt.dataset.face=this.#mt?"up":"down",this.OnFlip&&this.OnFlip(this),this}},X={};((t,e)=>{for(var i in e)G(t,i,{get:e[i],enumerable:!0})})(X,{K69:()=>nt,K70:()=>ot,K116:()=>rt,K90:()=>_t,K91:()=>vt,K92:()=>st,K117:()=>et,K118:()=>it,K21:()=>yt,K22:()=>bt,K126:()=>pt,K119:()=>ft,K93:()=>Mt,K120:()=>gt,K94:()=>wt,K95:()=>mt,K56:()=>xt,K71:()=>J,K72:()=>Z,K96:()=>Y,K23:()=>tt,K97:()=>Q,K143:()=>dt,K98:()=>ht,K31:()=>at,K73:()=>ct,K99:()=>ut,K74:()=>lt});var Y=0,Q=6,J=10,Z=14,tt=15,et=63,it=15,st=15,nt=1<<J,rt=2<<J,ot={[nt]:"Black",[rt]:"Red"},ht=1<<Q,at=2<<Q,lt=3<<Q,ct=4<<Q,dt=[ht,at,lt,ct].sort(),ut={[ht]:"Clubs",[at]:"Diamonds",[ct]:"Hearts",[lt]:"Spades"},_t=1<<Z,Mt=0,pt=1,ft=11,mt=12,gt=13,bt=Math.min(ft,mt,gt),yt=Math.max(ft,mt,gt),wt={[pt]:"Ace",[ft]:"Jack",[mt]:"Queen",[gt]:"King"},xt={[pt]:"A",[ft]:"J",[mt]:"Q",[gt]:"K"},vt={name:"Joker",suit:"joker",symbol:"JKR",rank:Mt,flag:_t},Et=class extends W{#bt=!1;#yt=!1;#wt=null;constructor(t,i){super(t),e.M5(this,"DNA",i);const s=i&et,n=i&it<<Q,r=i&st<<J;e.M5(this,"RANK",s),e.M5(this,"SUIT",n),e.M5(this,"COLOR",r),this.#bt=0!==(i&_t),this.#yt=!this.#bt&&this.RANK>=bt&&this.RANK<=yt,this.#xt(),this.#vt()}M146(){return"("+this.IDX+") "+this.M89()+" of "+this.M90()}#xt(){const t=this.M89().toLowerCase(),e=this.M90().toLowerCase(),i=this.M216()?"red":"black",s=this.BODY;s.dataset.rank=t,s.dataset.suit=e,s.dataset.color=i,this.#bt?s.dataset.joker="yes":this.#yt&&(s.dataset.royal="yes")}#vt(){const t=this.M47().toUpperCase(),e=this.M90();this.FACE.innerHTML="";const i=document.createElement("p");i.innerText=t,this.#wt=i,this.#yt&&this.M46(this.RANK),this.FACE.appendChild(this.#wt);{const t=this.#Et(e.toLowerCase());this.FACE.appendChild(t)}}M46(t){const e=document.createElement("span");e.innerText=t,this.#wt.appendChild(e)}#Et(t){this.M216();const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("class","SuitIcon"),e.innerHTML=`<use href="#suit-${t}"/>`,e}M161(t,e){super.M161(t,e),this.FACE.style.fontSize=Math.round(.4*t)+"px"}static async M123(t){try{const e=M19("flex-box/"),i=await fetch(e+t),s=await i.text(),n=document.getElementById("card-sprite-sheet");n&&n.remove();const r=document.createElement("div");r.id="card-sprite-sheet",r.style.display="none",r.innerHTML=s,document.body.appendChild(r)}catch(t){}}M216(){return this.COLOR===rt}M175(){return this.COLOR===nt}M176(){return this.#bt}M177(){return this.#yt}M147(){return!this.#bt&&!this.#yt}M217(){return this.RANK===pt}M202(){return this.RANK===ft}M178(){return this.RANK===mt}M203(){return this.RANK===gt}M204(){return this.RANK%2==0}M218(){return this.RANK%2!=0}M205(t){return this.SUIT===t}M89(){return this.#bt?vt.name:wt[this.RANK]||this.RANK.toString()}M90(){return this.#bt?vt.suit:ut[this.SUIT]||"Unknown"}M47(){return this.#bt?vt.symbol:xt[this.RANK]||this.M89()}M63(){return ot[this.COLOR]||"Unknown"}},kt=1/0,Lt=!0,Ct=!0,St=class extends q{#mt=Ct;#kt=Lt;constructor(t,e,i,s,n,r,o={}){const{max_cards:h=kt,flip_after:a=Lt,face_up:l=Ct,sorting:c=null,tuck:d=!1,uniform:u=!0,parent:_=null,reverse_z:M=!1}=o;super(t,e,i,s,n,r,{max_count:h,sorting:c,tuck:d,uniform:u,parent:_,reverse_z:M}),this.M32(Et.K136),this.ELEMENT&&this.ELEMENT.classList.add("BoxOfCards"),this.M122(l),this.M64(a)}#Lt(t,e){t.M122(e)}M233(t,e=!0){return t instanceof Et?(super.M233(t,e),this.#kt?t.M79(this.#Lt.bind(this,t,this.#mt)):t.M122(this.#mt),this):(this.Error("Add","Not a Card instance",t),this)}M197(t){return this.M233(t,!1)}M198(t){return this.M233(t,!0)}M142(t){return t instanceof Et?super.M142(t):(this.Error("Includes","Not a Card instance",t),this)}M144(t,e=!0,i=0){const s=t.length;if(0===s)return this;for(let e=0;e<s;e++){const i=t[e];if(!(i instanceof Et))return this.Error("BatchAdd","Not a Card instance",i),this}if(this.M143()+s>this.M83())return this.Error("BatchAdd","I am full"),this;super.M144(t,e,i);for(let e=0;e<s;e++){const i=t[e];this.#kt?i.M79(this.#Lt.bind(this,i,this.#mt)):i.M122(this.#mt)}return this}M199(t){return t instanceof Et?(super.M199(t),this):(this.Error("Remove","Not a Card instance",t),this)}M86(t=null,e=0){const i=null===t?[...this.GetEntities()]:t,s=i.length;if(0===s)return this;for(let t=0;t<s;t++){const e=i[t];if(!(e instanceof Et))return this.Error("Remove","Not a Card instance",e),this}return super.M86(t,e),this}M124(t){return super.M84(t)}M122(t=!0){return this.#mt=!!t,this}M64(t=!0){return this.#kt=!!t,this}};function It(t,e){return t.IDX-e.IDX}var Nt=class{#Ct=[];#St=[];#It=[];#Nt=null;#At=0;#Tt=[];constructor(t={},e={}){const{jokers:i=0,exclude_ranks:s=[],exclude_cards:n=[],suits:r=dt,seed:o=0}=t;this.#At=o,this.#Dt(r,s,n,i),this.#Nt={smooth:e.smooth??!0,touch_down_events:e.touch_down_events??!0,velocity_px_ms:e.velocity_px_ms??100,flip_time:e.flip_time??500,face_up:e.face_up??!0,visible:e.visible??!0,flip_axis:e.flip_axis??"y"},this.M215()}#Ot(t,e,i){return(t&et)===e&&(t&it<<Q)===i}#Dt(t,e,i,s){for(const s of t){const t=s===at||s===ct?rt:nt;for(let n=1;n<=13;n++){if(e.includes(n))continue;if(i.some(t=>this.#Ot(n|s,t.rank,t.suit)))continue;const r=n|s|t,o=new Et(this.#Ct.length,r);this.#Ct.push(o)}}for(let t=0;t<s;t++){const e=_t|(t%2==0?nt:rt),i=new Et(this.#Ct.length,e);this.#Ct.push(i)}}M91(t){let e=0;for(const i of t)for(let t=0;t<this.#Ct.length;++t){const s=this.#Ct[t];if(this.#Ot(s.DNA,i.rank,i.suit)){e+=1,this.#Ct.splice(t,1),this.#Tt.push(s);break}}this.#Rt()}M65(t){}#Rt(){this.#It=[],this.#St=this.#Ct.map((t,e)=>e)}M215(t={}){this.#Rt();const e=new Set;this.#Ct.forEach(t=>{const i=t.M195();i&&e.add(i)}),e.forEach(t=>t.M214());const i=this.#Nt;for(const e in t)i.hasOwnProperty(e)&&(i[e]=t[e]);for(const t of this.#Ct)t.M215(i);return this}M227(t=null,e=0){if(null===t)return this;const i=this.M180(),s=e>0;return this.M171(t=>{t.M102(s),t.M118(s),t.M87(0),t.M122(!1)}),t.M144(i,!0,e>0?e:0),this.M171(t=>{t.M87(this.#Nt.flip_time),t.M118(this.#Nt.smooth)}),this}M169(t=0){let i=Math.random;0!==(t=t||this.#At)&&(t="string"==typeof t?M100(t):t,i=e.M27(t));const s=this.#St;for(let t=s.length-1;t>0;t--){const e=Math.floor(i()*(t+1));[s[t],s[e]]=[s[e],s[t]]}return this}M179(t=0){return this.#At="string"==typeof t?M100(t):0|t,this.#At}M228(){if(0===this.#St.length)return null;const t=this.#St.pop();return this.#It.push(t),this.#Ct[t]}M180(){const t=[];return this.#St.forEach(e=>{t.push(this.#Ct[e])}),this.#It=this.#St,this.#St=[],t}M148(){const t=this.#St[this.#St.length-1];return this.M181(t)}M181(t){return this.#Ct[t]}M48(t){if("function"!=typeof t)return[];const e=[];for(let i=this.#St.length-1;i>=0;i--){const s=this.#St[i],n=this.#Ct[s];t(n)&&(this.#St.splice(i,1),this.#It.push(s),e.push(n))}return e}M66(t,e){t|=0,e|=0,this.#Ct.forEach(i=>i.M161(t,e))}M182(){return this.#Ct.length}M21(){return this.#St.length}M171(t){return"function"!=typeof t||this.#Ct.forEach((e,i)=>t(e,i)),this}M22(t,e){const i=t.SUIT,s=e.SUIT;return i<s?-1:i>s?1:Math.sign(t.RANK-e.RANK)}},At="off",Tt=class extends St{static K75=At;static K76="top";static K32="right";static K24="bottom";static K57="left";#Pt=null;#Vt=!1;#Bt=0;#Kt=null;constructor(t,i,s={}){const{max_cards:n=1/0,counter_position:r=At,pop_effect:o=!1,face_up:h=!0,parent:a=null}=s;super(t,i,q.ROW,q.K142,q.K137,!0,{max_cards:n,parent:a}),this.#Ft(),this.#zt(),this.M16(r),this.M67(o),this.M122(h),e.M5(this,"COUNTER",this.#Pt)}#Ft(){const t=this.ELEMENT;t.classList.add("PileOfCards");const e=document.createElement("span");e.classList.add("PileCounter"),e.innerText="0",t.appendChild(e),this.#Pt=e}M233(t,e=!0){return super.M233(t,e),this.#Ut(t,e),this}#Ut(t,e=!0){t.M137()?(this.#Bt++,t.M79(()=>{this.#Bt--,this.#zt(),this.#Gt(e?t:null),e||this.#Kt===t||t.M102(!1)})):(this.#Gt(e?t:null),e||this.#Kt===t||t.M102(!1),this.#zt())}#Gt(t=null){const e=this.M143();if(0===e)return;const i=this.#Kt;if(null===t)for(let i=e-1-this.#Bt;i>=0;--i){const e=this.M84(i);if(!e.M135()){t=e;break}}i!==t&&(i&&i.M102(!1),this.#Kt=t,t.M102(!0))}M144(t,e=!0){super.M144(t,e);const i=t.length;let s;for(let e=0;e<i;e++)s=t[e],s.M102(!1);return this.#zt(),this.#Gt(e?s:null),this}M199(t){return super.M199(t),this.#jt(t),this}#jt(t,e=!0){t.M102(!0),t.M135()&&this.#Bt--,e&&(this.#Kt===t&&(this.#Kt=null,this.#Gt(null)),this.#zt())}M86(t=null,e=0){const i=this.#Kt,s=null===t?[...this.GetEntities()]:t,n=s.length;if(0===n)return this;super.M86(t,e);for(let t=0;t<n;t++){const e=s[t];this.#jt(e,!1)}return s.includes(i)&&this.#Gt(),this.#zt(),this}M214(){return super.M214(),this.#Kt=null,this.#Bt=0,this.#zt(),this}M149(t){return this.M233(t,!0)}M92(t){return this.M233(t,!1)}M93(){const t=this.M173();return t&&this.M199(t),t}M36(){const t=this.M172();return t&&this.M199(t),t}M193(){return this.M173()}M125(){return this.M172()}M169(){const t=this.M143();if(t>0&&this.#Ht(),t<=1)return;const e=this.#Kt;super.M169();const i=this.M84(t-1);return e!==i&&(e.M102(!1),i.M102(!0),this.#Kt=i),this}M16(t){return this.ELEMENT.dataset.counter=t,this}M67(t){return this.#Vt=!!t,this}#zt(){const t=this.M143()-this.#Bt;this.#Pt.innerText=t,this.#Vt&&this.#Ht()}#Ht(){const t=this.#Pt;t.classList.remove("PopEffect"),this.M77(),t.classList.add("PopEffect")}debug(){const t=this.M143();for(let e=0;e<t;++e)this.M84(e)}M183(){const t=this.M143();return 0===t?null:this.M84(t-1)}M109(){return 0===this.M143()?null:this.M84(0)}},Dt=class{#qt;#$t=[];#Wt;#Xt={};#Yt=null;#Qt="";constructor(t,e,i){this.#qt=t+"_",this.#Wt=e,this.#Qt=i??""}M126(t,e){this.#$t.push({id:t,schema:e}),e.forEach(t=>{const e=localStorage.getItem(this.#qt+t.id);null!==e?this.#Xt[t.id]=this.#Jt(e):(this.#Xt[t.id]=t.default,this.M229(t.id,t.default))})}#Jt(t){return"true"===t||"false"!==t&&(isNaN(t)||""===t?t:Number(t))}M206(){for(const{id:e,schema:i}of this.#$t)this.#Zt(t(e),i)}#Zt(t,e){if(!t)throw new Error("SettingsManager::RenderTo » No parent");this.#Yt=t;const i=e.map(t=>this.#te(t));this.#Yt.innerHTML=i.join(""),this.#Yt.querySelectorAll("INPUT").forEach(t=>{this.#ee(t).classList.contains("AppSettingNotImplemented")||t.classList.add("Clickable")}),this.#Yt.querySelectorAll("LABEL").forEach(t=>{this.#ee(t).classList.contains("AppSettingNotImplemented")||t.classList.add("Clickable")}),this.#ie()}#ee(t){let e=t.parentElement;do{if("DIV"===e.tagName&&e.classList.contains("AppSettingsRow"))return e;e=e.parentElement}while(null!==e);return e}#te(t){const e=this.#Xt[t.id];let i="";"radio"===t.type?i=t.options.map((i,s)=>`\n                <label>\n                    <input type='radio' name='${t.id}' value='${s}' ${e===s?"checked":""}>\n                    ${i}\n                </label>\n            `).join(""):"range"===t.type?i=`\n                <input type='range' id='${t.id}' \n                    min='${t.min}' max='${t.max}' step='${t.step}' \n                    value='${e}'>\n            `:"checkbox"===t.type?i=`\n                <input type='checkbox' id='${t.id}' ${e?"checked":""}>\n            `:"text"===t.type&&(i=`\n                <input type='text' id='${t.id}' \n                    value='${e}'>\n            `);let s="AppSettingsRow";return t.not_implemented&&(s+=" AppSettingNotImplemented"),`\n            <div class='${s}' data-setting-id='${t.id}'>\n                <p class='AppSettingsMainLabel'>${t.label}</p>\n                <div class='AppSettingsInputWrapper'>${i}</div>\n            </div>\n        `}#ie(){this.#Yt.addEventListener("input",t=>{t.stopPropagation(),t.preventDefault();const e=t.target,i=e.name||e.id;let s="checkbox"===e.type?e.checked:e.value;isNaN(s)||"range"!==e.type||(s=Number(s)),this.M49(i,s)}),this.#Yt.addEventListener(this.#Qt,t=>{"INPUT"===t.target.tagName&&(t.is_onesie_ui=!0),"LABEL"===t.target.tagName&&(t.is_onesie_ui=!0)})}M49(t,e){this.#Xt[t]=e,this.M229(t,e),this.#Wt&&this.#Wt(t,e)}M229(t,e){localStorage.setItem(this.#qt+t,e)}M234(t){return this.#Xt[t]}},Ot="https://",Rt="rqhvlh0vwdwv",Pt=window.visualViewport,Vt="AppRotate",Bt="AppError",Kt="AppErrorInfo",Ft="AppViewport",zt="PageHidden",Ut="Hidden",Gt=Vt.toLowerCase(),jt=Bt.toLowerCase(),Ht="Home".toLowerCase(),qt="Play".toLowerCase(),$t=class s{static K121=1;static K127=2;static K146=3;#se=null;#ne=null;#re=new Map;#oe=s.K121;#he=null;#ae=null;#le=null;#ce=null;#de=null;#ue=null;#_e=null;#Me=null;#pe=null;#fe=null;#me=null;#Qt="";#ge=!0;#be=null;#ye=null;constructor(t={}){this.#Qt=e.M132?"touchstart":"click",this.#we(t);const i=t.start_page||Ht;requestAnimationFrame(()=>this.M151(i))}#we(t){if(this.#se=document.getElementById(Ft),null===this.#se)throw new Error("App » Element not found: #"+Ft);this.#xe();const e=this.#re.get(Gt);if(!e)throw new Error("App » Element not found: #"+Vt);e.classList.add(Vt);const i=this.#re.get(jt);if(!i)throw new Error("App » Element not found: #"+Bt);if(i.classList.add(Bt),this.#ae=document.getElementById(Kt),!this.#ae)throw new Error("App » Element not found: #"+Kt);this.#ve(t),this.#Ee(),this.#ke(),this.#Le(),this.#Ce(t),this.#Se(t),this.#oe=t.page_mode??1,this.#Ie(),this.#Me=t.on_resize||this.#Me||null,this.#pe=t.on_click||this.#pe||null,this.#fe=t.on_page||this.#fe||null}#ve(t){const e=new W("Onesie");e.M102(!0),e.M122(!1),e.M118(!1),this.#ue=e;const i=this.#re.get(Ht);if(i.appendChild(e.ELEMENT),i.classList.add("Clickable"),t.blank_card)return;const s=t.game_name||"Some Card Game",n=t.game_designer||"Some Great Designer",r=t.game_build||("undefined"!=typeof BUNDLE_ID?BUNDLE_ID:"0000-0000-0000"),o="p";if(!t.blank_back){const t=document.createElement(o);t.classList.add("h1"),t.innerHTML="ONESIE",e.BACK.appendChild(t);const i=document.createElement(o);i.classList.add("h2"),i.innerHTML="1p card games",e.BACK.appendChild(i);const s=document.createElement(o);s.classList.add("h3"),s.innerHTML="build:<br><span>"+r+"</span>",e.BACK.appendChild(s)}if(!t.blank_face){const t=document.createElement(o);t.classList.add("h1"),t.innerHTML=s;const i=document.createElement(o);i.classList.add("h2"),i.innerHTML="<small>designed by:</small><br>"+n;const h=document.createElement(o);h.classList.add("h2"),h.innerHTML="<small>coded by:</small><br>Pedro Fontoura";const a=document.createElement(o);a.classList.add("h3"),a.innerHTML="build:<br><span>"+r+"</span>";const l=document.createElement(o);l.classList.add("h3"),l.innerHTML="♦ a solitaire card game ♦";for(const s of[t,l,i,h])e.FACE.appendChild(s)}}#xe(){document.querySelectorAll("#"+Ft+" > section").forEach(t=>{this.#re.set(t.id.toLowerCase(),t),t.classList.add(zt)})}#Le(){window.addEventListener("resize",()=>this.#Ie()),window.addEventListener("contextmenu",t=>{if(t.preventDefault(),t.stopPropagation(),"touchstart"===this.#Qt)return;const e=new MouseEvent(this.#Qt,{view:window,bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});t.target.dispatchEvent(e)},{passive:!1}),window.addEventListener("unhandledrejection",t=>{if(t.preventDefault(),t.stopPropagation(),t.reason.stack){const e=[this.#Ne(t.reason.stack)].join("<br>");this.#Ae("Rejected",e)}else this.#Ae("Rejected",t.reason.message)}),window.addEventListener("error",t=>{t.preventDefault(),t.stopPropagation();const e=[t.error.message,t.error.fileName,t.error.lineNumber,this.#Ne(t.error.stack)].join("<br>");this.#Ae("Error",e)}),this.#ce.addEventListener(this.#Qt,t=>{this.#Te(),t.stopPropagation(),this.#de.classList.toggle(Ut)}),Array.from(this.#de.children).forEach(t=>{const e=this.#De(t);this.#re.get(e)?t.addEventListener(this.#Qt,t=>{this.#Te(),t.stopPropagation(),this.#Oe(t)}):t.remove()}),this.#ue.M8().addEventListener(this.#Qt,t=>{this.#Te(),t.stopPropagation(),this.#ue.M145()?this.M151(qt):this.#ue.M226()}),this.M184(Ht).addEventListener(this.#Qt,t=>{this.#Te(),t.stopPropagation(),this.#ue.M226()}),window.addEventListener(this.#Qt,t=>{t.stopPropagation(),this.#Re(t)})}#Te(){e.M58||e.M132&&e.M18()}#Oe(t){const e=this.#De(t.target);this.#re.get(e)&&this.M151(e)}#Re(t){if(t.is_onesie_ui)return;let e=0,i=0;if("touchstart"===this.#Qt){const s=t.touches[0];e=s.clientX,i=s.clientY}else e=t.clientX,i=t.clientY;if(this.#pe){if(!this.#ge)return;this.#pe(t.target,0|e,0|i)}}#Ee(){this.#le=document.getElementById("AppSideMenu"),this.#ce=document.getElementById("AppSideMenuMain"),this.#de=document.getElementById("AppSideMenuGroup"),this.#de.classList.add(Ut),e.M132&&this.#le.classList.add("TopSpacing")}#Ne(t){return"string"==typeof t?t.split("at ").join("<br>&bull; "):"Stack: "+t}#Ae(t,e){null!==this.#ae&&(this.#ae.innerHTML+="<h3>"+t+"</h3>"+e,this.M151(jt))}#Ie(){const t=Pt.width,e=Pt.height;if(this.#Pe(),this.#ue){const i=.75*Math.min(t,e)|0,s=.7*i|0;this.#ue.M161(s,i),this.#ue.M78(t-s>>1,e-i>>1)}this.#Me&&this.#Me(t,e,this.#le.offsetWidth)}get M219(){return Pt.width}get M207(){return Pt.height}#Pe(){3!==this.#oe&&((Math.sign(Pt.width-Pt.height)>=0?1:2)!==this.#oe?this.#ne!==Gt&&(this.#he=this.#ne,this.M151(Gt)):null!==this.#he&&(this.M151(this.#he),this.#he=null))}async#ke(){await this.M127("./assets/app_icons.svg","icons-sprite-sheet")}async M127(t,e){try{const i=await fetch(t),s=await i.text(),n=document.getElementById(e);n&&n.remove();const r=(new DOMParser).parseFromString(s,"image/svg+xml").querySelector("svg");r&&(r.id=e,r.style.display="none",document.body.insertAdjacentElement("afterbegin",r))}catch(t){}}async M150(t){try{const e=await fetch(t);return e.ok?await e.json():null}catch(t){return null}}#De(t){const e=t.querySelector("use");if(e)return(e.getAttribute("href")||e.getAttribute("xlink:href")).split("-").pop().toLowerCase()}get M110(){return this.#le.offsetWidth}get M230(){return this.#ue}M151(t,e=!1){const i=this.#ne===t;t=t.toLowerCase();const s=this.#re.get(t);if(!s)throw new Error("App » No such page: "+t);t===qt&&this.#ge,this.#ne&&this.#re.get(this.#ne).classList.add(zt),s.classList.remove(zt),this.#ne=t,t===Ht?this.#le.classList.add(Ut):this.#le.classList.remove(Ut);const n=this.#ue;n&&n.M122(!1),this.#fe&&!e&&this.#fe(t,i)}M128(t){return this.#ne===t}M184(t){const e=this.#re.get(t);if(!e)throw new Error("App » No such page: "+t);return e}M68(){const t=window.matchMedia("(display-mode: standalone)").matches,e=!0===window.navigator.standalone;return t||e}M152(t=!0){(t=!!t)&&this.#ge?this.#de.classList.remove(Ut):this.#de.classList.add(Ut)}M33(t,e){t.classList.add("Clickable"),t.addEventListener(this.#Qt,i=>{i.preventDefault(),i.stopPropagation(),e(t)})}get M235(){const t=new Date,i=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}-${String(t.getHours()).padStart(2,"0")}-${String(t.getMinutes()).padStart(2,"0")}`;return e.M100("Onesie"+i)}async M94(t=!0){const i=await this.#Ve();if("Wrpq}Qjt7qxvn"===e.M59(i,9))return this.#ge=!0,!0;let s=!1;return window.top===window.self&&"ynm{x6oxw}x~{j7pr}q~k7rx"===e.M59(window.location.hostname,9)&&(s=e.M17("key",0,!0)===this.M235),this.#ge=s,!s&&t&&this.#Be(),s}#Be(){const t=Ot+e.M59("ynm{x6oxw}x~{j7pr}q~k7rx8xwn|rn8HyjpnFyuj",-9);self.location.replace(t)}#Ve=async()=>(await fetch(window.location.href,{method:"HEAD"})).headers.get("server");async M50(t,i=!0){const s=Ot+e.M59("etm2gsyrxivetm2hiz3z6",-4)+"/"+e.M59(Rt,-3)+"/"+e.M59(t,-5)+"/"+(i?"up":"down");if(!e.M58)try{const t=await fetch(s),e=await t.json();e.data&&e.data}catch(t){}}#Ce(e={}){const i=e.settings||{};"function"==typeof i.on_change&&(this.#me=i.on_change),this.#_e=new Dt(i.prefix??"GAME",this.#Ke.bind(this),this.#Qt),t("GameSettings")&&this.#_e.M126("GameSettings",i.schema||[]),t("GeneralSettings")&&this.#_e.M126("GeneralSettings",[{id:"deck_seed",label:"Deck seed",type:"text",default:"",not_implemented:!0},{id:"cards_theme",label:"Cards theme",type:"radio",options:["Normal","Vintage","Modern"],default:0,not_implemented:!0},{id:"cards_axis",label:"Cards flip axis",type:"radio",options:["Random","X","Y"],default:0,not_implemented:!0},{id:"cards_speed",label:"Cards speed",type:"range",min:1,max:5,step:1,default:3},{id:"cards_flip",label:"Cards flip time",type:"range",min:1,max:5,step:1,default:3}]),this.#_e.M206()}#Se(i){const s=t("Stats");if(!s)return;const n=document.createElement("dl"),r=document.createElement("dt");r.innerHTML="Global stats";const o=document.createElement("dd");o.innerHTML="Wins: <span id='stats_wins'>#</span>";const h=document.createElement("dd");h.innerHTML="Losses: <span id='stats_losses'>#</span>",n.appendChild(r),n.appendChild(o),n.appendChild(h),s.appendChild(n),"function"==typeof Counter&&(this.#be=new Counter({debug:!0,timeout:8e3,workspace:e.M59(Rt,-3)}),"string"==typeof i.counter&&this.M111(i.counter,"get"))}async M111(i,s="get"){if(!["get","up","down"].includes(s))return;const n=e.M59(i,-5);if(null!==this.#be)try{const e=await this.#be[s](n);"200"===e.code&&(t("stats_wins")&&(t("stats_wins").innerHTML=e.data.up_count),t("stats_losses")&&(t("stats_losses").innerHTML=e.data.down_count))}catch(t){}}M112(t,e=!1){const i=this.#_e.M234(t);return e?"cards_speed"===t?this.#Fe(i):"cards_flip"===t?this.#ze(i):i:i}#Ke(t,e){switch(t){case"cards_theme":return void this.#Ue(e);case"cards_flip":if(null!==this.#ye)return void this.#Ge(e);break;case"cards_speed":if(null!==this.#ye)return void this.#je(e)}null!==this.#me&&this.#me(t,e)}#Ue(t){const e="./assets/"+"theme-#.svg".replace("#",t);this.M127(e,"card-sprite-sheet")}#Fe(t){return i.M212(t||3,1,5,.25,2)}#je(t){if(null===this.#ye)return;const e=this.#Fe(t);this.#ye.M171(t=>t.M30(e))}#ze(t){return i.M212(t||3,1,5,100,1100)}#Ge(t){if(null===this.#ye)return;const e=this.#ze(t);this.#ye.M171(t=>t.M87(e))}M185(t){this.#ye=t??null,this.#je(this.#_e.M234("cards_speed")),this.#Ge(this.#_e.M234("cards_flip")),this.#Ue(this.#_e.M234("cards_theme"))}},Wt="fsm_data_changed",Xt=class{#He=()=>{};V48=!0;V44=new Map;V22=null;V32={};V28=[];V29=[];constructor(t,e=[]){if(this.#He=t,e.length>0)for(const t of e)this.V28.push(t)}M37(t){this.#qe(t)}M51(t){if(null!==t&&!this.V44.has(t))throw new Error("FSM::AssertStateId » Unknown id: "+t)}M52(t){if(!this.V32.hasOwnProperty(t))throw new Error("FSM::AssertDataKey » Unknown key: "+t)}M69(t,e,i=null){this.M51(t),this.M51(e),null!==t&&t!==this.V22.ID||this.#qe(e,i)}#qe(t,e=null){if(this.V22&&this.V22.M231(),this.V22=this.V44.get(t),!this.V22)throw new Error("FSM::#TransitionTo » No state! Key:",t);return this.V22.M220(e),!0}M38(t){if(null!==t)return this.M51(t),this.V22.ID===t}M70(t,e={}){this.M51(t);for(const[t,i]of Object.entries(e))this.M52(t),i!==this.V32[t]&&(this.V32[t]=i,this.#$e(t,i));return this.M38(t)}#$e(t,e){this.V28.includes(t)&&this.#We(Wt,{key:t,value:e})}M71(t,e){if(this.M51(t),"string"==typeof e)return this.M52(e),this.V32[e];const i={};for(const t of e)this.M52(t),this.V32[t],i[t]=this.V32[t];return i}M153(){const t=this.V32;for(const[e,i]of Object.entries(t));}M208(t=null,e,i){t&&this.M51(t),this.#We(e,i)}#We(t,e){this.#He(t,e)}M129(t){this.M51(t),this.V22&&(this.V22.Sleep(),this.V29.push(this.V22)),this.V22=this.V44.get(t),this.V22.M220()}M154(){const t=this.V29;if(0===t.length)throw new Error("FSM::PopState » Stack is empty");this.V22.M231(),this.V22=t.pop(),this.V22.WakeUp()}},Yt=class{constructor(t,i){e.M5(this,"ID",t),e.M5(this,"CONTROLLER",i)}M220(t){}M231(){}M186(t,e){return!1}M95(t,e){return!1}M113(t,e){return!1}M208(...t){return this.CONTROLLER.M208(this.ID,...t)}M187(...t){return this.CONTROLLER.M71(this.ID,...t)}M188(...t){return this.CONTROLLER.M70(this.ID,...t)}M69(...t){return this.CONTROLLER.M69(this.ID,...t)}},Qt=class extends Yt{constructor(t){super(t)}},Jt=class extends Yt{constructor(t,e){super(t,e)}M113(t){if(!t.classList.contains("PredictionBtn"))return this.M208(u,"Not a prediction button"),!1;const e=parseInt(t.dataset.slot_idx);if(this.CONTROLLER.M55(this.ID,e))return this.M208(u,"Slot is blocked"),!1;const i=t.dataset.id;let s=this.M187("nr_predictions");return s+=1,this.M188({slot_idx:e,prediction_key:i,nr_predictions:s}),this.M69(r),!0}},Zt=new Map;Zt.set("R",t=>t.M216()),Zt.set("B",t=>t.M175()),Zt.set("E",t=>t.M204()),Zt.set("O",t=>t.M218()),Zt.set("D",t=>t.M205(X.K31)),Zt.set("H",t=>t.M205(X.K73)),Zt.set("S",t=>t.M205(X.K74)),Zt.set("C",t=>t.M205(X.K98)),Zt.set(A,t=>t.M216()&&t.M218()),Zt.set(O,t=>t.M216()&&t.M204()),Zt.set(T,t=>t.M175()&&t.M204()),Zt.set(D,t=>t.M175()&&t.M218());var te=class extends Yt{constructor(t,e){super(t,e)}M220(){const t=this.M187("prediction_key"),e=this.CONTROLLER.M158(this.ID),i=Zt.get(t)(e);this.M188({card_idx:e.IDX}),this.M69(i?o:h)}},ee=class extends Yt{constructor(t,e){super(t,e)}M220(){const{nr_predictions:t,nr_predictions_ok:e,slot_idx:i,card_idx:s}=this.M187(["nr_predictions","nr_predictions_ok","slot_idx","card_idx"]),n=e+1,r=n/t*100;this.M188({success:r,nr_predictions_ok:n});const o=this.CONTROLLER.M56(this.ID,s,i),h=this.CONTROLLER.M28(this.ID,i);this.M188({lst_slots_idx:h});const c=h.length>0?l:a;o.M79(t=>this.M69(c))}},ie=class extends Yt{constructor(t,e){super(t,e)}M220(){const{slot_idx:t,card_idx:e}=this.M187(["slot_idx","card_idx"]);this.CONTROLLER.M41(this.ID,e).M79(e=>{this.CONTROLLER.M98(this.ID)?this.M69(d):this.CONTROLLER.M40(this.ID,t).M79(t=>this.M69(a))})}},se=class extends Yt{constructor(t,e){super(t,e)}M220(){const t=this.CONTROLLER.M9(this.ID);this.M188({nr_completed:t}),8!==t?8!==this.CONTROLLER.M26(this.ID)?this.CONTROLLER.M98(this.ID)?this.M69(d):(this.CONTROLLER.M57(this.ID),this.M69(n)):this.M69(d):this.M69(c)}},ne="destination",re="stone",oe=class extends Yt{#Xe="";#Ye=null;#Qe=-1;#Je="none";#Ze=!1;constructor(t,e){super(t,e)}M220(){const{lst_slots_idx:t,level:e}=this.M187(["lst_slots_idx","level"]);this.#Ye=t,this.CONTROLLER.M34(this.ID,t,!0),2===e&&this.#Ye.length>1?this.#ti():this.#ei()}#ei(){this.#Je=ne,this.M208(_,{title:"Where to move the stones?",options:[{label:"Back to Deck (Face Down)",value:z},{label:"To the Table (Face Up)",value:U}],callback:t=>this.#ii(t)}),this.#Ze=!0}#ti(){this.#Je=re;const t=[];for(const e of this.#Ye)t.push({label:"Slot",value:e});this.M208(_,{title:"Whick stone do you want to remove?",options:t,callback:t=>this.#si(t)}),this.#Ze=!0}#ii(t){this.#Ze=!1,this.#Xe=t,this.#Qe=0,this.#ni()}#ni(){if(this.#Qe>=this.#Ye.length)return void this.M69(a);const t=this.#Ye[this.#Qe];this.CONTROLLER.M34(this.ID,[t],!1),this.CONTROLLER.M96(this.ID,t,this.#Xe).M79(()=>{this.#Qe+=1,this.#ni()})}#si(t){this.#Ze=!1;for(const e of this.#Ye)e!==t&&this.CONTROLLER.M34(this.ID,[e],!1);this.CONTROLLER.M34(this.ID,[t],!0),this.#Ye=[t],this.#ei()}M95(t,e){if(!this.#Ze)return!1;if(this.#Je===ne)return this.#ri(null,e);if(t.M145())return!1;if(!t.M103())return!1;const i=this.CONTROLLER.M131(this.ID,t,this.#Ye);return this.#si(i),!0}M186(t,e){if(this.#Ze)return this.#ri(t,e)}#ri(t,e){return!!this.#Ze&&(this.#Je!==re?1===e?(this.#ii(z),!0):2===e&&(this.#ii(U),!0):void 0)}},he=class extends Yt{constructor(t,e){super(t,e)}M220(){this.M208(m,!0)}},ae=class extends Yt{constructor(t,e){super(t,e)}M220(){this.M208(m,!1)}},le=.1,ce=1-le,de=class extends q{#oi=null;#hi=null;#ai=new Map;#li=!1;#ci=!1;#di=0;#ui=0;constructor(t,i,s,n,r={}){const{parent:o=null,title_height:h=le}=r;ce=1-(le=h),super(t,"PredictionSlot_"+t,q.COLUMN,q.K148,q.K137,!0,{max_count:1,uniform:!0,face_up:!1,parent:o}),e.M5(this,"IDX",t),e.M5(this,"ROW",i),e.M5(this,"COLUMN",s),this.ELEMENT.classList.add("PredictionSlot"),this.#hi=new St(t,"Predictions_BoxOfCards_"+t,q.COLUMN,q.K137,q.K137,!0,{flip_after:!0,face_up:!0,parent:o,tuck:!0,reverse_z:!0}),this.M233(this.#hi),this.#oi=document.createElement("div"),this.#oi.classList.add("PredictionSlotTitle"),this.ELEMENT.appendChild(this.#oi);for(let e of n){const i=document.createElement("button"),s=R[e];i.innerText=s,i.dataset.id=e,i.dataset.slot_idx=t,i.classList.add("PredictionBtn"),i.classList.add("Clickable"),this.#oi.appendChild(i),this.#ai.set(e,i)}}M215(){this.#li=!1,this.#ci=!1,this.#di=0,this.#ui=0,this.#hi.M171(t=>t.BACK.classList.remove("Trapped")),this.#_i(),this.#Mi(),this.#pi()}M23(t){t.appendChild(this.ELEMENT),t.appendChild(this.#hi.ELEMENT)}M155(t,e,i,s,n,r,o,h){this.#oi.style.height=Math.floor(e*le)+"px";const a=Math.min(18,.45*h|0)+"px";for(const[t,e]of this.#ai)e.style.width=o+"px",e.style.height=h+"px",e.style.fontSize=a;this.#hi.M31(n,r);const l=e*ce|0,c=o;this.#hi.M161(c,l),this.M31(c,l),this.M115(t,e,i,s)}M53(t){this.#di+=1,this.#fi(t,!0)}M156(t){this.#ui+=1,this.#ci=3===this.#ui,this.#fi(t,!1)}#fi(t,e=!0){this.#hi.M233(t,!1),this.#li=!e,t.M79(()=>{t.M122(e),this.#mi(),this.#_i(),this.#Mi(),this.#pi()})}#mi(){const t=this.#hi.M143();let e=!1;for(let i=0;i<t;++i){const t=this.#hi.M124(i);t.M145()?e=!0:e?t.BACK.classList.add("Trapped"):t.BACK.classList.remove("Trapped")}}M39(t){return t.M195()===this.#hi&&(!!t.M108()&&(!!this.#li&&this.#hi.M172()===t))}M96(){if(!this.#li)return null;const t=this.#ui;if(0===t)return null;const e=this.#hi.M172();if(this.#hi.M199(e),this.#ui-=1,0===this.#hi.M143()||0===t)this.#li=!1;else{const t=this.#hi.M172();this.#li=t.M108()}return this.#_i(),this.#Mi(),this.#pi(),e}#_i(){this.#ci=3===this.#ui,this.#ci?this.ELEMENT.classList.add("Blocked"):this.ELEMENT.classList.remove("Blocked")}#pi(){const t=this.#ci;for(const[e,i]of this.#ai)i.disabled=t}#Mi(){this.M97()?this.ELEMENT.classList.add("Completed"):this.ELEMENT.classList.remove("Completed")}M130(){return this.#ci}M24(){return this.#li}M157(){return this.#ui>0}M54(){return this.#di>0}M97(){return this.#di>0&&!this.#li}M25(t){const e=this.#hi.M172();return null!==e&&e.M80(t),e}},ue=class extends Xt{static K58=Wt;#ye=null;#gi=null;#bi=null;#yi=null;#wi=null;#xi=0;#vi={position:new Array(2),status:0};#Ei=null;constructor(t={}){const{on_message_request:e,V28:i=[],parent_node:n=window.document.body}=t;super(e,i),this.#Ei=n,this.#ki();for(const t of i)this.V32.hasOwnProperty(t);this.#Li(),this.M37(s),this.#Ci()}#ki(){this.V32.nr_predictions=0,this.V32.nr_predictions_ok=0,this.V32.prediction_key="",this.V32.slot_idx=-1,this.V32.card_idx=-1,this.V32.success=0,this.V32.level=0,this.V32.nr_completed=0,this.V32.lst_slots_idx=null,this.V32.stones_destination=""}#Li(){const t=[[s,Qt],[n,Jt],[r,te],[o,ee],[h,ie],[l,oe],[a,se],[c,he],[d,ae]];for(const[e,i]of t)this.V44.set(e,new i(e,this))}M70(t,e){return super.M70(t,e),this.#Si(),this.V22.ID===t}#Si(){this.V32}M186(t,e,i){let s=!1;this.V48||(s=this.#Ii(t)),this.#vi.position[0]=e,this.#vi.position[1]=i,this.#vi.status=s,this.M208(null,M,this.#vi)}#Ii(t){if(!t.classList.contains("Clickable"))return!1;const e=t.classList;if(e.contains("CardBody")){const e=parseInt(t.dataset.idx),i=this.#ye.M181(e),s=this.#Ni(i);return this.V22.M95(i,s)}const i=this.#Ai(t);return"BUTTON"===t.nodeName?!t.disabled&&this.V22.M113(t,i):(e.contains("Table")||!!e.contains("DrawPile"))&&this.V22.M186(t,i)}#Ni(t){const e=t.M195();return e===this.#yi?1:e===this.#bi?2:0}#Ai(t){return t===this.#yi.ELEMENT?1:t===this.#bi.ELEMENT?2:0}M72(t){return!Number.isInteger(t)||t<0||t>2?(this.M208(null,"app_error","Invalid game_level: "+t),this):(this.M70(null,{level:t}),this)}M221(t){for(const t of this.#gi)t.M215();const i=e.M17("seed",Date.now()%1e6,!0);this.M208(null,g,i),this.#ye.M215(t).M169(i).M227(this.#yi),this.#wi.classList.remove("Hidden"),this.V48||(this.#Ti(),this.#Di()),this.V48=!1,this.M37(n)}M155(t,e,i=0){const s=Math.min(t,e),n=.03*s,r=(i||.1*s)+n,o=.03*s,h=t-n-r,a=e-2*o,l=Math.round(h/8),c=Math.round(a/5),d=Math.min(18,Math.round(.1*l))+"px",u=.75*c,_=.66*u;this.#ye.M66(_,u);const M=(h-3*n)/4,p=(2*c*2-1*o)/2,f=Math.round(.9*(M>>1)),m=Math.round(.15*p*.8);let g=0,b=n,y=o;for(let t=0;t<2;++t){b=n;for(let e=0;e<4;++e){const i=this.#gi[g++];i&&(i.M155(M,p,b+e*M,t*p+y,_,u,f,m),b+=n)}y+=o}this.#bi.M31(_,u),this.#bi.M115(h-2*l,c-o,n+l,o+4*c+o),this.#yi.M31(_,u),this.#yi.M115(.8*l-n,c-o,n,o+4*c+o),this.#yi.COUNTER.style.fontSize=d;const w=this.#wi.style;return w.bottom=o+"px",w.right=r+"px",w.width=l+"px",w.height=c-o+"px",w.fontSize=d,this}M189(){return this.#ye}M55(t,e){return this.M51(t),this.#Oi(e),this.#gi[e].M130()}M158(t){return this.M51(t),this.#yi.M93()}M131(t,e,i){this.M51(t);for(const t of i)if(this.#Oi(t),this.#gi[t].M39(e))return t;return-1}M56(t,e,i){this.M51(t),this.#Oi(i),this.#Ri(e);const s=this.#ye.M181(e);return this.#gi[i].M53(s),s}M40(t,e){this.M51(t),this.#Oi(e);const i=this.#yi.M93();return this.#gi[e].M156(i),i}M41(t,e){this.M51(t),this.#Ri(e);const i=this.#ye.M181(e);return this.#bi.M233(i),i}M28(t,e){this.M51(t),this.#Oi(e);const i=this.#Pi(e,this.V32.level);return this.#gi.filter(t=>i.includes(t.IDX)&&t.M24()).map(t=>t.IDX)}#Pi(t,e){const i=this.#gi[t],s=i.ROW,n=i.COLUMN,r=[],o=t-4,h=t+4,a=t-1,l=t+1,c=s>0,d=s<1,u=n>0,_=n<3;if(u&&r.push(a),_&&r.push(l),c&&r.push(o),d&&r.push(h),0!==e)return r;const M=o-1,p=o+1,f=h-1,m=h+1;return c&&u&&r.push(M),c&&_&&r.push(p),d&&u&&r.push(f),d&&_&&r.push(m),r}M34(t,e,i){this.M51(t);const s=this.#ye.M181(this.V32.card_idx),n=i?{stones:[],prediction:[s.M44(),s.M62()]}:null;for(const t of e){const e=this.#gi[t].M25(i);i&&n.stones.push([e.M44(),e.M62()])}i?this.M208(null,p,n):this.M208(null,f,null)}M96(t,e,i){this.M51(t),this.#Oi(e);const s=this.#gi[e].M96();return i===z?this.#yi.M92(s):this.#bi.M233(s),s}M9(t){this.M51(t);let e=0;for(let t=0;t<this.#gi.length;++t)this.#gi[t].M97()&&(e+=1);return e}M26(t){this.M51(t);let e=0;for(let t=0;t<this.#gi.length;++t)this.#gi[t].M130()&&(e+=1);return e}M98(t){return this.M51(t),0===this.#yi.M143()}M57(t){this.M51(t),this.#Ti()}#Ti(){this.V32.prediction_key="",this.V32.slot_idx=-1,this.V32.card_idx=-1,this.V32.lst_slots_idx=null,this.V32.stones_destination=""}#Di(){super.M70(null,{nr_predictions:0,nr_predictions_ok:0,success:0,nr_completed:0})}#Oi(t){if(t<0||t>this.#gi.length-1)throw new Error("GC::AssertSlotIdx » Bad idx: "+t)}#Ri(t){if(t<0||t>this.#xi-1)throw new Error("GC::AssertCardIdx » Bad idx: "+t)}#Ci(){this.#Vi(),this.#Bi()}#Vi(){this.#ye=new Nt({jokers:0,exclude_ranks:[7,8,9,10,11,12,13]},{visible:!1,touch_down_events:!0,smooth:!0,flip_axis:i.M61(.5)?"x":"y"}),this.#ye.M171(t=>{this.#Ei.appendChild(t.ELEMENT)}),this.#xi=this.#ye.M182()}#Bi(){const e=this.#ye.M182(),i=this.#Ei;let s=0;this.#gi=[];for(let t=0;t<2;++t)for(let e=0;e<4;++e){const n=new de(s,t,e,P[s],{parent:i,title_height:.15});this.#gi.push(n),s+=1}this.#bi=new St(s++,"Table",St.ROW,St.K137,St.K137,!0,{max_count:e,flip_after:!0,face_up:!0,sorting:It,parent:i}),this.#bi.ELEMENT.classList.add("Table"),this.#bi.ELEMENT.classList.add("Clickable"),this.#yi=new Tt(s++,"DrawPile",{max_cards:e,flip_after:!1,face_up:!1,parent:i,counter_position:Tt.K32,pop_effect:!0}),this.#yi.ELEMENT.classList.add("DrawPile"),this.#yi.ELEMENT.classList.add("Clickable"),this.#wi=t("InGameInfo")}};import _e from"stampit";import stampit from"stampit";var Me=stampit({props:{M114:!1,M232:null,M10:NaN},methods:{setImage(t){this.resetImage(),this.M114=!0;let e=null;"string"==typeof t?(e=new Image,e.onload=()=>{this.M232=e,this.M10=e.width/e.height},e.onerror=()=>{this.resetImage()},e.src=t):(t instanceof HTMLImageElement||t instanceof Image)&&(this.M232=t,this.M10=t.width/t.height)},getImage(){return this.M232&&this.M232.complete?this.M232:null},getImageAspectRatio(){return this.M232&&this.M232.complete?this.M10:NaN},resetImage(){this.M232=null,this.M10=NaN,this.M114=!1}}});import pe from"stampit";import{ARRAY_TYPE as fe}from"glMatrix";import{fromValues as me,create as ge}from"vec2";var vec2={fromValues:me,create:ge},be=pe({methods:{validateVector(t,e=null){const i=t||e;if(!i)return vec2.create();if(!(Array.isArray(i)||i instanceof fe))throw new Error("Vector input must be an Array or glMatrix ARRAY_TYPE.");if(2!==i.length)throw new Error("Vector input must have exactly 2 elements.");if(!Number.isFinite(i[0])||!Number.isFinite(i[1]))throw new Error("Vector array must contain only numeric values.");return vec2.fromValues(i[0],i[1])}}});import{add as ye,create as we,scaleAndAdd as xe,zero as ve,copy as Ee}from"vec2";import ke from"stampit";import Le from"stampit";var Ce=Le({methods:{makeReadOnly:function(t){if("object"!=typeof t||null===t||Array.isArray(t))return;const e={};Object.entries(t).forEach(([t,i])=>{Object.prototype.hasOwnProperty.call(this,t),e[t]={configurable:!1,writable:!1,value:i,enumerable:!0}}),Object.defineProperties(this,e)}}}),Se={add:ye,create:we,scaleAndAdd:xe,zero:ve,copy:Ee},Ie="#FFFFFF",Ne=!0,Ae=2*Math.PI,Te=_e({props:{M209:null},init({radius:t=3,color:e=Ie,opacity:i=1,fill:s=Ne,user_data:n=null}){if(!Number.isFinite(t)||t<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(i)||i<0||i>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if("string"!=typeof e||e.length<3)throw new Error("'color' must be a valid string format ( e.g., '#FFF' or 'red' ).");this.radius=t,this.color=e,this.opacity=i,this.fill=s,this.user_data=n},methods:{render(t){if(t.save(),t.globalAlpha=this.opacity,this.M114){const e=this.getImageAspectRatio();if(Number.isFinite(e)){const i=this.getImage(),s=this.position[0],n=this.position[1],r=(i.width,i.height,this.M10,2*this.radius),o=r*e;t.drawImage(i,s-o/2,n-r/2,o,r)}}else t.beginPath(),t.arc(...this.position,this.radius,0,Ae),this.fill?(t.fillStyle=this.color,t.fill()):(t.strokeStyle=this.color,t.stroke());t.restore()},resetRender(){this.resetImage(),this.fill=Ne}}}),De=_e({init({position:t,velocity:e}){this.position=this.validateVector(t),this.velocity=this.validateVector(e),this.acceleration=Se.create()},methods:{applyForce(t){Se.add(this.acceleration,this.acceleration,t)},updatePhysics(t=1){Se.scaleAndAdd(this.velocity,this.velocity,this.acceleration,t),Se.scaleAndAdd(this.position,this.position,this.velocity,t),Se.zero(this.acceleration)},resetPhysics(){Se.zero(this.position),Se.zero(this.velocity),Se.zero(this.acceleration)}}}),Oe=_e({props:{age:0,alive:!1},init({life:t=120}){if(!Number.isFinite(t)||t<=0)throw new Error("'life' must be a positive number.");this.life=t},methods:{updateLife(t=1){return this.age+=t,this.alive=this.age<this.life,this.alive},resetLife(){this.age=0,this.alive=!1}}}),Re=_e({methods:{config(t={}){if(this.opacity=(t.opacity??this.opacity)||1,this.radius=(t.radius??this.radius)||3,this.color=(t.color??this.color)||Ie,this.life=(t.life??this.life)||120,this.fill=t.fill??Ne,t.position&&Se.copy(this.position,this.validateVector(t.position)),t.velocity&&Se.copy(this.velocity,this.validateVector(t.velocity)),!Number.isFinite(this.radius)||this.radius<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(this.opacity)||this.opacity<0||this.opacity>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if(!Number.isFinite(this.life)||this.life<=0)throw new Error("'life' must be a positive number.")}}}),Pe=_e().compose(be,Me,Te,De,Oe,Re,_e({methods:{reset(){this.resetRender(),this.resetPhysics(),this.resetLife()}}})),Ve=ke({init({object_stamp:t,pool_size:e=1e3}){if("function"!=typeof t)throw new Error("'object_stamp' must be a constructor function ( a stamp or factory ).");if(!Number.isInteger(e)||e<=0)throw new Error("'pool_size' must be a positive integer.");this.makeReadOnly({pool_size:e,object_stamp:t})}}),Be=ke({init(t,{instance:e}){const i=new Array(this.pool_size);let s=0;const n=new WeakMap;for(let t=0;t<this.pool_size;t++){const e=this.object_stamp();e.reset(),i[t]=e}e._setIndex=function(t,e){n.set(t,e)},e.get=function(){if(s>=this.pool_size)return null;const t=i[s];return n.set(t,s),s++,t},e.free=function(t){const e=n.get(t);if(void 0===e||e>=s)return!1;s--;const r=i[s];return i[s]=t,i[e]=r,t!==r&&n.set(r,e),t.reset(),n.delete(t),!0},e.getActiveCount=function(){return s},e._getPoolArray=function(){return i}}}),Ke=ke({methods:{M171:function(t){const e=this._getPoolArray();let i=0;for(;i<this.getActiveCount();){const s=e[i];this._setIndex(s,i),!1!==t(s)?i++:this.free(s)}},M210:function(t){this._getPoolArray().forEach(e=>t(e))}}}),Fe=ke().compose(Ce,Ve,Be,Ke);import{fromValues as ze,copy as Ue,random as Ge,create as je}from"vec2";var He={fromValues:ze,copy:Ue,random:Ge,create:je},qe=He.create(),$e="xtq{sf2uqf~",Solvna=class{#Ki=null;#Fi=!1;#zi=null;#Ui=-1;#Ei=null;V33=null;V36=0;V45=0;#ge=!1;#Gi=null;#ji=null;#Hi=0;#qi=null;#$i=null;#Wi=null;#Xi=null;#Yi=0;#Qi=0;#Ji=null;constructor(t){this.#Ki=new $t({game_name:"SOLVNA",game_designer:"Jean-Baptiste Lévêque",game_build:t,start_page:e.M17("page",Ht),page_mode:$t.K121,on_resize:this.M155.bind(this),on_click:this.M186.bind(this),on_page:this.M211.bind(this),counter:$e,settings:{prefix:"solvna",schema:[{id:"game_level",label:"Game level",type:"radio",options:["Easy","Normal","Hard"],default:1}],on_change:this.#Ke.bind(this)}}),this.#Ei=this.#Ki.M184(qt),this.#Hi=this.#Ki.M110,this.#ge=this.#Ki.M94(),this.#Ui=this.#Ki.M112("game_level"),this.#Zi(),this.#ts(),this.#es(),this.#Ki.M185(this.#zi.M189())}M155(t,e,i){this.#zi.M155(t,e,i),this.#qi.width=t,this.#qi.height=e,this.#$i.width=t,this.#$i.height=e,this.#Hi=i}M186(t,i,s){this.#Fi&&(e.M58||this.#ge)&&this.#zi.M186(t,i,s)}M211(t,e){const i=this.#Fi;this.#Fi=t===qt,this.#Fi&&(this.#Ki.M152(),i||window.requestAnimationFrame(this.#is.bind(this)),e&&this.#ss())}M159(e,i){switch(e){default:return;case ue.K58:let e=i.value;Number.isFinite(e)&&!Number.isInteger(e)&&(e=Math.round(e)),this.#ns(i.key,e);break;case g:const s=t("deck_seed");s&&(s.value=i);break;case _:break;case M:this.#rs(i.position,i.status);break;case p:this.#os(i);break;case f:this.#Ji=null;break;case m:this.#Ki.M111($e,i?"up":"down"),this.#Yi=i?1:-1}}#ss(){this.#Ki.M152(!1),this.#Yi=0;const t={velocity_px_ms:this.#Ki.M112("cards_speed",!0),flip_time:this.#Ki.M112("cards_flip",!0)};this.#zi.M221(t)}#ts(){this.#zi=new ue({on_message_request:(t,e)=>this.M159(t,e),V28:["nr_predictions","nr_predictions_ok","success","nr_completed"],parent_node:this.#Ki.M184(qt)}),this.#zi.M155(this.#Ki.M219,this.#Ki.M207).M72(this.#Ui)}#es(){this.#Gi=He.create(),this.#Qi=0;const t=document.createElement("canvas");t.id="canvas_clicks",t.width=window.innerWidth,t.height=window.innerHeight,t.style.zIndex=200,this.#Ei.appendChild(t);const e=document.createElement("canvas");e.id="canvas_particles",e.width=window.innerWidth,e.height=window.innerHeight,e.style.zIndex=100,this.#Ei.appendChild(e),this.#Xi=t.getContext("2d"),this.#Wi=e.getContext("2d"),this.#$i=t,this.#qi=e,this.#ji=Fe({object_stamp:Pe,pool_size:1e4}),this.#ji.M210(t=>{t.user_data={click:!0}})}#is(t){this.#Fi&&(this.#Qi,this.#Qi=t,this.#ji.M171(t=>{if(!t.updateLife())return t.user_data.click=!0,!1}),null!==this.#Ji&&this.#hs(),this.#Xi.clearRect(0,0,window.innerWidth,window.innerHeight),this.#Wi.clearRect(0,0,window.innerWidth,window.innerHeight),this.#ji.M171(t=>{t.opacity=i.M165(t.age,t.life,5),t.updatePhysics();const e=t.user_data.click;e&&(t.radius*=1.05),t.render(e?this.#Xi:this.#Wi)}),0!==this.#Yi&&this.M160(this.#Wi,1===this.#Yi?"SUCCESS":"YOU LOST",this.#Hi),window.requestAnimationFrame(this.#is.bind(this)))}#hs(){const t=this.#Ji;for(const e of t.stones)for(let t=0;t<5;++t)this.#as(e)}#as(t,e=!0){const s=this.#ji.get();if(!s)return;let n=e?"hsl("+i.M116(40,60)+", 100%, 50%)":"white";s.config({position:t,velocity:He.random(this.#Gi,1),color:n,life:60*i.M76(1,3),radius:i.M76(1,3),opacity:1,fill:!0}),s.user_data.click=!1}#Zi(){t("level").innerHTML=F[this.#Ui],t("nr_slots").innerHTML=8}#os(t){this.#Ji={stones:[...t.stones],prediction:t.prediction}}#rs(t,e){if(e)return;const i=this.#ji.get();i&&(i.config({position:t,velocity:qe,color:e?"lime":"darkorange",life:e?60:30,radius:10,opacity:1,fill:!e}),i.user_data.click=!0)}#ns(e,i){const s=t(e);s&&(s.innerText=i)}M160(t,e="",i=0){const s=t.canvas.width-i,n=t.canvas.height,r=Math.floor(.18*s);t.font="bold "+r+"px card-game",t.fillStyle="rgba( 100, 149, 237, 0.50 )",t.textAlign="center",t.textBaseline="middle",t.fillText(e,s/2,n/2)}#Ke(e,i){"game_level"===e&&(this.#Ui=0|i,t("level").innerHTML=F[this.#Ui],this.#zi.M72(this.#Ui))}};export{Solvna};