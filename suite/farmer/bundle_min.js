// Build: February 10 2026 02:53

export const BUNDLE_URL = import.meta.url.split( '/' ).pop();

export const BUNDLE_ID = "2026-0210-0253";

function t(t){return document.getElementById(t)}class i{static get M50(){return window.location.href.includes("nighthawk.home")}static get M68(){return screen.orientation&&screen.orientation.type?screen.orientation.type.includes("landscape"):window.innerWidth>window.innerHeight}static get M128(){return navigator.maxTouchPoints>0}static get M92(){return navigator.userAgentData&&"Android"===navigator.userAgentData.platform||/android/i.test(navigator.userAgent)}static get M38(){const t=window.matchMedia("(display-mode: standalone)").matches,i=!0===window.navigator.standalone;return t||i}static get M185(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||/Mac/.test(navigator.userAgent)&&navigator.maxTouchPoints>1}static M5(t,i,e){Object.defineProperty(t,i,{value:e,writable:!1,enumerable:!0,configurable:!1})}static M11(t,i){if(!Array.isArray(t))return;const e=t.indexOf(i);-1!==e&&t.splice(e,1)}static M12(t){if(!Array.isArray(t))return t;for(let i=t.length-1;i>0;i--){const e=Math.floor(Math.random()*(i+1));[t[i],t[e]]=[t[e],t[i]]}return t}static M23(t){return function(){let i=t+=1831565813;return i=Math.imul(i^i>>>15,1|i),i^=i+Math.imul(i^i>>>7,61|i),((i^i>>>14)>>>0)/4294967296}}static M93(t){let i=0;for(let e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return i}static M17(t,i=null,e=!1){let s=new URLSearchParams(window.location.search).get(t);if(null===s)return i;if(e){const t=parseInt(s,10);return isNaN(t)?i:t}return s}static M69(t,i=document.documentElement,e=null){t.startsWith("--")||(t="--"+t);const s=window.getComputedStyle(i).getPropertyValue(t).trim();return""===s?e:s.replace(/^['"]|['"]$/g,"")}static M18(){if(i.M185)return;const t=document.documentElement,e=t.requestFullscreen||t.webkitRequestFullscreen;if(!e)return;const s=i.M92?{navigationUI:"hide"}:{};e.call(t,s).catch(t=>{})}static M19(t){const i=document.querySelector('script[type="importmap"]');if(!i)throw new Error('GetImportMapValue » <script type="importmap"> not found in DOM.');const e=JSON.parse(i.textContent),s=e.imports?.[t];if(void 0===s)throw new Error("GetImportMapValue » Key not found in imports: "+t);return s}static M51(t,i=0){if("string"!=typeof t)return t;let e="";for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);e+=String.fromCharCode(n+i)}return e}static M156(t,i,e){const s=t.style;s.width=i+"px",s.height=e+"px"}static M110(t,i,e,s,n){const r=t.style;r.width=i+"px",r.height=e+"px",r.left=s+"px",r.top=n+"px"}}class e{static get M186(){return(1+Math.sqrt(5))/2}static get M187(){return 2*Math.PI}static get M157(){return Math.PI/2}static get M70(){return Math.PI/180}static get M52(){return 180/Math.PI}static M158(t){return t*e.M70}static M159(t){return t*e.M52}static M111(t,i){return Math.floor(Math.random()*(i-t+1))+t}static M71(t,i){return t+Math.random()*(i-t)}static M53(t=.5){return Math.random()<t}static M26(t){return function(){let i=t+=1831565813;return i=Math.imul(i^i>>>15,1|i),i^=i+Math.imul(i^i>>>7,61|i),((i^i>>>14)>>>0)/4294967296}}static M218(t,i,e){return t+(i-t)*e}static M207(t,i,e,s,n){return s+(t-i)*(n-s)/(e-i)}static M208(t,i,e){return Math.max(i,Math.min(t,e))}static M129(t,i,e,s){return Math.hypot(e-t,s-i)}static M160(t,i,e=2){if(i<=0)return 0;const s=t/i;return 1-Math.pow(s,e)}}var s="busy",n="success",r="fail",h="state_Reveal_2_Cards",o="state_Decide_2_Cards",a="state_End_Season",l="state_Choose_1_Card",c="msg#deck:seed",u="msg#ui:update",d="msg#ui:click",_="msg#game:over",M="location:unknown",p="location:RowDeck",f="location:RowSoil",m="location:Plot",g="location:Discard",w=Object.defineProperty,y=class t{static K106=100;static K111=199;static K24=100;static K32=!0;#t=0;#i=0;#e=100;#s=-1;#n=0;#r=0;#h=null;#o=null;#a=!1;#l=0;#c=0;#u=0;#d=0;#_=0;#M=0;#p=!1;#f=[];#m=!0;#g=!1;constructor(e,s,n=!1,r=0,h={}){i.M5(this,"IDX",e),i.M5(this,"ID",s);const{parent:o=null,is_box:a=!1}=h;i.M5(this,"IS_BOX",a),this.#l=r||t.K24,!0===n?this.#h=document.createElement("div"):n instanceof Node&&(this.#h=n),this.#h&&(this.#w(),o instanceof Node&&o.appendChild(this.#h))}#w(){i.M5(this,"ELEMENT",this.#h),this.#h.id=this.ID,this.#h.style.position="absolute",this.#h.style.top="0px",this.#h.style.left="0px",this.#h.style.zIndex=this.#e,this.#h.classList.add("FlexBoxEntity"),this.#h.dataset.smooth=this.#a?"yes":"no",this.#h.addEventListener("transitionend",this.#y.bind(this))}M161(){return this.#h&&(this.#h.remove(),this.#h=null,this.#f=null),this}M72(){return this.#h.offsetWidth,this}M94(){return this.#h}M130(){return this.#n}M112(){return this.#r}M188(){return this.#t}M162(){return this.#i}M110(t,i,e,s){this.#n=0|t,this.#r=0|i,s|=0,e|=0;const n=this.#t!==s||this.#i!==e;return n&&(this.#t=s,this.#i=e),this.#b(n),this}#E(){const t=window.getComputedStyle(this.#h).translate;t&&"none"!==t||(this.#u=0,this.#c=0);const i=t.split(" ");this.#u=parseFloat(i[0])||0,this.#c=parseFloat(i[1])||0}M73(t,i){if(t|=0,i|=0,this.#t===i&&this.#i===t)return this;if(this.#a){const e=this.M1(t,i);this.#v(e)}return this.#t=i,this.#i=t,this.#b(!0),this}M1(t,i){this.#E();const e=t-this.#u,s=i-this.#c;return Math.sqrt(e*e+s*s)/this.#l}M156(t,i){return t|=0,i|=0,this.#n===t&&this.#r===i||(this.#n=t,this.#r=i,this.#b(!1)),this}#b(t=!0){this.#x();const i=this.#h.style;i.width=this.#n+"px",i.height=this.#r+"px",t?(i.translate=this.#i+"px "+this.#t+"px 0px",this.#a&&(i.zIndex=199+this.#s)):i.zIndex=this.#e}#y(t){"translate"===t.propertyName&&(this.#E(),Math.abs(this.#u-this.#i)<1&&Math.abs(this.#c-this.#t)<1&&(this.#h.style.zIndex=this.#e,this.#p&&this.#k()))}M39(){return this.#M>0}M131(){return this.#M>0}M132(){return this.#M>0}#k(){t.K32;const i=this.#f.length;for(let t=0;t<i;t++)"function"!=typeof this.#f[t]||this.#f[t](this);this.#f.length=0}M113(t=!0){return this.#a=!!t,this.#h.dataset.smooth=this.#a?"yes":"no",this}M133(){return this.#a}M114(){return new Promise(t=>this.M74(()=>t(this)))}M74(t){return"function"!=typeof t?this:this.#p?(this.#f.push(t),this):void 0}M7(){this.#f.length=0}M13(t=!0){return this.#p=!!t,this}Error(t,i,...e){this.constructor.name,e.length>0&&e.forEach((t,i)=>{})}M115(){return this.#s}M116(t=-1){return this.#s=t,this}M189(t,i=-1){return null!==this.#o?(this.Error("SetBox","Already set",this.#o,t),this):(this.#o=t,i>=0&&(this.#s=i),this)}M134(){return this.#o=null,this.#s=-1,this}M190(){return this.#o}M219(t){return this.#o===t}M191(){return null!==this.#o}#v(t){return!Number.isFinite(t)||t<0?(this.Error("SetTranslationTime","Bad number",t),this):this.#h?(this.#h.style.transitionDuration=t+"ms",this):this}M27(i=0){return this.#l=i||t.K24,this}M220(t){return t|=0,this.#e===t||(this.#e=t,this.#h.style.zIndex=t),this}M135(t){return!Number.isFinite(t)||t<0?(this.Error("SetBaseZ","Bad number",t),this):(t|=0,this.#e<t&&(this.#e=t),this.#h.style.zIndex=t,this)}#x(){this.#d=this.#t+(this.#r>>1),this.#_=this.#i+(this.#n>>1)}M54(){return this.#d}M40(){return this.#_}M4(t,i){const e=t-this.#i,s=i-this.#t;return Math.sqrt(e*e+s*s)/this.#l}M117(){return this.#m}M136(){return!this.#m}M95(t=!0){return t=!!t,this.#m===t||(this.#m=t,this.M15(t)),this}M41(){return this.#m=!this.#m,this.M15(this.#m),this}M96(){return this.#g}M75(t=!0){return t=!!t,this.#g===t||(this.#g=t,this.M20(t)),this}M33(){return this.#g=!this.#g,this.M20(this.#g),this}},b=1/0,E=class extends y{static K118=11;static K107=12;static K108=3;static K112=1;static K119=2;static K109=4;static K100=5;static K110=6;static K113=7;#L=11;#C=!0;#T=[];#A=null;#I=null;#N=null;#S=b;#P=0;#D=0;#R=0;#K=0;#O=!1;#F=0;#B=0;#V=!1;#z=0;#j=0;#H=y.K106;#G=null;#U=null;#q=null;#$=null;#W=!1;#Y=0;#X=!1;constructor(t,i,e,s,n,r=!1,h={}){const{max_count:o=b,sorting:a=null,tuck:l=!1,uniform:c=!1,parent:u=null,velocity_px_ms:d=0,reverse_z:_=!1}=h;super(t,i,r,d,{is_box:!0,parent:u}),this.#S=o,this.M76(_),this.#L=e,11!==e&&12!==e&&this.Error("FlexBox","Bad orientation",e),this.#C=11===this.#L,"function"==typeof a&&(this.#A=a);const M=Number.isFinite(this.#S)?this.#S:64;this.#G=new Int32Array(M),this.#U=new Int32Array(M),s=s||4,this.#N=this.#J(s),3!==(n=n||3)&&1!==n&&2!==n&&this.Error("FlexBox","Bad align",n),this.#I=this.#J(n),this.#V=c,l>0&&this.M163(l),this.ELEMENT&&this.ELEMENT.classList.add("FlexBox")}M161(){super.M161(),this.#T=null,this.#I=null,this.#N=null,this.#A=null}#Q(t,i){if(t.length<i){const e=t.length<<1;t=new Int32Array(e>i?e:i)}return t}M230(t,i=!0){if(!(t instanceof y))return this.Error("Add","Not a FlexBoxEntity",t),this;if(this.#T.includes(t))return this.Error("Add","Already here",t),this;if(this.M195())return this.Error("Add","I am full",t),this;t.M191()&&t.M190().M194(t),i?this.#T.push(t):this.#T.unshift(t);const e=this.#T.length;let s=!i&&e>1;return t.M189(this,i?this.#T.length-1:0),this.#Q(this.#G,e),this.#Q(this.#U,e),null!==this.#A&&(this.#T.sort(this.#A),s=!0),s&&this.#Z(),this.#V?(0!==this.#z&&0!=this.#j||(this.#z=t.M130(),this.#j=t.M112(),this.#W>0&&this.#tt()),this.#F+=this.#z,this.#B+=this.#j):(this.#F+=t.M130(),this.#B+=t.M112()),this.#O=!0,this.M8(),this}M192(t){return this.M230(t,!1)}M193(t){return this.M230(t,!0)}M194(t){return t instanceof y?this.#T.includes(t)?(t.M134(),t.M7(),i.M11(this.#T,t),this.#Z(),this.#V?(this.#F-=this.#z,this.#B-=this.#j):(this.#F-=t.M130(),this.#B-=t.M112()),this.#O=!0,this.M8(),this):(this.Error("Remove","Not here",t.ID),this):(this.Error("Remove","Not a FlexBoxEntity",t),this)}M156(t,i){t|=0,i|=0,super.M156(t,i),this.#P=t,this.#D=i}M110(t,i,e,s,n=!0){return t|=0,i|=0,e|=0,s|=0,super.M110(t,i,e,s),this.#P=t,this.#D=i,this.#K=e,this.#R=s,n&&this.M8(),this}M28(t,i,e=-1){return this.#z=0|t,this.#j=0|i,this.#W>0&&this.#tt(),this.#V=!0,this.#O=!1,e>=0&&(this.#H=e),this.M14(),this}M76(t=!0){this.#X=!!t,this.M8()}M29(t=-1){t>=0&&(this.#H=0|t)}M14(){let t=0,i=0;const e=this.#T.length;if(e>0){if(this.#V){if(0===this.#z||0===this.#j){const t=this.#T[0];this.#z=t.M130(),this.#j=t.M112(),this.#W>0&&this.#tt()}t=e*this.#z,i=e*this.#j}else for(let s,n=0;n<e;n++)s=this.#T[n],t+=s.M130(),i+=s.M112();(isNaN(t)||isNaN(i))&&this.Error("UpdateEntitiesSize","total width/height is NaN"),(t<0||i<0)&&this.Error("UpdateEntitiesSize","total width/height is negative",t,i)}return this.#F=t,this.#B=i,this.#O=!0,this}#it(t=-1){if(-1===t&&(t=this.#T.length),0===t)return this;this.#O||this.M14();const i=this.#C;let e=i?this.#F:this.#B,s=this.#W&&t>1;if(s){const n=i?this.#P:this.#D;s=e>n,s&&(this.#et(t,n,e),e-=(t-1)*this.#Y)}return i?(this.#q=this.#N(!0,!0,e,t),this.#$=this.#I(!1,!1,this.#B,t)):(this.#$=this.#N(!0,!1,e,t),this.#q=this.#I(!1,!0,this.#F,t)),s&&this.#st(i,t),t}#et(t,i,e){this.#C?this.#z:this.#j;const s=(e-i)/(t-1);this.#Y=s}#st(t,i){const e=t?this.#q:this.#$;for(let t=1;t<i;t++)e[t]-=t*this.#Y}M163(t=!0){this.#W=!!t,this.#W&&this.M8()}M137(t){return this.#V||0===t?t<0||t>1?(this.Error("SetTuck","Tuck must be [ 0 .. 1 ]",t),this):(this.#W=t,this.#tt(),void(this.#T.length>1&&this.M8())):(this.Error("SetTuck","Cannot tuck non-uniform entities"),this)}#tt(){if(!this.#V)return void(this.#Y=0);const t=this.#C?this.#z:this.#j;this.#Y=t*this.#W|0}M73(t,i){super.M73(t,i),this.#K=t,this.#R=i}M8(t=!0){const i=this.#T.length;if(0===i)return this;t&&this.#it(i);const e=this.#H;for(let t=0;t<i;t++){const s=this.#T[t];this.#X?s.M220(e+(i-t)):s.M220(e+t),s.M73(this.#q[t],this.#$[t]),s.IS_BOX&&s.M8(!0)}return this}#nt(t,i=-1){if(i<0&&(i=t.M115()),this.#X){const e=this.#T.length;t.M220(this.#H+(e-i))}else t.M220(this.#H+i);return t.M73(this.#q[i],this.#$[i]),this}#J(t){switch(t){case 3:return this.#rt.bind(this);case 1:return this.#ht.bind(this);case 2:return this.#ot.bind(this);case 4:return this.#at.bind(this);case 5:return this.#lt.bind(this);case 6:return this.#ct.bind(this);case 7:return this.#ut.bind(this)}}#dt(t,i,e){const s=(t?this.#G:this.#U).subarray(0,e),n=i?this.#K:this.#R;var r=i?this.#z:this.#j;if(t&&this.#V)for(var h=0;h<e;++h)s[h]=n+h*r;else{var o=n;for(h=0;h<e;++h){if(t&&h>0){if(!this.#V){const t=this.#T[h-1];r=i?t.M130():t.M112()}o+=r}s[h]=o}}return s}#ht(t,i,e,s){return this.#dt(t,i,s)}#rt(t,i,e,s){const n=this.#dt(t,i,s),r=i?this.#P:this.#D,h=r-e>>1;var o=i?this.#z:this.#j;if(!t&&this.#V){const t=r-o>>1;for(var a=0;a<s;++a)n[a]+=t}else for(a=0;a<s;++a)if(t)n[a]+=h;else{if(!this.#V){const t=this.#T[a];o=i?t.M130():t.M112()}n[a]+=r-o>>1}return n}#ot(t,i,e,s){const n=this.#dt(t,i,s),r=i?this.#P:this.#D,h=Math.round(r-e);var o=i?this.#z:this.#j;if(!t&&this.#V){const t=r-o;for(var a=0;a<s;++a)n[a]+=t}else for(a=0;a<s;++a)if(t)n[a]+=h;else{if(!this.#V){const t=this.#T[a];o=i?t.M130():t.M112()}n[a]+=r-o}return n}#ut(t,i,e,s){const n=this.#dt(t,i,s),r=(i?this.#P:this.#D)>>1;var h=i?this.#z:this.#j;const o=n[0];for(var a=0;a<s;++a){if(!this.#V){const t=this.#T[a];h=i?t.M130():t.M112()}n[a]=o+r-(h>>1)}return n}#lt(t,i,e,s){if(s<2)return this.#ht(t,i,e,s);const n=this.#dt(t,i,s),r=i?this.#P:this.#D,h=Math.round((r-e)/(s-1));for(var o=1;o<s;++o)n[o]+=o*h;return n}#at(t,i,e,s){const n=this.#dt(t,i,s),r=i?this.#P:this.#D,h=Math.round((r-e)/(s+1));for(let t=0;t<s;++t)n[t]+=(t+1)*h;return n}#ct(t,i,e,s){if(s<2)return this.#rt(t,i,e,s);const n=this.#dt(t,i,s),r=((i?this.#P:this.#D)-e)/s,h=r>>1;for(let t=0;t<s;++t)n[t]+=h+t*r|0;return n}M77(t){return!Number.isFinite(t)||t<=0?(this.Error("SetMaxCount","Bad number",t),this):(this.#S=0|t,this)}M78(){return this.#S}M195(){return this.#T.length>=this.#S}M97(t){return"function"!=typeof t||(this.#A=t),this}M98(t){return this.#N=this.#J(t||4),this}M221(t){return"function"!=typeof t&&(t=this.#A),"function"!=typeof t||(this.#T.sort(t),this.#Z(),this.M8()),this}#Z(t=-1){if(t<0&&(t=this.#T.length),!(t<0))for(let i=0;i<t;++i)this.#T[i].M116(i)}M164(){const t=this.#T.length;return t<=1||(M12(this.#T),this.#Z(t),this.M8()),this}M165(){return 0===this.#T.length}M138(t){return this.#T.includes(t)}M139(){return this.#T.length}M166(t){if("function"!=typeof t)return this;const i=this.#T.length;for(let e,s=0;s<i;s++)e=this.#T[s],t(e);return this}M167(){return this.#T.length>0?this.#T[0]:null}M99(){if(this.#T.length<=0)return null;const t=this.#T[0];return this.M194(t),t}M168(){const t=this.#T.length;return t>0?this.#T[t-1]:null}M100(){const t=this.#T.length;if(t<=0)return null;const i=this.#T[t-1];return this.M194(i),i}M79(t){return t<0||t>=this.#T.length?(this.Error("GetEntityAt","Bad idx",t),null):this.#T[t]}M196(){return[...this.#T]}M80(t){return"function"!=typeof t?null:this.#T.filter(t)}M209(){const t=this.#T.length;if(0===t)return this;for(let i=0;i<t;i++){const t=this.#T[i];t.M134(),t.M7()}return this.#T.length=0,this.#F=0,this.#B=0,this.#O=!0,this}#_t(t=0){const i=this.#T.length+t;return i>this.#S?(this.Error("#PrepareBatchAdd","Total exceeds max_count",i),this):(i>0&&(this.#G=this.#Q(this.#G,i),this.#U=this.#Q(this.#U,i)),this)}M140(t,i=!0,e=0){const s=t.length;if(0===s)return this;if(this.M195())return this.Error("BatchAdd","I am full"),this;const n=this.M139()+s;if(n>this.M78())return this.Error("BatchAdd","Not enough space"),this;for(let i=0;i<s;i++){const e=t[i];if(!(e instanceof y))return this.Error("BatchAdd","Not a FlexBoxEntity",e),this;if(this.#T.includes(e))return this.Error("BatchAdd","Already here",e),this}const r=[...this.#T],h=r.length;this.#_t(s);for(let e=0;e<s;e++){const s=t[e];s.M191()&&s.M190().M194(s),s.M189(this),i?this.#T.push(s):this.#T.unshift(s);const n=this.#V?this.#z:s.M130(),r=this.#V?this.#j:s.M112();this.#F+=n,this.#B+=r}this.#O=!0,null!==this.#A&&this.#T.sort(this.#A),this.#Z(n),this.#it(n);for(let t=0;t<h;t++){const i=r[t];this.#nt(i)}if(0===e)for(let i=0;i<s;i++){const e=t[i];this.#nt(e)}else{let i=e;e<=1&&(i=this.M2(t[0])*e);let n=0;for(let e=0;e<s;e++){const s=t[e];setTimeout(()=>{this.#nt(s)},n),n+=i}}return this}M81(t=null,e=0){const s=null===t?[...this.#T]:t,n=s.length;if(0===n)return this;for(let t=0;t<n;t++){const i=s[t];if(!(i instanceof y))return this.Error("BatchRemove","Not a FlexBoxEntity",i),this;if(!this.#T.includes(i))return this.Error("BatchRemove","Not here",i),this}for(let t=n-1;t>=0;t--){const e=s[t];i.M11(this.#T,e),e.M134(),e.M7();const n=this.#V?this.#z:e.M130(),r=this.#V?this.#j:e.M112();this.#F-=n,this.#B-=r}this.#O=!0;const r=this.#T,h=r.length;if(this.#Z(h),this.#it(h),0===e)this.M8(!1);else{let t=e;e<=1&&(t=this.M2(r[0])*e);let i=t;for(let e=0;e<h;e++){const s=r[e];setTimeout(()=>this.#nt(s),i),i+=t}}return this}M2(t){if(!t.M219(this))return this.Error("GetEntityTranslationTime","Not here",t),0;const i=t.M115();return i<0||i>=this.#T.length?(this.Error("GetEntityTranslationTime","Bad index",t),0):t.M1(this.#q[i],this.#$[i])}M3(t){return t.EstimateTravelTime(this.M40(),this.M54())}M169(t=""){for(let t=0;t<this.#T.length;++t)this.#T[t];return!0}},v={smooth:!0,touch_down_events:!1,visible:!1,selected:!1,velocity_px_ms:1,flip_time:500,face_up:!0,flip_axis:"y"},x=class t extends y{static K106=110;#Mt=null;#pt=null;#ft=null;#mt=v.face_up;constructor(t){super(t,"Card_"+t,!0),this.#gt(t),i.M5(this,"BODY",this.#Mt),i.M5(this,"FACE",this.#pt),i.M5(this,"BACK",this.#ft),this.M210()}M161(){super.M161()}M210(i={}){for(const t in v){const e=i[t]??v[t];i[t]=e}this.M191()&&this.M190().M194(this),this.M7(),this.M113(i.smooth),this.M13(i.touch_down_events),this.M27(i.velocity_px_ms),this.M95(i.visible),this.M75(i.selected),this.M220(t.K106),this.M82(i.flip_time),this.M118(i.face_up),this.M83(i.flip_axis)}#gt(i){this.ELEMENT.classList.add("Card"),this.#Mt=document.createElement("div"),this.#Mt.classList.add("CardBody"),this.#Mt.classList.add("Clickable"),this.#Mt.dataset.idx=i,this.#Mt.card=this,this.#Mt.dataset.face=this.#mt?"up":"no",this.#Mt.dataset.visible=this.M117()?"yes":"no",this.#pt=document.createElement("div"),this.#pt.classList.add("CardFace"),this.#ft=document.createElement("div"),this.#ft.classList.add("CardBack"),this.#Mt.appendChild(this.#pt),this.#Mt.appendChild(this.#ft),this.ELEMENT.appendChild(this.#Mt),this.M135(t.K106)}M9(){return this.#Mt}M118(t=!0){return this.#mt=!!t,this.#Mt.dataset.face=this.#mt?"up":"down",this.OnFlip&&this.OnFlip(t),this}M141(){return this.#mt}M101(){return!this.#mt}M15(t){return this.#Mt.dataset.visible=t?"yes":"no",this}M20(t){return this.#Mt.dataset.selected=t?"yes":"no",this}M82(t){return!Number.isFinite(t)||t<0?(this.Error("SetFlipTime","Bad number",t),this):(this.#Mt.style.transitionDuration=t+"ms",this)}M83(t="x"){if("string"!=typeof t||1!==t.length)return this.Error("SetFlipAxis","Bad axis",t),this;if("x"!==(t=t.toLowerCase())&&"y"!==t)return this.Error("SetFlipAxis","Bad axis",t),this;const i="x"===t?"1":"0",e="y"===t?"1":"0";return this.#Mt.style.setProperty("--ROT_X",i),this.#Mt.style.setProperty("--ROT_Y",e),this}M222(){return this.#mt=!this.#mt,this.#Mt.dataset.face=this.#mt?"up":"down",this.OnFlip&&this.OnFlip(this),this}},k={};((t,i)=>{for(var e in i)w(t,e,{get:i[e],enumerable:!0})})(k,{K55:()=>D,K56:()=>K,K87:()=>R,K70:()=>H,K71:()=>Z,K72:()=>P,K88:()=>N,K89:()=>S,K25:()=>X,K26:()=>Y,K96:()=>U,K90:()=>q,K73:()=>G,K91:()=>W,K74:()=>J,K75:()=>$,K47:()=>Q,K57:()=>T,K58:()=>A,K76:()=>L,K27:()=>I,K77:()=>C,K114:()=>z,K78:()=>O,K33:()=>F,K59:()=>V,K79:()=>j,K60:()=>B});var L=0,C=6,T=10,A=14,I=15,N=63,S=15,P=15,D=1<<T,R=2<<T,K={[D]:"Black",[R]:"Red"},O=1<<C,F=2<<C,B=3<<C,V=4<<C,z=[O,F,B,V].sort(),j={[O]:"Clubs",[F]:"Diamonds",[V]:"Hearts",[B]:"Spades"},H=1<<A,G=0,U=1,q=11,$=12,W=13,Y=Math.min(q,$,W),X=Math.max(q,$,W),J={[U]:"Ace",[q]:"Jack",[$]:"Queen",[W]:"King"},Q={[U]:"A",[q]:"J",[$]:"Q",[W]:"K"},Z={name:"Joker",suit:"joker",symbol:"JKR",rank:G,flag:H},tt=class extends x{#wt=!1;#yt=!1;#bt=null;constructor(t,e){super(t),i.M5(this,"DNA",e);const s=e&N,n=e&S<<C,r=e&P<<T;i.M5(this,"RANK",s),i.M5(this,"SUIT",n),i.M5(this,"COLOR",r),this.#wt=0!==(e&H),this.#yt=!this.#wt&&this.RANK>=Y&&this.RANK<=X,this.#Et(),this.#vt()}M142(){return"("+this.IDX+") "+this.M84()+" of "+this.M85()}#Et(){const t=this.M84().toLowerCase(),i=this.M85().toLowerCase(),e=this.M211()?"red":"black",s=this.BODY;s.dataset.rank=t,s.dataset.suit=i,s.dataset.color=e,this.#wt?s.dataset.joker="yes":this.#yt&&(s.dataset.royal="yes")}#vt(){const t=this.M43().toUpperCase(),i=this.M85();this.FACE.innerHTML="";const e=document.createElement("p");e.innerText=t,this.#bt=e,this.#yt&&this.M42(this.RANK),this.FACE.appendChild(this.#bt);{const t=this.#xt(i.toLowerCase());this.FACE.appendChild(t)}}M42(t){const i=document.createElement("span");i.innerText=t,this.#bt.appendChild(i)}#xt(t){this.M211();const i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("class","SuitIcon"),i.innerHTML=`<use href="#suit-${t}"/>`,i}M156(t,i){super.M156(t,i),this.FACE.style.fontSize=Math.round(.4*t)+"px"}static async M119(t){try{const i=M19("flex-box/"),e=await fetch(i+t),s=await e.text(),n=document.getElementById("card-sprite-sheet");n&&n.remove();const r=document.createElement("div");r.id="card-sprite-sheet",r.style.display="none",r.innerHTML=s,document.body.appendChild(r)}catch(t){}}M211(){return this.COLOR===R}M170(){return this.COLOR===D}M171(){return this.#wt}M172(){return this.#yt}M143(){return!this.#wt&&!this.#yt}M212(){return this.RANK===U}M197(){return this.RANK===q}M173(){return this.RANK===$}M198(){return this.RANK===W}M199(){return this.RANK%2==0}M213(){return this.RANK%2!=0}M200(t){return this.SUIT===t}M84(){return this.#wt?Z.name:J[this.RANK]||this.RANK.toString()}M85(){return this.#wt?Z.suit:j[this.SUIT]||"Unknown"}M43(){return this.#wt?Z.symbol:Q[this.RANK]||this.M84()}M55(){return K[this.COLOR]||"Unknown"}},it=1/0,et=!0,st=!0,nt=class extends E{#mt=st;#kt=et;constructor(t,i,e,s,n,r,h={}){const{max_cards:o=it,flip_after:a=et,face_up:l=st,sorting:c=null,tuck:u=!1,uniform:d=!0,parent:_=null,reverse_z:M=!1}=h;super(t,i,e,s,n,r,{max_count:o,sorting:c,tuck:u,uniform:d,parent:_,reverse_z:M}),this.M29(tt.K106),this.ELEMENT&&this.ELEMENT.classList.add("BoxOfCards"),this.M118(l),this.M56(a)}#Lt(t,i){t.M118(i)}M230(t,i=!0){return t instanceof tt?(super.M230(t,i),this.#kt?t.M74(this.#Lt.bind(this,t,this.#mt)):t.M118(this.#mt),this):(this.Error("Add","Not a Card instance",t),this)}M192(t){return this.M230(t,!1)}M193(t){return this.M230(t,!0)}M138(t){return t instanceof tt?super.M138(t):(this.Error("Includes","Not a Card instance",t),this)}M140(t,i=!0,e=0){const s=t.length;if(0===s)return this;for(let i=0;i<s;i++){const e=t[i];if(!(e instanceof tt))return this.Error("BatchAdd","Not a Card instance",e),this}if(this.M139()+s>this.M78())return this.Error("BatchAdd","I am full"),this;super.M140(t,i,e);for(let i=0;i<s;i++){const e=t[i];this.#kt?e.M74(this.#Lt.bind(this,e,this.#mt)):e.M118(this.#mt)}return this}M194(t){return t instanceof tt?(super.M194(t),this):(this.Error("Remove","Not a Card instance",t),this)}M81(t=null,i=0){const e=null===t?[...this.GetEntities()]:t,s=e.length;if(0===s)return this;for(let t=0;t<s;t++){const i=e[t];if(!(i instanceof tt))return this.Error("Remove","Not a Card instance",i),this}return super.M81(t,i),this}M120(t){return super.M79(t)}M118(t=!0){return this.#mt=!!t,this}M56(t=!0){return this.#kt=!!t,this}};function rt(t,i){return t.IDX-i.IDX}var ht=class{#Ct=[];#Tt=[];#At=[];#It=null;#Nt=0;#St=[];constructor(t={},i={}){const{jokers:e=0,exclude_ranks:s=[],exclude_cards:n=[],suits:r=z,seed:h=0}=t;this.#Nt=h,this.#Pt(r,s,n,e),this.#It={smooth:i.smooth??!0,touch_down_events:i.touch_down_events??!0,velocity_px_ms:i.velocity_px_ms??100,flip_time:i.flip_time??500,face_up:i.face_up??!0,visible:i.visible??!0,flip_axis:i.flip_axis??"y"},this.M210()}#Dt(t,i,e){return(t&N)===i&&(t&S<<C)===e}#Pt(t,i,e,s){for(const s of t){const t=s===F||s===V?R:D;for(let n=1;n<=13;n++){if(i.includes(n))continue;if(e.some(t=>this.#Dt(n|s,t.rank,t.suit)))continue;const r=n|s|t,h=new tt(this.#Ct.length,r);this.#Ct.push(h)}}for(let t=0;t<s;t++){const i=H|(t%2==0?D:R),e=new tt(this.#Ct.length,i);this.#Ct.push(e)}}M86(t){let i=0;for(const e of t)for(let t=0;t<this.#Ct.length;++t){const s=this.#Ct[t];if(this.#Dt(s.DNA,e.rank,e.suit)){i+=1,this.#Ct.splice(t,1),this.#St.push(s);break}}this.#Rt()}M57(t){}#Rt(){this.#At=[],this.#Tt=this.#Ct.map((t,i)=>i)}M210(t={}){this.#Rt();const i=new Set;this.#Ct.forEach(t=>{const e=t.M190();e&&i.add(e)}),i.forEach(t=>t.M209());const e=this.#It;for(const i in t)e.hasOwnProperty(i)&&(e[i]=t[i]);for(const t of this.#Ct)t.M210(e);return this}M223(t=null,i=0){if(null===t)return this;const e=this.M175(),s=i>0;return this.M166(t=>{t.M95(s),t.M113(s),t.M82(0),t.M118(!1)}),t.M140(e,!0,i>0?i:0),this.M166(t=>{t.M82(this.#It.flip_time),t.M113(this.#It.smooth)}),this}M164(t=0){let e=Math.random;0!==(t=t||this.#Nt)&&(t="string"==typeof t?M93(t):t,e=i.M23(t));const s=this.#Tt;for(let t=s.length-1;t>0;t--){const i=Math.floor(e()*(t+1));[s[t],s[i]]=[s[i],s[t]]}return this}M174(t=0){return this.#Nt="string"==typeof t?M93(t):0|t,this.#Nt}M224(){if(0===this.#Tt.length)return null;const t=this.#Tt.pop();return this.#At.push(t),this.#Ct[t]}M175(){const t=[];return this.#Tt.forEach(i=>{t.push(this.#Ct[i])}),this.#At=this.#Tt,this.#Tt=[],t}M144(){const t=this.#Tt[this.#Tt.length-1];return this.M176(t)}M176(t){return this.#Ct[t]}M44(t){if("function"!=typeof t)return[];const i=[];for(let e=this.#Tt.length-1;e>=0;e--){const s=this.#Tt[e],n=this.#Ct[s];t(n)&&(this.#Tt.splice(e,1),this.#At.push(s),i.push(n))}return i}M58(t,i){t|=0,i|=0,this.#Ct.forEach(e=>e.M156(t,i))}M177(){return this.#Ct.length}M21(){return this.#Tt.length}M166(t){return"function"!=typeof t||this.#Ct.forEach((i,e)=>t(i,e)),this}M22(t,i){const e=t.SUIT,s=i.SUIT;return e<s?-1:e>s?1:Math.sign(t.RANK-i.RANK)}},ot="off",at=class extends nt{static K61=ot;static K62="top";static K34="right";static K28="bottom";static K48="left";#Kt=null;#Ot=!1;#Ft=0;#Bt=null;constructor(t,e,s={}){const{max_cards:n=1/0,counter_position:r=ot,pop_effect:h=!1,face_up:o=!0,parent:a=null}=s;super(t,e,E.K118,E.K113,E.K108,!0,{max_cards:n,parent:a}),this.#Vt(),this.#zt(),this.M16(r),this.M59(h),this.M118(o),i.M5(this,"COUNTER",this.#Kt)}#Vt(){const t=this.ELEMENT;t.classList.add("PileOfCards");const i=document.createElement("span");i.classList.add("PileCounter"),i.innerText="0",t.appendChild(i),this.#Kt=i}M230(t,i=!0){return super.M230(t,i),this.#jt(t,i),this}#jt(t,i=!0){t.M133()?(this.#Ft++,t.M74(()=>{this.#Ft--,this.#zt(),this.#Ht(i?t:null),i||this.#Bt===t||t.M95(!1)})):(this.#Ht(i?t:null),i||this.#Bt===t||t.M95(!1),this.#zt())}#Ht(t=null){const i=this.M139();if(0===i)return void(this.#Bt=null);const e=this.#Bt;if(null===t)for(let e=i-1-this.#Ft;e>=0;--e){const i=this.M79(e);if(!i.M131()){t=i;break}}e!==t&&(e&&e.M95(!1),this.#Bt=t,t.M95(!0))}M140(t,i=!0){super.M140(t,i);const e=t.length;let s;for(let i=0;i<e;i++)s=t[i],s.M95(!1);return this.#zt(),this.#Ht(i?s:null),this}M194(t){return super.M194(t),this.#Gt(t),this}#Gt(t,i=!0){t.M95(!0),t.M131()&&this.#Ft--,i&&(this.#Bt===t&&(this.#Bt=null,this.#Ht(null)),this.#zt())}M81(t=null,i=0){const e=this.#Bt,s=null===t?[...this.GetEntities()]:t,n=s.length;if(0===n)return this;super.M81(t,i);for(let t=0;t<n;t++){const i=s[t];this.#Gt(i,!1)}return s.includes(e)&&this.#Ht(),this.#zt(),this}M209(){return super.M209(),this.#Bt=null,this.#Ft=0,this.#zt(),this}M145(t){return this.M230(t,!0)}M87(t){return this.M230(t,!1)}M88(){const t=this.M168();return t&&this.M194(t),t}M34(){const t=this.M167();return t&&this.M194(t),t}M188(){return this.M168()}M121(){return this.M167()}M164(){const t=this.M139();if(t>0&&this.#Ut(),t<=1)return;const i=this.#Bt;super.M164();const e=this.M79(t-1);return i!==e&&(i.M95(!1),e.M95(!0),this.#Bt=e),this}M16(t){return this.ELEMENT.dataset.counter=t,this}M59(t){return this.#Ot=!!t,this}#zt(){const t=this.M139()-this.#Ft;this.#Kt.innerText=t,this.#Ot&&this.#Ut()}#Ut(){const t=this.#Kt;t.classList.remove("PopEffect"),this.M72(),t.classList.add("PopEffect")}debug(){const t=this.M139();for(let i=0;i<t;++i)this.M79(i)}M178(){const t=this.M139();return 0===t?null:this.M79(t-1)}M102(){return 0===this.M139()?null:this.M79(0)}},lt=class{#qt;#$t=[];#Wt;#Yt={};#Xt=null;#Jt="";constructor(t,i,e){this.#qt=t+"_",this.#Wt=i,this.#Jt=e??""}M122(t,i){this.#$t.push({id:t,schema:i}),i.forEach(t=>{const i=localStorage.getItem(this.#qt+t.id);null!==i?this.#Yt[t.id]=this.#Qt(i):(this.#Yt[t.id]=t.default,this.M225(t.id,t.default))})}#Qt(t){return"true"===t||"false"!==t&&(isNaN(t)||""===t?t:Number(t))}M201(){for(const{id:i,schema:e}of this.#$t)this.#Zt(t(i),e)}#Zt(t,i){if(!t)throw new Error("SettingsManager::RenderTo » No parent");this.#Xt=t;const e=i.map(t=>this.#ti(t));this.#Xt.innerHTML=e.join(""),this.#Xt.querySelectorAll("INPUT").forEach(t=>{this.#ii(t).classList.contains("AppSettingNotImplemented")||t.classList.add("Clickable")}),this.#Xt.querySelectorAll("LABEL").forEach(t=>{this.#ii(t).classList.contains("AppSettingNotImplemented")||t.classList.add("Clickable")}),this.#ei()}#ii(t){let i=t.parentElement;do{if("DIV"===i.tagName&&i.classList.contains("AppSettingsRow"))return i;i=i.parentElement}while(null!==i);return i}#ti(t){const i=this.#Yt[t.id];let e="";"radio"===t.type?e=t.options.map((e,s)=>`\n                <label>\n                    <input type='radio' name='${t.id}' value='${s}' ${i===s?"checked":""}>\n                    ${e}\n                </label>\n            `).join(""):"range"===t.type?e=`\n                <input type='range' id='${t.id}' \n                    min='${t.min}' max='${t.max}' step='${t.step}' \n                    value='${i}'>\n            `:"checkbox"===t.type?e=`\n                <input type='checkbox' id='${t.id}' ${i?"checked":""}>\n            `:"text"===t.type&&(e=`\n                <input type='text' id='${t.id}' \n                    value='${i}'>\n            `);let s="AppSettingsRow";return t.not_implemented&&(s+=" AppSettingNotImplemented"),`\n            <div class='${s}' data-setting-id='${t.id}'>\n                <p class='AppSettingsMainLabel'>${t.label}</p>\n                <div class='AppSettingsInputWrapper'>${e}</div>\n            </div>\n        `}#ei(){this.#Xt.addEventListener("input",t=>{t.stopPropagation(),t.preventDefault();const i=t.target,e=i.name||i.id;let s="checkbox"===i.type?i.checked:i.value;isNaN(s)||"range"!==i.type||(s=Number(s)),this.M45(e,s)}),this.#Xt.addEventListener(this.#Jt,t=>{"INPUT"===t.target.tagName&&(t.is_onesie_ui=!0),"LABEL"===t.target.tagName&&(t.is_onesie_ui=!0)})}M45(t,i){this.#Yt[t]=i,this.M225(t,i),this.#Wt&&this.#Wt(t,i)}M225(t,i){localStorage.setItem(this.#qt+t,i)}M231(t){return this.#Yt[t]}},ct="https://",ut="rqhvlh0vwdwv",dt=window.visualViewport,_t="AppRotate",Mt="AppError",pt="AppErrorInfo",ft="AppViewport",mt="PageHidden",gt="Hidden",wt=_t.toLowerCase(),yt=Mt.toLowerCase(),bt="Home".toLowerCase(),Et="Play".toLowerCase(),vt=class s{static K92=1;static K97=2;static K116=3;#si=null;#ni=null;#ri=new Map;#hi=s.K92;#oi=null;#ai=null;#li=null;#ci=null;#ui=null;#di=null;#_i=null;#Mi=null;#pi=null;#fi=null;#mi=null;#Jt="";#gi=!0;#wi=null;#yi=null;constructor(t={}){this.#Jt=i.M128?"touchstart":"click",this.#bi(t);const e=t.start_page||bt;requestAnimationFrame(()=>this.M147(e))}#bi(t){if(this.#si=document.getElementById(ft),null===this.#si)throw new Error("App » Element not found: #"+ft);this.#Ei();const i=this.#ri.get(wt);if(!i)throw new Error("App » Element not found: #"+_t);i.classList.add(_t);const e=this.#ri.get(yt);if(!e)throw new Error("App » Element not found: #"+Mt);if(e.classList.add(Mt),this.#ai=document.getElementById(pt),!this.#ai)throw new Error("App » Element not found: #"+pt);this.#vi(t),this.#xi(),this.#ki(),this.#Li(),this.#Ci(t),this.#Ti(t),this.#hi=t.page_mode??1,this.#Ai(),this.#Mi=t.on_resize||this.#Mi||null,this.#pi=t.on_click||this.#pi||null,this.#fi=t.on_page||this.#fi||null}#vi(t){const i=new x("Onesie");i.M95(!0),i.M118(!1),i.M113(!1),this.#di=i;const e=this.#ri.get(bt);if(e.appendChild(i.ELEMENT),e.classList.add("Clickable"),t.blank_card)return;const s=t.game_name||"Some Card Game",n=t.game_designer||"Some Great Designer",r=t.game_build||("undefined"!=typeof BUNDLE_ID?BUNDLE_ID:"0000-0000-0000"),h="p";if(!t.blank_back){const t=document.createElement(h);t.classList.add("h1"),t.innerHTML="ONESIE",i.BACK.appendChild(t);const e=document.createElement(h);e.classList.add("h2"),e.innerHTML="1p card games",i.BACK.appendChild(e);const s=document.createElement(h);s.classList.add("h3"),s.innerHTML="build:<br><span>"+r+"</span>",i.BACK.appendChild(s)}if(!t.blank_face){const t=document.createElement(h);t.classList.add("h1"),t.innerHTML=s;const e=document.createElement(h);e.classList.add("h2"),e.innerHTML="<small>designed by:</small><br>"+n;const o=document.createElement(h);o.classList.add("h2"),o.innerHTML="<small>coded by:</small><br>Pedro Fontoura";const a=document.createElement(h);a.classList.add("h3"),a.innerHTML="build:<br><span>"+r+"</span>";const l=document.createElement(h);l.classList.add("h3"),l.innerHTML="♦ a solitaire card game ♦";for(const s of[t,l,e,o])i.FACE.appendChild(s)}}#Ei(){document.querySelectorAll("#"+ft+" > section").forEach(t=>{this.#ri.set(t.id.toLowerCase(),t),t.classList.add(mt)})}#Li(){window.addEventListener("resize",()=>this.#Ai()),window.addEventListener("contextmenu",t=>{if(t.preventDefault(),t.stopPropagation(),"touchstart"===this.#Jt)return;const i=new MouseEvent(this.#Jt,{view:window,bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});t.target.dispatchEvent(i)},{passive:!1}),window.addEventListener("unhandledrejection",t=>{if(t.preventDefault(),t.stopPropagation(),t.reason.stack){const i=[this.#Ii(t.reason.stack)].join("<br>");this.#Ni("Rejected",i)}else this.#Ni("Rejected",t.reason.message)}),window.addEventListener("error",t=>{t.preventDefault(),t.stopPropagation();const i=[t.error.message,t.error.fileName,t.error.lineNumber,this.#Ii(t.error.stack)].join("<br>");this.#Ni("Error",i)}),this.#ci.addEventListener(this.#Jt,t=>{this.#Si(),t.stopPropagation(),this.#ui.classList.toggle(gt)}),Array.from(this.#ui.children).forEach(t=>{const i=this.#Pi(t);this.#ri.get(i)?t.addEventListener(this.#Jt,t=>{this.#Si(),t.stopPropagation(),this.#Di(t)}):t.remove()}),this.#di.M9().addEventListener(this.#Jt,t=>{this.#Si(),t.stopPropagation(),this.#di.M141()?this.M147(Et):this.#di.M222()}),this.M179(bt).addEventListener(this.#Jt,t=>{this.#Si(),t.stopPropagation(),this.#di.M222()}),window.addEventListener(this.#Jt,t=>{t.stopPropagation(),this.#Ri(t)})}#Si(){i.M50||i.M128&&i.M18()}#Di(t){const i=this.#Pi(t.target);this.#ri.get(i)&&this.M147(i)}#Ri(t){if(t.is_onesie_ui)return;let i=0,e=0;if("touchstart"===this.#Jt){const s=t.touches[0];i=s.clientX,e=s.clientY}else i=t.clientX,e=t.clientY;if(this.#pi){if(!this.#gi)return;this.#pi(t.target,0|i,0|e)}}#xi(){this.#li=document.getElementById("AppSideMenu"),this.#ci=document.getElementById("AppSideMenuMain"),this.#ui=document.getElementById("AppSideMenuGroup"),this.#ui.classList.add(gt),i.M128&&this.#li.classList.add("TopSpacing")}#Ii(t){return"string"==typeof t?t.split("at ").join("<br>&bull; "):"Stack: "+t}#Ni(t,i){null!==this.#ai&&(this.#ai.innerHTML+="<h3>"+t+"</h3>"+i,this.M147(yt))}#Ai(){const t=dt.width,i=dt.height;if(this.#Ki(),this.#di){const e=.75*Math.min(t,i)|0,s=.7*e|0;this.#di.M156(s,e),this.#di.M73(t-s>>1,i-e>>1)}this.#Mi&&this.#Mi(t,i,this.#li.offsetWidth)}get M214(){return dt.width}get M202(){return dt.height}#Ki(){3!==this.#hi&&((Math.sign(dt.width-dt.height)>=0?1:2)!==this.#hi?this.#ni!==wt&&(this.#oi=this.#ni,this.M147(wt)):null!==this.#oi&&(this.M147(this.#oi),this.#oi=null))}async#ki(){await this.M123("./assets/app_icons.svg","icons-sprite-sheet")}async M123(t,i){try{const e=await fetch(t),s=await e.text(),n=document.getElementById(i);n&&n.remove();const r=(new DOMParser).parseFromString(s,"image/svg+xml").querySelector("svg");r&&(r.id=i,r.style.display="none",document.body.insertAdjacentElement("afterbegin",r))}catch(t){}}async M146(t){try{const i=await fetch(t);return i.ok?await i.json():null}catch(t){return null}}#Pi(t){const i=t.querySelector("use");if(i)return(i.getAttribute("href")||i.getAttribute("xlink:href")).split("-").pop().toLowerCase()}get M103(){return this.#li.offsetWidth}get M226(){return this.#di}M147(t,i=!1){const e=this.#ni===t;t=t.toLowerCase();const s=this.#ri.get(t);if(!s)throw new Error("App » No such page: "+t);t===Et&&this.#gi,this.#ni&&this.#ri.get(this.#ni).classList.add(mt),s.classList.remove(mt),this.#ni=t,t===bt?this.#li.classList.add(gt):this.#li.classList.remove(gt);const n=this.#di;n&&n.M118(!1),this.#fi&&!i&&this.#fi(t,e)}M124(t){return this.#ni===t}M179(t){const i=this.#ri.get(t);if(!i)throw new Error("App » No such page: "+t);return i}M60(){const t=window.matchMedia("(display-mode: standalone)").matches,i=!0===window.navigator.standalone;return t||i}M148(t=!0){(t=!!t)&&this.#gi?this.#ui.classList.remove(gt):this.#ui.classList.add(gt)}M30(t,i){t.classList.add("Clickable"),t.addEventListener(this.#Jt,e=>{e.preventDefault(),e.stopPropagation(),i(t)})}get M232(){const t=new Date,e=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}-${String(t.getHours()).padStart(2,"0")}-${String(t.getMinutes()).padStart(2,"0")}`;return i.M93("Onesie"+e)}async M89(t=!0){const e=await this.#Oi();if("Wrpq}Qjt7qxvn"===i.M51(e,9))return this.#gi=!0,!0;let s=!1;return window.top===window.self&&"ynm{x6oxw}x~{j7pr}q~k7rx"===i.M51(window.location.hostname,9)&&(s=i.M17("key",0,!0)===this.M232),this.#gi=s,!s&&t&&this.#Fi(),s}#Fi(){const t=ct+i.M51("ynm{x6oxw}x~{j7pr}q~k7rx8xwn|rn8HyjpnFyuj",-9);self.location.replace(t)}#Oi=async()=>(await fetch(window.location.href,{method:"HEAD"})).headers.get("server");async M46(t,e=!0){const s=ct+i.M51("etm2gsyrxivetm2hiz3z6",-4)+"/"+i.M51(ut,-3)+"/"+i.M51(t,-5)+"/"+(e?"up":"down");if(!i.M50)try{const t=await fetch(s),i=await t.json();i.data&&i.data}catch(t){}}#Ci(i={}){const e=i.settings||{};"function"==typeof e.on_change&&(this.#mi=e.on_change),this.#_i=new lt(e.prefix??"GAME",this.#Bi.bind(this),this.#Jt),t("GameSettings")&&this.#_i.M122("GameSettings",e.schema||[]),t("GeneralSettings")&&this.#_i.M122("GeneralSettings",[{id:"deck_seed",label:"Deck seed",type:"text",default:"",not_implemented:!0},{id:"cards_theme",label:"Cards theme",type:"radio",options:["Normal","Vintage","Modern"],default:0,not_implemented:!0},{id:"cards_axis",label:"Cards flip axis",type:"radio",options:["Random","X","Y"],default:0,not_implemented:!0},{id:"cards_speed",label:"Cards speed",type:"range",min:1,max:5,step:1,default:3},{id:"cards_flip",label:"Cards flip time",type:"range",min:1,max:5,step:1,default:3}]),this.#_i.M201()}#Ti(e){const s=t("Stats");if(!s)return;const n=document.createElement("dl"),r=document.createElement("dt");r.innerHTML="Global stats";const h=document.createElement("dd");h.innerHTML="Wins: <span id='stats_wins'>#</span>";const o=document.createElement("dd");o.innerHTML="Losses: <span id='stats_losses'>#</span>",n.appendChild(r),n.appendChild(h),n.appendChild(o),s.appendChild(n),"function"==typeof Counter&&(this.#wi=new Counter({debug:!0,timeout:8e3,workspace:i.M51(ut,-3)}),"string"==typeof e.counter&&this.M104(e.counter,"get"))}async M104(t,e="get"){if(!["get","up","down"].includes(e))return;const s=i.M51(t,-5);if(!i.M50&&null!==this.#wi)try{const t=await this.#wi[e](s);"200"===t.code&&s.endsWith("-play")&&this.#Vi(t)}catch(t){}}#Vi(i){t("stats_wins")&&(t("stats_wins").innerHTML=i.data.up_count),t("stats_losses")&&(t("stats_losses").innerHTML=i.data.down_count)}M105(t,i=!1){const e=this.#_i.M231(t);return i?"cards_speed"===t?this.#zi(e):"cards_flip"===t?this.#ji(e):e:e}#Bi(t,i){switch(t){case"cards_theme":return void this.#Hi(i);case"cards_flip":if(null!==this.#yi)return void this.#Gi(i);break;case"cards_speed":if(null!==this.#yi)return void this.#Ui(i)}null!==this.#mi&&this.#mi(t,i)}#Hi(t){const i="./assets/"+"theme-#.svg".replace("#",t);this.M123(i,"card-sprite-sheet")}#zi(t){return e.M207(t||3,1,5,.25,2)}#Ui(t){if(null===this.#yi)return;const i=this.#zi(t);this.#yi.M166(t=>t.M27(i))}#ji(t){return e.M207(t||3,1,5,100,1100)}#Gi(t){if(null===this.#yi)return;const i=this.#ji(t);this.#yi.M166(t=>t.M82(i))}M180(t){this.#yi=t??null,this.#Ui(this.#_i.M231("cards_speed")),this.#Gi(this.#_i.M231("cards_flip")),this.#Hi(this.#_i.M231("cards_theme"))}},xt="fsm_data_changed",kt=class{#qi=()=>{};V43=!0;V40=new Map;V21=null;V30={};V26=[];V27=[];constructor(t,i=[]){if(this.#qi=t,i.length>0)for(const t of i)this.V26.push(t)}M35(t){this.#$i(t)}M47(t){if(null!==t&&!this.V40.has(t))throw new Error("FSM::AssertStateId » Unknown id: "+t)}M48(t){if(!this.V30.hasOwnProperty(t))throw new Error("FSM::AssertDataKey » Unknown key: "+t)}M61(t,i,e=null){this.M47(t),this.M47(i),null!==t&&t!==this.V21.ID||this.#$i(i,e)}#$i(t,i=null){if(this.V21&&this.V21.M227(),this.V21=this.V40.get(t),!this.V21)throw new Error("FSM::#TransitionTo » No state! Key:",t);return this.V21.M215(i),!0}M36(t){if(null!==t)return this.M47(t),this.V21.ID===t}M62(t,i={}){this.M47(t);for(const[t,e]of Object.entries(i))this.M48(t),e!==this.V30[t]&&(this.V30[t]=e,this.#Wi(t,e));return this.M36(t)}#Wi(t,i){this.V26.includes(t)&&this.#Yi(xt,{key:t,value:i})}M63(t,i){if(this.M47(t),"string"==typeof i)return this.M48(i),this.V30[i];const e={};for(const t of i)this.M48(t),this.V30[t],e[t]=this.V30[t];return e}M149(){const t=this.V30;for(const[i,e]of Object.entries(t));}M203(t=null,i,e){t&&this.M47(t),this.#Yi(i,e)}#Yi(t,i){this.#qi(t,i)}M125(t){this.M47(t),this.V21&&(this.V21.Sleep(),this.V27.push(this.V21)),this.V21=this.V40.get(t),this.V21.M215()}M150(){const t=this.V27;if(0===t.length)throw new Error("FSM::PopState » Stack is empty");this.V21.M227(),this.V21=t.pop(),this.V21.WakeUp()}},Lt=class{constructor(t,e){i.M5(this,"ID",t),i.M5(this,"CONTROLLER",e)}M215(t){}M227(){}M181(t,i){return!1}M90(t,i){return!1}M106(t,i){return!1}M203(...t){return this.CONTROLLER.M203(this.ID,...t)}M182(...t){return this.CONTROLLER.M63(this.ID,...t)}M183(...t){return this.CONTROLLER.M62(this.ID,...t)}M61(...t){return this.CONTROLLER.M61(this.ID,...t)}},Ct=class extends Lt{constructor(t){super(t)}},Tt=class extends Lt{constructor(t,i){super(t,i)}M215(){this.M203(_,!0)}},At=class extends Lt{constructor(t,i){super(t,i)}M215(){this.M203(_,!1)}},It=class extends Lt{#Xi=0;#Ji=0;#Qi=[];constructor(t,i){super(t,i)}async M215(){this.#Xi=0,this.#Qi=[],this.#Ji=this.M182("season");do{const t=await this.CONTROLLER.M126(this.ID);if(t.M171())if(t.M211()){if(this.#Xi+=1,1!==this.#Ji)break;this.#Qi.push(t)}else this.#Zi(t);else this.#Qi.push(t)}while(this.#Qi.length<2);this.#Qi.length<2?this.M61(r):(await this.CONTROLLER.M31(this.ID,this.#Qi),2!==this.#Xi?this.M61(o):this.#te())}#te(){this.CONTROLLER.M153(this.ID)?this.M61(a,!1):this.M61(r)}async#Zi(t){const i=this.CONTROLLER.M65(this.ID);if(!i.M200(k.K59))return void await this.CONTROLLER.M66(this.ID,t,i);await this.CONTROLLER.M32(this.ID,t,i);const e=1+this.M182("payment");this.M183({payment:e})}},Nt=class extends Lt{#ie=0;constructor(t,i){super(t,i)}async M215(t=null){const i=this.M182("choose_from");if(null===t)return this.#ie=0,void this.M61(l);if(this.#ie+=1,"recycle"!==t){if(2===i)return await this.CONTROLLER.M67(this.ID),void this.M61(h);"recycle"===t&&await this.CONTROLLER.M152(this.ID),this.#ie<2?this.M61(l):(await this.CONTROLLER.M67(this.ID),this.M61(a,!0))}else 2===i?(await this.CONTROLLER.M152(this.ID),this.M61(h)):(await this.CONTROLLER.M67(this.ID),this.M61(a,!0))}},St=class extends Lt{constructor(t,i){super(t,i)}async M215(t=!1){if(!t)return await this.CONTROLLER.M6(this.ID),await this.CONTROLLER.M24(this.ID),this.M183({choose_from:6}),void this.M61(o);await this.CONTROLLER.M25(this.ID),this.M183({season:2,choose_from:2}),this.M61(h)}},Pt=class extends Lt{#ee=null;constructor(t,i){super(t,i)}M215(){this.#ee=null}#se(){null!==this.#ee&&(this.#ee.M75(!1),this.#ee=null)}async M90(t,i){if(i===f)return null!==this.#ee&&this.#ee!==t&&this.#se(),t.M33(),t.M96()?this.#ee=t:this.#ee=null,!0;if(i===p)return null!==this.#ee?(this.#se(),!1):2===this.M182("choose_from")&&(this.M61(o,"recycle"),!0);if(i===m){if(!this.#ne(t))return this.#se(),!1;if(await this.CONTROLLER.M108(this.ID,t,this.#ee),this.#ee.M200(k.K33)){const t=await this.CONTROLLER.M49(this.ID,this.#ee);this.#re(t,this.#ee)}return this.#se(),this.M61(o,"add2plot"),!0}return i===g&&6===this.M182("choose_from")&&null===this.#ee?(this.M61(o,"recycle"),!0):(this.#se(),!1)}async M181(t,i){if(i===m){if(null===this.#ee)return!1;if(!this.#ee.M200(k.K60))return this.#se(),!1;const t=this.#ee;return this.#se(),await this.CONTROLLER.M127(this.ID,t),this.M61(o,"add_spade"),!0}return this.#se(),!1}#ne(t){return!(null===this.#ee||this.#ee.M200(k.K60)||this.#ee.M200(k.K78)&&!t.M200(k.K60)||this.#ee.M200(k.K59)&&!t.M200(k.K78)||this.#ee.M200(k.K33)&&!t.M200(k.K59)||!(this.#ee.RANK<=t.RANK))}#re(t,i){const e=i.RANK+this.M182("payment");if(this.M183({payment:e}),1===t){const t=[this.#ee.M40(),this.#ee.M54()];this.M203(u,{key:"1st_sale",center:t})}}},Dt=class extends Lt{constructor(t,i){super(t,i)}async M215(t=!1){this.CONTROLLER.M91(this.ID)?this.M182("payment")<20?this.M61(r):this.M61(n):this.M61(r)}},Rt=class extends kt{static K49=xt;#yi=null;#he=0;#oe=null;#ae=null;#le=null;#ce=null;#ue=null;#de=null;#_e=null;#Me=null;#pe=[];#fe=new Array(3);#me=[];#ge={position:new Array(2),status:0};#we=null;constructor(t={}){const{on_message_request:i,V26:e=[],parent_node:n=window.document.body}=t;super(i,e),this.#we=n,this.#ye();for(const t of e)this.V30.hasOwnProperty(t);this.#be(),this.M35(s),this.#Ee(),y.K32=!1}#ye(){this.V30.season=-1,this.V30.choose_from=0,this.V30.payment=-1}#be(){const t=[[s,Ct],[n,Tt],[r,At],[h,It],[o,Nt],[a,St],[l,Pt],[l,Pt],["state_End_Game",Dt]];for(const[i,e]of t)this.V40.set(i,new e(i,this))}M62(t,i){return super.M62(t,i),this.#ve(),this.V21.ID===t}#ve(){}async M181(t,i,e){let s=!1;this.V43||(s=await this.#xe(t)),this.#ge.position[0]=i,this.#ge.position[1]=e,this.#ge.status=s,this.M203(null,d,this.#ge)}async#xe(t){if(!t.classList.contains("Clickable"))return!1;if(t.classList.contains("CardBody")){const i=parseInt(t.dataset.idx),e=this.#yi.M176(i),s=this.#ke(e);return this.V21.M90(e,s)}const i=this.#Le(t);return await this.V21.M181(t,i)}#ke(t){const i=t.M190();if(i===this.#le)return p;if(i===this.#ce)return f;if(i===this.#ae)return g;for(const t of this.#pe)if(i===t)return m;return M}#Le(t){if(t===this.#le.ELEMENT)return p;if(t===this.#ce.ELEMENT)return f;for(const i of this.#pe)if(t===i.ELEMENT)return m;return M}M64(t){return!Number.isInteger(t)||t<=0?(this.M203(null,"msg#app:error","Invalid game_level: "+t),this):(this.V30.level=t,this)}M216(s={}){const n=i.M17("seed",Date.now()%1e6,!0);this.M203(null,c,n),this.#yi.M210(s).M164(n).M223(this.#ae),this.V43||(this.#Ce(),this.#Te());const r=e.M53()?"x":"y";this.#yi.M166(t=>{const i=t.BODY.style;i.transition="none",t.M83(r),t.M72(),i.transition="",t.FACE.classList.remove("Compost")}),this.M62(null,{season:1,choose_from:2,payment:0}),this.#fe.fill(null);const o=t("AppErrorHistory");o&&(o.innerHTML=""),this.#Ae(()=>{this.V43=!1,this.M35(h)})}async#Ae(t){const i=this.#ae.M80(t=>t.M171()&&t.M211());this.#ae.M81(i);const e=this.#ae.M80(t=>t.M171()&&t.M170());this.#ae.M81(e);const s=this.#ae.M80(()=>!0);this.#ae.M81(s);const n=i.concat(s);this.#le.M140(n),this.#oe.M140(e),await Promise.all(i.map(t=>t.M114())),i.forEach(t=>t.M118()),t()}M151(t,i,e=0){const s=Math.min(t,i),n=.03*s,r=(e||.1*s)+0*n,h=Math.floor((s-n-r)/6),o=Math.round(h/.7),a=6*h,l=4.1*o,c=Math.min(18,Math.round(.1*h))+"px",u=t-a-r>>1,d=t<i?.25*(i-l>>1):0,_=i-l-3*d>>1,M=.8*o|0,p=.66*M|0;this.#yi.M58(p,M);const f=.9*o|0,m=h;let g=_;const w=this.#_e,y=.1*o;w.style.height=.66*y+"px",w.style.width=a+"px",w.style.top=_+"px",w.style.left=u+"px",g+=.1*o,this.#ue.M28(p,M),this.#ue.M110(a,f,u,g),g+=o+d,this.#oe.M28(p,M),this.#oe.M110(m,f,u,g),this.#oe.COUNTER.style.fontSize=c;const b=this.#de.style;b.width=m+"px",b.height=f+"px",b.left=u+"px",b.top=g+"px",b.fontSize=Math.round(.3*h)+"px",this.#ae.M28(p,M),this.#ae.M110(m,f,u+5*h,g),this.#ae.COUNTER.style.fontSize=c;let E=u+1.5*h-1.5*.1*h;for(let t=0;t<3;++t){const i=this.#pe[t];i.M28(p,M),i.M110(m,f,E+t*h,g),E+=.1*o}return g+=o+d,this.#ce.M28(p,M),this.#ce.M110(a,f,u,g),g+=o+d,this.#le.M28(p,M),this.#le.M110(a,f,u,g),this}M184(){return this.#yi}M126(t){return this.M47(t),this.#le.M100()}async M107(t,i){this.M47(t)}async M31(t,i){return this.M47(t),this.#ce.M140(i),i[0].M114()}async M152(t){this.M47(t);const i=this.#ce.M80(t=>!0);return this.#ce.M209(),i.forEach(t=>t.M118(!1)),this.#le.M140(i,!1),i[0].M114()}async M127(t,i){this.M47(t);const[e,s]=this.#Ie();this.#Ne(i,s,!0),this.#ce.M194(i),await this.#Se(i,e);const n=this.#oe.M88();return this.#fe[s]=n,await this.#Se(n,this.#le,!1),n.M118(!0),i}#Ne(i,e,s=!0){i.SUIT;let n=k.K79[i.SUIT][0],r=[i.RANK,n,e].join("");s||(r="("+r+")"),this.#me.push(r);const h=t("AppErrorHistory");h&&(h.innerHTML+=r+" ")}async M32(t,i,e){this.M47(t),this.#fe[2];const s=this.#pe[2].M120(0);await this.#Se(s,this.#ue),s.FACE.classList.add("Compost"),await this.#Se(i,this.#oe),await this.#Pe()}M65(t,i=2){return this.M47(t),this.#pe[i].M168()}async M66(t,i,e){this.M47(t),this.#fe[2];const s=this.#pe[2].M120(0);await this.#Se(s,this.#ae),await this.#Se(i,this.#oe),await this.#Pe()}async M67(t){this.M47(t);const i=this.#ce.M80(()=>!0);this.#ce.M209(),i.forEach(t=>t.M118(!1)),this.#ae.M140(i),await i[0].M114()}#Ie(){let t=null,i=-1;for(let e=2;e>=0;--e){const s=this.#pe[e];if(0===s.M139()){t=s,i=e;break}}return[t,i]}#Se(t,i,e=!0){return i.M230(t,e),t.M114()}#De(t){return this.#ae.M145(t),t.M114()}async M108(t,i,e){this.M47(t);const s=this.#Re(i),n=s.ELEMENT.dataset.id;this.#Ne(e,n,!0),e.M75(!1),await this.#De(i),await this.#Se(e,s)}async M49(t,i){this.M47(t);const e=this.#Re(i),s=e.ELEMENT.dataset.id;this.#Ne(i,s,!1),i.M75(!1),e.M194(i);const n=this.#fe[s];return this.#fe[s]=null,await this.#Se(i,this.#ue),await this.#Se(n,this.#oe),await this.#Pe(),this.#ue.M139()}async#Pe(){for(let t=1;t>=0;--t){const i=this.#fe[t],e=this.#pe[t];if(null===i)continue;const s=t+1,n=this.#pe[s];if(0===n.M139()){this.#fe[s]=i,this.#fe[t]=null;const r=e.M167();await this.#Se(r,n)}}}#Re(t){const i=t.M190();for(let t=0;t<3;++t){const e=this.#pe[t];if(e===i)return e}}M153(t){return this.M47(t),this.#ue.M80(t=>t.M200(k.K33)).length>0}M91(t){return this.M47(t),this.#ue.M80(t=>t.M200(k.K59)).length>0}async M6(t){this.M47(t),await this.#Se(this.#ce.M167(),this.#ue),await this.#Se(this.#ce.M167(),this.#oe)}async M24(t){this.M47(t);const i=[];for(let t=1;t<=6;++t){const t=this.#ae.M88();i.push(t)}return this.#ce.M140(i),i[0].M114()}async M25(t){this.M47(t);const i=this.#oe.M88();await this.#Se(i,this.#le,!1),i.M118(!0)}M37(t){this.M47(t),this.#Ce()}#Ce(){}#Te(){super.M62(null,{})}#Ke(t,i,e=200){const s=t.length;if(0===s)return null;const n=t[0];if(e<=0)return i===this.#ae?i.M140(t,!0):i===this.#le?i.M140(t,!1):i.M140(t),n;for(let n=0;n<s;++n)setTimeout(()=>{const e=t.pop();i===this.#ae?i.M145(e):i===this.#le?i.M87(e):i.M230(e)},n*e);return n}#Ee(){this.#Oe(),this.#Fe()}#Oe(){this.#yi=new ht({jokers:5},{visible:!1,touch_down_events:!0,smooth:!0,flip_axis:e.M53(.5)?"x":"y"}),this.#yi.M166(t=>{this.#we.appendChild(t.ELEMENT),t.M171()&&(t.FACE.innerHTML="",t.M170()?t.FACE.classList.add("Plot"):t.FACE.classList.add("Joker"))}),this.#he=this.#yi.M177()}#Fe(){const i=this.#yi.M177(),e=this.#we;let s=0;this.#oe=new at(s++,"DrawPile",{max_cards:i,flip_after:!1,face_up:!1,parent:e,counter_position:at.K34,pop_effect:!0}),this.#oe.ELEMENT.classList.add("DrawPile"),this.#oe.ELEMENT.classList.add("Clickable"),this.#ae=new at(s++,"DiscardPile",{max_cards:i,flip_after:!1,face_up:!1,parent:e,counter_position:at.K48,pop_effect:!0}),this.#ae.ELEMENT.classList.add("DiscardPile"),this.#ae.ELEMENT.classList.add("Clickable"),this.#le=new nt(s++,"DeckRow",nt.K118,nt.K108,nt.K108,!0,{max_cards:i,flip_after:!0,face_up:!1,parent:e}),this.#le.M163(!0),this.#le.ELEMENT.classList.add("DeckRow"),this.#le.ELEMENT.classList.add("Clickable"),this.#ue=new nt(s++,"PaymentRow",nt.K118,nt.K108,nt.K108,!0,{max_cards:i,flip_after:!0,face_up:!0,parent:e}),this.#ue.ELEMENT.classList.add("PaymentRow"),this.#ue.ELEMENT.classList.add("Clickable"),this.#ce=new nt(s++,"SoilRow",nt.K118,nt.K108,nt.K108,!0,{max_cards:6,flip_after:!0,face_up:!0,sorting:rt,parent:e}),this.#ce.ELEMENT.classList.add("SoilRow"),this.#ce.ELEMENT.classList.add("Clickable");for(let t=0;t<3;++t){const i=new nt(s++,"Plot_"+t,nt.K118,nt.K108,nt.K108,!0,{max_cards:1,flip_after:!0,face_up:!0,parent:e});i.ELEMENT.classList.add("Plot"),i.ELEMENT.classList.add("Clickable"),i.ELEMENT.dataset.id=t,this.#pe.push(i)}this.#de=t("InGameInfo"),this.#_e=document.createElement("div"),this.#_e.classList.add("PaymentMeterBase"),e.appendChild(this.#_e),this.#Me=document.createElement("div"),this.#Me.classList.add("PaymentMeterLevel"),this.#_e.appendChild(this.#Me)}};import Kt from"stampit";import stampit from"stampit";var Ot=stampit({props:{M109:!1,M228:null,M10:NaN},methods:{setImage(t){this.resetImage(),this.M109=!0;let i=null;"string"==typeof t?(i=new Image,i.onload=()=>{this.M228=i,this.M10=i.width/i.height},i.onerror=()=>{this.resetImage()},i.src=t):(t instanceof HTMLImageElement||t instanceof Image)&&(this.M228=t,this.M10=t.width/t.height)},getImage(){return this.M228&&this.M228.complete?this.M228:null},getImageAspectRatio(){return this.M228&&this.M228.complete?this.M10:NaN},resetImage(){this.M228=null,this.M10=NaN,this.M109=!1}}});import Ft from"stampit";import{ARRAY_TYPE as Bt}from"glMatrix";import{fromValues as Vt,create as zt}from"vec2";var vec2={fromValues:Vt,create:zt},jt=Ft({methods:{validateVector(t,i=null){const e=t||i;if(!e)return vec2.create();if(!(Array.isArray(e)||e instanceof Bt))throw new Error("Vector input must be an Array or glMatrix ARRAY_TYPE.");if(2!==e.length)throw new Error("Vector input must have exactly 2 elements.");if(!Number.isFinite(e[0])||!Number.isFinite(e[1]))throw new Error("Vector array must contain only numeric values.");return vec2.fromValues(e[0],e[1])}}});import{add as Ht,create as Gt,scaleAndAdd as Ut,zero as qt,copy as $t}from"vec2";import Wt from"stampit";import Yt from"stampit";var Xt=Yt({methods:{makeReadOnly:function(t){if("object"!=typeof t||null===t||Array.isArray(t))return;const i={};Object.entries(t).forEach(([t,e])=>{Object.prototype.hasOwnProperty.call(this,t),i[t]={configurable:!1,writable:!1,value:e,enumerable:!0}}),Object.defineProperties(this,i)}}}),Jt={add:Ht,create:Gt,scaleAndAdd:Ut,zero:qt,copy:$t},Qt="#FFFFFF",Zt=!0,ti=2*Math.PI,ii=Kt({props:{M204:null},init({radius:t=3,color:i=Qt,opacity:e=1,fill:s=Zt,user_data:n=null}){if(!Number.isFinite(t)||t<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(e)||e<0||e>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if("string"!=typeof i||i.length<3)throw new Error("'color' must be a valid string format ( e.g., '#FFF' or 'red' ).");this.radius=t,this.color=i,this.opacity=e,this.fill=s,this.user_data=n},methods:{render(t){if(t.save(),t.globalAlpha=this.opacity,this.M109){const i=this.getImageAspectRatio();if(Number.isFinite(i)){const e=this.getImage(),s=this.position[0],n=this.position[1],r=(e.width,e.height,this.M10,2*this.radius),h=r*i;t.drawImage(e,s-h/2,n-r/2,h,r)}}else t.beginPath(),t.arc(...this.position,this.radius,0,ti),this.fill?(t.fillStyle=this.color,t.fill()):(t.strokeStyle=this.color,t.stroke());t.restore()},resetRender(){this.resetImage(),this.fill=Zt}}}),ei=Kt({init({position:t,velocity:i}){this.position=this.validateVector(t),this.velocity=this.validateVector(i),this.acceleration=Jt.create()},methods:{applyForce(t){Jt.add(this.acceleration,this.acceleration,t)},updatePhysics(t=1){Jt.scaleAndAdd(this.velocity,this.velocity,this.acceleration,t),Jt.scaleAndAdd(this.position,this.position,this.velocity,t),Jt.zero(this.acceleration)},resetPhysics(){Jt.zero(this.position),Jt.zero(this.velocity),Jt.zero(this.acceleration)}}}),si=Kt({props:{age:0,alive:!1},init({life:t=120}){if(!Number.isFinite(t)||t<=0)throw new Error("'life' must be a positive number.");this.life=t},methods:{updateLife(t=1){return this.age+=t,this.alive=this.age<this.life,this.alive},resetLife(){this.age=0,this.alive=!1}}}),ni=Kt({methods:{config(t={}){if(this.opacity=(t.opacity??this.opacity)||1,this.radius=(t.radius??this.radius)||3,this.color=(t.color??this.color)||Qt,this.life=(t.life??this.life)||120,this.fill=t.fill??Zt,t.position&&Jt.copy(this.position,this.validateVector(t.position)),t.velocity&&Jt.copy(this.velocity,this.validateVector(t.velocity)),!Number.isFinite(this.radius)||this.radius<=0)throw new Error("'radius' must be a positive number.");if(!Number.isFinite(this.opacity)||this.opacity<0||this.opacity>1)throw new Error("'opacity' must be a number between 0.0 and 1.0.");if(!Number.isFinite(this.life)||this.life<=0)throw new Error("'life' must be a positive number.")}}}),ri=Kt().compose(jt,Ot,ii,ei,si,ni,Kt({methods:{reset(){this.resetRender(),this.resetPhysics(),this.resetLife()}}})),hi=Wt({init({object_stamp:t,pool_size:i=1e3}){if("function"!=typeof t)throw new Error("'object_stamp' must be a constructor function ( a stamp or factory ).");if(!Number.isInteger(i)||i<=0)throw new Error("'pool_size' must be a positive integer.");this.makeReadOnly({pool_size:i,object_stamp:t})}}),oi=Wt({init(t,{instance:i}){const e=new Array(this.pool_size);let s=0;const n=new WeakMap;for(let t=0;t<this.pool_size;t++){const i=this.object_stamp();i.reset(),e[t]=i}i._setIndex=function(t,i){n.set(t,i)},i.get=function(){if(s>=this.pool_size)return null;const t=e[s];return n.set(t,s),s++,t},i.free=function(t){const i=n.get(t);if(void 0===i||i>=s)return!1;s--;const r=e[s];return e[s]=t,e[i]=r,t!==r&&n.set(r,i),t.reset(),n.delete(t),!0},i.getActiveCount=function(){return s},i._getPoolArray=function(){return e}}}),ai=Wt({methods:{M166:function(t){const i=this._getPoolArray();let e=0;for(;e<this.getActiveCount();){const s=i[e];this._setIndex(s,e),!1!==t(s)?e++:this.free(s)}},M205:function(t){this._getPoolArray().forEach(i=>t(i))}}}),li=Wt().compose(Xt,hi,oi,ai);import{fromValues as ci,copy as ui,random as di,create as _i}from"vec2";var Mi={fromValues:ci,copy:ui,random:di,create:_i},pi=Mi.create(),fi="kfwrjw2uqf~",mi="kfwrjw2{nxnyx",Farmer=class{#Be=null;#Ve=!1;#ze=null;#we=null;#gi=!1;#je=Mi.create();#He=null;#Ge=0;#Ue=null;#qe=null;#$e=null;#We=null;#Ye=0;#Xe=0;#Je={n:0,center:null};constructor(t){this.#Be=new vt({game_name:"THE FARMER<br><small>AND THE DEAL</small>",game_designer:"Matt Hanna",game_build:t,start_page:i.M17("page",bt),page_mode:vt.K116,on_resize:this.M151.bind(this),on_click:this.M181.bind(this),on_page:this.M206.bind(this),counter:fi,settings:{prefix:"farmer",schema:[{label:"Campain (years)",id:"nr_years",type:"radio",options:["1","3","5"],default:0,not_implemented:!0}]}}),this.#Be.M104(mi,"up"),this.#we=this.#Be.M179(Et),this.#Ge=this.#Be.M103,this.#gi=this.#Be.M89(),this.#Qe(),this.#Ze(),this.#ts(),this.#Be.M180(this.#ze.M184())}M151(t,i,e){this.#ze.M151(t,i,e),this.#Ue.width=t,this.#Ue.height=i,this.#qe.width=t,this.#qe.height=i,this.#Ge=e}M181(t,e,s){this.#Ve&&(i.M50||this.#gi)&&this.#ze.M181(t,e,s)}M206(t,i){const e=this.#Ve;this.#Ve=t===Et,this.#Ve&&(this.#Be.M148(),e||window.requestAnimationFrame(this.#is.bind(this)),i&&this.#es())}M154(i,e){if("string"!=typeof i)throw new Error("! "+i+" = "+typeof i);switch(i){default:return;case Rt.K49:let i=e.value;Number.isFinite(i)&&!Number.isInteger(i)&&(i=Math.round(i)),this.#ss(e.key,i);break;case u:let s=e.value;Number.isFinite(s)&&!Number.isInteger(s)&&(s=Math.round(s)),this.#ss(e.key,s,e.center);break;case c:const n=t("deck_seed");n&&(n.value=e);const r=t("error_seed");r&&(r.innerHTML=e);break;case"msg#user:error":break;case d:this.#ns(e.position,e.status);break;case _:this.#Be.M104(fi,e?"up":"down"),this.#Ye=e?1:-1}}#es(){this.#Be.M148(!1),this.#Ye=0;const t={velocity_px_ms:this.#Be.M105("cards_speed",!0),flip_time:this.#Be.M105("cards_flip",!0)};this.#ze.M216(t),this.#Be.M104(mi,"down")}#Ze(){this.#ze=new Rt({on_message_request:(t,i)=>this.M154(t,i),V26:["season","payment"],parent_node:this.#Be.M179(Et)}),this.#ze.M151(this.#Be.M214,this.#Be.M202)}#ts(){const t=document.createElement("canvas");t.id="canvas_clicks",t.width=window.innerWidth,t.height=window.innerHeight,t.style.zIndex=200,this.#we.appendChild(t);const i=document.createElement("canvas");i.id="canvas_particles",i.width=window.innerWidth,i.height=window.innerHeight,i.style.zIndex=100,this.#we.appendChild(i),this.#We=t.getContext("2d"),this.#$e=i.getContext("2d"),this.#qe=t,this.#Ue=i,this.#He=li({object_stamp:ri,pool_size:1e4}),this.#He.M205(t=>{t.user_data={click:!0}})}#is(t){this.#Ve&&(this.#Xe,this.#Xe=t,this.#Je.n>0&&(this.#Je.n-=1,this.#rs(this.#Je.center)),this.#He.M166(t=>{if(!t.updateLife())return t.user_data.click=!0,!1}),this.#We.clearRect(0,0,window.innerWidth,window.innerHeight),this.#$e.clearRect(0,0,window.innerWidth,window.innerHeight),this.#He.M166(t=>{t.opacity=e.M160(t.age,t.life,5),t.updatePhysics();const i=t.user_data.click;i&&(t.radius*=1.05),t.render(i?this.#We:this.#$e)}),0!==this.#Ye&&this.M155(this.#$e,1===this.#Ye?"SUCCESS":"YOU LOST",this.#Ge),window.requestAnimationFrame(this.#is.bind(this)))}#hs(){const t=window.visualViewport.width,i=window.visualViewport.height,e=Math.min(t,i),s=.03*e,n=Math.floor((e-s-this.#Ge-s)/6),r=(t-6*n-this.#Ge-s)/2,h=Math.floor(n/.7),o=Math.floor((i-4*h)/2);gi(this.#$e,r,o,n,h,6,4)}#ns(t,i){if(i)return;const e=this.#He.get();e&&(e.config({position:t,velocity:pi,color:i?"lime":"darkorange",life:i?60:30,radius:10,opacity:1,fill:!i}),e.user_data.click=!0)}#rs(t){const i=this.#He.get();if(!i)return;const s="hsl("+e.M111(40,60)+", 100%, 50%)";i.config({position:t,velocity:Mi.random(this.#je,e.M71(1,4)),color:s,life:60*e.M71(2,4),radius:e.M71(5,10),opacity:1,fill:!0}),i.user_data.click=!1}#Qe(){}#ss(i,e,s=null){if("1st_sale"===i)return this.#Je.n=100,void(this.#Je.center=s);if("payment"===i){t("payment").innerHTML=e,e=Math.min(e,20);const i=Math.round(e/20*100);return void(function(t,i=document){return i.querySelectorAll("."+t)}("PaymentMeterLevel")[0].style.width=i+"%")}const n=t(i);n&&(n.innerHTML=e)}M155(t,i="",e=0){const s=t.canvas.width-e,n=t.canvas.height,r=Math.floor(.18*s);t.font="bold "+r+"px card-game",t.fillStyle="rgba( 100, 149, 237, 0.50 )",t.textAlign="center",t.textBaseline="middle",t.fillText(i,s/2,n/2)}M229(i=100){const e=t("Play");e.style.transition="filter "+i+"ms ease",e.style.filter="brightness( 0.5 )",setTimeout(()=>e.style.filter="brightness( 1 )",i)}M217(i=0){i*=5;const e=t("Play");e.style.transition="filter "+i+"ms ease",e.style.filter="blur("+i+"px)",setTimeout(()=>e.style.filter="blur(0)",i)}},gi=(t,i,e,s,n,r,h)=>{const o=r*s,a=h*n;t.strokeStyle="orange",t.beginPath();for(let n=0;n<=r;n++){const r=i+n*s;t.moveTo(r,e),t.lineTo(r,e+a)}for(let s=0;s<=h;s++){const r=e+s*n;t.moveTo(i,r),t.lineTo(i+o,r)}t.stroke()};export{Farmer};
//# sourceMappingURL=bundle.min.js.map